/**
 * @license
 * Video.js 7.3.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("global/window"),require("global/document")):typeof define=="function"&&define.amd?define(["global/window","global/document"],t):n.videojs=t(n.window,n.document)})(this,function(n,t){function e(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function ec(n,t){return ec=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},ec(n,t)}function tft(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}function io(){return io=tft()?Reflect.construct:function(n,t,i){var r=[null],f,u;return r.push.apply(r,t),f=Function.bind.apply(n,r),u=new f,i&&ec(u,i.prototype),u},io.apply(null,arguments)}function f(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function oc(n,t){return t||(t=n.slice(0)),n.raw=t,n}function ap(n){var i="info",r,t=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];r("log",i,u)};return r=lp(n,t),t.createLogger=function(t){return ap(n+": "+t)},t.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},t.level=function(n){if(typeof n=="string"){if(!t.levels.hasOwnProperty(n))throw new Error('"'+n+'" in not a valid log level');i=n}return i},t.history=function(){return at?[].concat(at):[]},t.history.filter=function(n){return(at||[]).filter(function(t){return new RegExp(".*"+n+".*").test(t[0])})},t.history.clear=function(){at&&(at.length=0)},t.history.disable=function(){at!==null&&(at.length=0,at=null)},t.history.enable=function(){at===null&&(at=[])},t.error=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("error",i,u)},t.warn=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("warn",i,u)},t.debug=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("debug",i,u)},t}function ift(n){return n.replace(/\n\r?\s*/g,"")}function nu(n,t){vp(n).forEach(function(i){return t(n[i],i)})}function uft(n,t,i){return i===void 0&&(i=0),vp(n).reduce(function(i,r){return t(i,n[r],r)},i)}function y(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return Object.assign?Object.assign.apply(Object,[n].concat(r)):(r.forEach(function(t){t&&nu(t,function(t,i){n[i]=t})}),n)}function bi(n){return!!n&&typeof n=="object"}function of(n){return bi(n)&&rft.call(n)==="[object Object]"&&n.constructor===Object}function cc(t,i){if(!t||!i)return"";if(typeof n.getComputedStyle=="function"){var r=n.getComputedStyle(t);return r?r[i]:""}return""}function yp(){var n=oc(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return yp=function(){return n},n}function pp(n){return typeof n=="string"&&/\S/.test(n)}function wp(n){if(/\s/.test(n))throw new Error("class has illegal whitespace characters");}function fft(n){return new RegExp("(^|\\s)"+n+"($|\\s)")}function tu(){return t===n.document}function sf(n){return bi(n)&&n.nodeType===1}function bp(){try{return n.parent!==n.self}catch(t){return!0}}function kp(n){return function(i,r){if(!pp(i))return t[n](null);pp(r)&&(r=t.querySelector(r));var u=sf(r)?r:t;return u[n]&&u[n](i)}}function d(n,i,r,u){n===void 0&&(n="div");i===void 0&&(i={});r===void 0&&(r={});var f=t.createElement(n);return Object.getOwnPropertyNames(i).forEach(function(n){var t=i[n];n.indexOf("aria-")!==-1||n==="role"||n==="type"?(c.warn(hc(yp(),n,t)),f.setAttribute(n,t)):n==="textContent"?hf(f,t):f[n]=t}),Object.getOwnPropertyNames(r).forEach(function(n){f.setAttribute(n,r[n])}),u&&vc(f,u),f}function hf(n,t){return typeof n.textContent=="undefined"?n.innerText=t:n.textContent=t,n}function ro(n,t){t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}function ur(n,t){return(wp(t),n.classList)?n.classList.contains(t):fft(t).test(n.className)}function fr(n,t){return n.classList?n.classList.add(t):ur(n,t)||(n.className=(n.className+" "+t).trim()),n}function cf(n,t){return n.classList?n.classList.remove(t):(wp(t),n.className=n.className.split(/\s+/).filter(function(n){return n!==t}).join(" ")),n}function dp(n,t,i){var r=ur(n,t);if(typeof i=="function"&&(i=i(n,t)),typeof i!="boolean"&&(i=!r),i!==r)return i?fr(n,t):cf(n,t),n}function gp(n,t){Object.getOwnPropertyNames(t).forEach(function(i){var r=t[i];r===null||typeof r=="undefined"||r===!1?n.removeAttribute(i):n.setAttribute(i,r===!0?"":r)})}function ai(n){var f={},i,t,r,u;if(n&&n.attributes&&n.attributes.length>0)for(i=n.attributes,t=i.length-1;t>=0;t--)r=i[t].name,u=i[t].value,(typeof n[r]=="boolean"||",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")!==-1)&&(u=u!==null?!0:!1),f[r]=u;return f}function nw(n,t){return n.getAttribute(t)}function lf(n,t,i){n.setAttribute(t,i)}function uo(n,t){n.removeAttribute(t)}function tw(){t.body.focus();t.onselectstart=function(){return!1}}function iw(){t.onselectstart=function(){return!0}}function af(n){if(n&&n.getBoundingClientRect&&n.parentNode){var i=n.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(function(n){i[n]!==undefined&&(t[n]=i[n])}),t.height||(t.height=parseFloat(cc(n,"height"))),t.width||(t.width=parseFloat(cc(n,"width"))),t}}function rw(i){var r;if(i.getBoundingClientRect&&i.parentNode&&(r=i.getBoundingClientRect()),!r)return{left:0,top:0};var f=t.documentElement,u=t.body,e=f.clientLeft||u.clientLeft||0,o=n.pageXOffset||u.scrollLeft,s=r.left+o-e,h=f.clientTop||u.clientTop||0,c=n.pageYOffset||u.scrollTop,l=r.top+c-h;return{left:Math.round(s),top:Math.round(l)}}function lc(n,t){var i={},r=rw(n),o=n.offsetWidth,u=n.offsetHeight,s=r.top,h=r.left,f=t.pageY,e=t.pageX;return t.changedTouches&&(e=t.changedTouches[0].pageX,f=t.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(s-f+u)/u)),i.x=Math.max(0,Math.min(1,(e-h)/o)),i}function uw(n){return bi(n)&&n.nodeType===3}function ac(n){while(n.firstChild)n.removeChild(n.firstChild);return n}function fw(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(function(n){return(typeof n=="function"&&(n=n()),sf(n)||uw(n))?n:typeof n=="string"&&/\S/.test(n)?t.createTextNode(n):void 0}).filter(function(n){return n})}function vc(n,t){return fw(t).forEach(function(t){return n.appendChild(t)}),n}function ew(n,t){return vc(ac(n),t)}function iu(n){return n.button===undefined&&n.buttons===undefined?!0:n.button===0&&n.buttons===undefined?!0:n.button!==0||n.buttons!==1?!1:!0}function er(){return eft++}function vf(n){var t=n[di];return t||(t=n[di]=er()),ru[t]||(ru[t]={}),ru[t]}function hw(n){var t=n[di];return t?!!Object.getOwnPropertyNames(ru[t]).length:!1}function cw(n){var t=n[di];if(t){delete ru[t];try{delete n[di]}catch(i){n.removeAttribute?n.removeAttribute(di):n[di]=null}}}function lw(n,t){var i=vf(n);i.handlers[t].length===0&&(delete i.handlers[t],n.removeEventListener?n.removeEventListener(t,i.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+t,i.dispatcher));Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled);Object.getOwnPropertyNames(i).length===0&&cw(n)}function yc(n,t,i,r){i.forEach(function(i){n(t,i,r)})}function fo(i){function o(){return!0}function s(){return!1}var r,u,f,e;if(!i||!i.isPropagationStopped){r=i||n.event;i={};for(u in r)u!=="layerX"&&u!=="layerY"&&u!=="keyLocation"&&u!=="webkitMovementX"&&u!=="webkitMovementY"&&(u==="returnValue"&&r.preventDefault||(i[u]=r[u]));i.target||(i.target=i.srcElement||t);i.relatedTarget||(i.relatedTarget=i.fromElement===i.target?i.toElement:i.fromElement);i.preventDefault=function(){r.preventDefault&&r.preventDefault();i.returnValue=!1;r.returnValue=!1;i.defaultPrevented=!0};i.defaultPrevented=!1;i.stopPropagation=function(){r.stopPropagation&&r.stopPropagation();i.cancelBubble=!0;r.cancelBubble=!0;i.isPropagationStopped=o};i.isPropagationStopped=s;i.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation();i.isImmediatePropagationStopped=o;i.stopPropagation()};i.isImmediatePropagationStopped=s;i.clientX!==null&&i.clientX!==undefined&&(f=t.documentElement,e=t.body,i.pageX=i.clientX+(f&&f.scrollLeft||e&&e.scrollLeft||0)-(f&&f.clientLeft||e&&e.clientLeft||0),i.pageY=i.clientY+(f&&f.scrollTop||e&&e.scrollTop||0)-(f&&f.clientTop||e&&e.clientTop||0));i.which=i.charCode||i.keyCode;i.button!==null&&i.button!==undefined&&(i.button=i.button&1?0:i.button&4?1:i.button&2?2:0)}return i}function fi(n,t,i){var r,u;if(Array.isArray(t))return yc(fi,n,t,i);r=vf(n);r.handlers||(r.handlers={});r.handlers[t]||(r.handlers[t]=[]);i.guid||(i.guid=er());r.handlers[t].push(i);r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,i){var f,e,u,o;if(!r.disabled&&(t=fo(t),f=r.handlers[t.type],f))for(e=f.slice(0),u=0,o=e.length;u<o;u++)if(t.isImmediatePropagationStopped())break;else try{e[u].call(n,t,i)}catch(s){c.error(s)}});r.handlers[t].length===1&&(n.addEventListener?(u=!1,pc&&aw.indexOf(t)>-1&&(u={passive:!0}),n.addEventListener(t,r.dispatcher,u)):n.attachEvent&&n.attachEvent("on"+t,r.dispatcher))}function vt(n,t,i){var r,e,o,u,f;if(hw(n)&&(r=vf(n),r.handlers)){if(Array.isArray(t))return yc(vt,n,t,i);if(e=function(n,t){r.handlers[t]=[];lw(n,t)},t===undefined){for(o in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},o)&&e(n,o);return}if(u=r.handlers[t],u){if(!i){e(n,t);return}if(i.guid)for(f=0;f<u.length;f++)u[f].guid===i.guid&&u.splice(f--,1);lw(n,t)}}}function uu(n,t,i){var f=hw(n)?vf(n):{},r=n.parentNode||n.ownerDocument,u;return typeof t=="string"?t={type:t,target:n}:t.target||(t.target=n),t=fo(t),f.dispatcher&&f.dispatcher.call(n,t,i),r&&!t.isPropagationStopped()&&t.bubbles===!0?uu.call(null,r,t,i):r||t.defaultPrevented||(u=vf(t.target),t.target[t.type]&&(u.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),u.disabled=!1)),!t.defaultPrevented}function yf(n,t,i){if(Array.isArray(t))return yc(yf,n,t,i);var r=function r(){vt(n,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||er();fi(n,t,r)}function kc(t,i){i&&(bc=i);n.setTimeout(sft,t)}function gc(t,i){i===void 0&&(i={});var u=i,r=u.eventBusKey;if(r){if(!t[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');t.eventBusEl_=t[r]}else t.eventBusEl_=d("span",{className:"vjs-event-bus"});y(t,cft);t.on("dispose",function(){t.off();n.setTimeout(function(){t.eventBusEl_=null},0)});return t}function gw(n,t){if(y(n,dw),n.state=y({},n.state,t),typeof n.handleStateChanged=="function"&&eo(n))n.on("statechanged",n.handleStateChanged);return n}function b(n){return typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1)}function lft(n,t){return b(n)===b(t)}function p(){for(var n={},i=arguments.length,r=new Array(i),t=0;t<i;t++)r[t]=arguments[t];return r.forEach(function(t){t&&nu(t,function(t,i){if(!of(t)){n[i]=t;return}of(n[i])||(n[i]={});n[i]=p(n[i],t)})}),n}function pft(n,t,i){if(typeof t!="number"||t<0||t>i)throw new Error("Failed to execute '"+n+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").");}function sb(n,t,i,r){return pft(n,r,i.length-1),i[r][t]}function ul(n){return n===undefined||n.length===0?{length:0,start:function(){throw new Error("This TimeRanges object is empty");},end:function(){throw new Error("This TimeRanges object is empty");}}:{length:n.length,start:sb.bind(null,"start",0,n),end:sb.bind(null,"end",1,n)}}function sr(n,t){return Array.isArray(n)?ul(n):n===undefined||t===undefined?ul():ul([[n,t]])}function hb(n,t){var u=0,f,r,i;if(!t)return 0;for(n&&n.length||(n=sr(0,0)),i=0;i<n.length;i++)f=n.start(i),r=n.end(i),r>t&&(r=t),u+=r-f;return u/t}function rt(n){if(n instanceof rt)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:bi(n)&&(typeof n.code=="number"&&(this.code=n.code),y(this,n));this.message||(this.message=rt.defaultMessages[this.code]||"")}function bft(n,t){var i,r=null;try{i=JSON.parse(n,t)}catch(u){r=u}return[r,i]}function lb(n){return n!==undefined&&n!==null&&typeof n.then=="function"}function df(n){lb(n)&&n.then(null,function(){})}function het(n){var t=set.call(n);return t==="[object Function]"||typeof n=="function"&&t!=="[object RegExp]"||typeof window!="undefined"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)}function al(n,t){return t={exports:{}},n(t,t.exports),t.exports}function oot(){for(var n,t,r={},i=0;i<arguments.length;i++){n=arguments[i];for(t in n)eot.call(n,t)&&(r[t]=n[t])}return r}function sot(n,t){for(var i=0;i<n.length;i++)t(n[i])}function hot(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function tk(n,t,i){var r=n;return oet(t)?(i=t,typeof n=="string"&&(r={uri:n})):r=fot(t,{uri:n}),r.callback=i,r}function nr(n,t,i){return t=tk(n,t,i),ik(t)}function ik(n){function w(){t.readyState===4&&setTimeout(v,0)}function b(){var n=undefined;if(n=t.response?t.response:t.responseText||cot(t),y)try{n=JSON.parse(n)}catch(i){}return n}function s(n){return clearTimeout(a),n instanceof Error||(n=new Error(""+(n||"Unknown XMLHttpRequest Error"))),n.statusCode=0,o(n,p)}function v(){var u,i,e;if(!f)return clearTimeout(a),u=n.useXDR&&t.status===undefined?200:t.status===1223?204:t.status,i=p,e=null,u!==0?(i={body:b(),statusCode:u,method:r,headers:{},url:h,rawRequest:t},t.getAllResponseHeaders&&(i.headers=uot(t.getAllResponseHeaders()))):e=new Error("Internal XMLHttpRequest Error"),o(e,i,i.body)}var e,o,t;if(typeof n.callback=="undefined")throw new Error("callback argument missing");e=!1;o=function(t,i,r){e||(e=!0,n.callback(t,i,r))};t=n.xhr||null;t||(t=n.cors||n.useXDR?new nr.XDomainRequest:new nr.XMLHttpRequest);var u,f,h=t.url=n.uri||n.url,r=t.method=n.method||"GET",c=n.body||n.data,i=t.headers=n.headers||{},l=!!n.sync,y=!1,a,p={body:undefined,headers:{},statusCode:0,method:r,url:h,rawRequest:t};if("json"in n&&n.json!==!1&&(y=!0,i.accept||i.Accept||(i.Accept="application/json"),r!=="GET"&&r!=="HEAD"&&(i["content-type"]||i["Content-Type"]||(i["Content-Type"]="application/json"),c=JSON.stringify(n.json===!0?c:n.json))),t.onreadystatechange=w,t.onload=v,t.onerror=s,t.onprogress=function(){},t.onabort=function(){f=!0},t.ontimeout=s,t.open(r,h,!l,n.username,n.password),l||(t.withCredentials=!!n.withCredentials),!l&&n.timeout>0&&(a=setTimeout(function(){if(!f){f=!0;t.abort("timeout");var n=new Error("XMLHttpRequest timeout");n.code="ETIMEDOUT";s(n)}},n.timeout)),t.setRequestHeader)for(u in i)i.hasOwnProperty(u)&&t.setRequestHeader(u,i[u]);else if(n.headers&&!hot(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(t.responseType=n.responseType),"beforeSend"in n&&typeof n.beforeSend=="function"&&n.beforeSend(t),t.send(c||null),t}function cot(n){if(n.responseType==="document")return n.responseXML;var t=n.responseXML&&n.responseXML.documentElement.nodeName==="parsererror";return n.responseType===""&&!t?n.responseXML:null}function lot(){}function pt(n,t){this.name="ParsingError";this.code=n.code;this.message=t||n.message}function yl(n){function i(n,t,i,r){return(n|0)*3600+(t|0)*60+(i|0)+(r|0)/1e3}var t=n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return t?t[3]?i(t[1],t[2],t[3].replace(":",""),t[4]):t[1]>59?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null}function te(){this.values=ao(null)}function ie(n,t,i,r){var f=r?n.split(r):[n],e,u,o,s;for(e in f)typeof f[e]=="string"&&(u=f[e].split(i),u.length===2)&&(o=u[0],s=u[1],t(o,s))}function vot(n,t,i){function f(){var t=yl(n);if(t===null)throw new pt(pt.Errors.BadTimeStamp,"Malformed timestamp: "+u);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function e(n,t){var r=new te;ie(n,function(n,t){var f,u,e;switch(n){case"region":for(f=i.length-1;f>=0;f--)if(i[f].id===t){r.set(n,i[f].region);break}break;case"vertical":r.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");e=u[0];r.integer(n,e);r.percent(n,e)?r.set("snapToLines",!1):null;r.alt(n,e,["auto"]);u.length===2&&r.alt("lineAlign",u[1],["start","middle","end"]);break;case"position":u=t.split(",");r.percent(n,u[0]);u.length===2&&r.alt("positionAlign",u[1],["start","middle","end"]);break;case"size":r.percent(n,t);break;case"align":r.alt(n,t,["start","middle","end","left","right"])}},/:/,/\s/);t.region=r.get("region",null);t.vertical=r.get("vertical","");t.line=r.get("line","auto");t.lineAlign=r.get("lineAlign","start");t.snapToLines=r.get("snapToLines",!0);t.size=r.get("size",100);t.align=r.get("align","middle");t.position=r.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align);t.positionAlign=r.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function r(){n=n.replace(/^\s+/,"")}var u=n;if(r(),t.startTime=f(),r(),n.substr(0,3)!=="-->")throw new pt(pt.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+u);n=n.substr(3);r();t.endTime=f();r();e(n,t)}function hk(n,t){function h(){function i(n){return t=t.substr(n.length),n}if(!t)return null;var n=t.match(/^([^<]*)(<[^>]*>?)?/);return i(n[1]?n[1]:n[2])}function c(n){return yot[n]}function l(n){while(i=n.match(/&(amp|lt|gt|lrm|rlm|nbsp);/))n=n.replace(i[0],c);return n}function a(n,t){return!sk[t.localName]||sk[t.localName]===n.localName}function v(t,i){var u=pot[t],r,f;return u?(r=n.document.createElement(u),r.localName=u,f=wot[t],f&&i&&(r[f]=i.trim()),r):null}for(var s=n.document.createElement("div"),f=s,r,e=[],o,u,i;(r=h())!==null;){if(r[0]==="<"){if(r[1]==="/"){e.length&&e[e.length-1]===r.substr(2).replace(">","")&&(e.pop(),f=f.parentNode);continue}if(o=yl(r.substr(1,r.length-2)),o){u=n.document.createProcessingInstruction("timestamp",o);f.appendChild(u);continue}if(i=r.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/),!i)continue;if(u=v(i[1],i[3]),!u)continue;if(!a(f,u))continue;i[2]&&(u.className=i[2].substr(1).replace("."," "));e.push(i[1]);f.appendChild(u);f=u;continue}f.appendChild(n.document.createTextNode(l(r)))}return s}function bot(n){for(var i,t=0;t<pl.length;t++)if(i=pl[t],n>=i[0]&&n<=i[1])return!0;return!1}function kot(n){function e(n,t){for(var i=t.childNodes.length-1;i>=0;i--)n.push(t.childNodes[i])}function r(n){var t,i,u;return!n||!n.length?null:(t=n.pop(),i=t.textContent||t.innerText,i)?(u=i.match(/^.*(\n|\r)/),u)?(n.length=0,u[0]):i:t.tagName==="ruby"?r(n):t.childNodes?(e(n,t),r(n)):void 0}var u=[],i="",f,t;if(!n||!n.childNodes)return"ltr";for(e(u,n);i=r(u);)for(t=0;t<i.length;t++)if(f=i.charCodeAt(t),bot(f))return"rtl";return"ltr"}function dot(n){var t;if(typeof n.line=="number"&&(n.snapToLines||n.line>=0&&n.line<=100))return n.line;if(!n.track||!n.track.textTrackList||!n.track.textTrackList.mediaElement)return-1;var r=n.track,i=r.textTrackList,u=0;for(t=0;t<i.length&&i[t]!==r;t++)i[t].mode==="showing"&&u++;return++u*-1}function vo(){}function yo(n,t,i){var u,r;vo.call(this);this.cue=t;this.cueDiv=hk(n,t.text);u={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(u,this.cueDiv);this.div=n.document.createElement("div");u={direction:kot(this.cueDiv),writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:t.align==="middle"?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(u);this.div.appendChild(this.cueDiv);r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size}t.vertical===""?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")});this.move=function(n){this.applyStyles({top:this.formatStyle(n.top,"px"),bottom:this.formatStyle(n.bottom,"px"),left:this.formatStyle(n.left,"px"),right:this.formatStyle(n.right,"px"),height:this.formatStyle(n.height,"px"),width:this.formatStyle(n.width,"px")})}}function ut(n){var i,r,f,u,t;n.div&&(r=n.div.offsetHeight,f=n.div.offsetWidth,u=n.div.offsetTop,t=(t=n.div.childNodes)&&(t=t[0])&&t.getClientRects&&t.getClientRects(),n=n.div.getBoundingClientRect(),i=t?Math.max(t[0]&&t[0].height||0,n.height/t.length):0);this.left=n.left;this.right=n.right;this.top=n.top||u;this.height=n.height||r;this.bottom=n.bottom||u+(n.height||r);this.width=n.width||f;this.lineHeight=i!==undefined?i:n.lineHeight}function got(n,t,i,r){function y(n,t){for(var f,e,o=new ut(n),s=1,u=0;u<t.length;u++){while(n.overlapsOppositeAxis(i,t[u])||n.within(i)&&n.overlapsAny(r))n.move(t[u]);if(n.within(i))return n;f=n.intersectPercentage(i);s>f&&(e=new ut(n),s=f);n=new ut(o)}return e||o}var o=new ut(t),e=t.cue,f=dot(e),u=[],h,l,v;if(e.snapToLines){switch(e.vertical){case"":u=["+y","-y"];h="height";break;case"rl":u=["+x","-x"];h="width";break;case"lr":u=["-x","+x"];h="width"}var c=o.lineHeight,s=c*Math.round(f),a=i[h]+c,p=u[0];Math.abs(s)>a&&(s=(s<0?-1:1)*Math.ceil(a/c)*c);f<0&&(s+=e.vertical===""?i.height:i.width,u=u.reverse());o.move(p,s)}else{l=o.lineHeight/i.height*100;switch(e.lineAlign){case"middle":f-=l/2;break;case"end":f-=l}switch(e.vertical){case"":t.applyStyles({top:t.formatStyle(f,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(f,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(f,"%")})}u=["+y","-x","+x","-y"];o=new ut(t)}v=y(o,u);t.move(v.toCSSCompatValues(i))}function hu(){}function ost(n){if(typeof n!="string")return!1;var t=fst[n.toLowerCase()];return t?n.toLowerCase():!1}function wl(n){if(typeof n!="string")return!1;var t=est[n.toLowerCase()];return t?n.toLowerCase():!1}function ck(n,t,i){this.hasBeenReset=!1;var r="",u=!1,f=n,e=t,o=i,s=null,h="",c=!0,l="auto",a="start",v=50,y="middle",p=50,w="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(n){r=""+n}},pauseOnExit:{enumerable:!0,get:function(){return u},set:function(n){u=!!n}},startTime:{enumerable:!0,get:function(){return f},set:function(n){if(typeof n!="number")throw new TypeError("Start time must be set to a number.");f=n;this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return e},set:function(n){if(typeof n!="number")throw new TypeError("End time must be set to a number.");e=n;this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(n){o=""+n;this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return s},set:function(n){s=n;this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return h},set:function(n){var t=ost(n);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");h=t;this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(n){c=!!n;this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return l},set:function(n){if(typeof n!="number"&&n!==ust)throw new SyntaxError("An invalid number or illegal string was specified.");l=n;this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return a},set:function(n){var t=wl(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");a=t;this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return v},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");v=n;this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return y},set:function(n){var t=wl(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t;this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return p},set:function(n){if(n<0||n>100)throw new Error("Size must be between 0 and 100.");p=n;this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return w},set:function(n){var t=wl(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t;this.hasBeenReset=!0}}});this.displayState=undefined}function sst(n){if(typeof n!="string")return!1;var t=ak[n.toLowerCase()];return t?n.toLowerCase():!1}function re(n){return typeof n=="number"&&n>=0&&n<=100}function hst(){var n=100,t=3,i=0,r=100,u=0,f=100,e="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return n},set:function(t){if(!re(t))throw new Error("Width must be between 0 and 100.");n=t}},lines:{enumerable:!0,get:function(){return t},set:function(n){if(typeof n!="number")throw new TypeError("Lines must be set to a number.");t=n}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(n){if(!re(n))throw new Error("RegionAnchorX must be between 0 and 100.");r=n}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(n){if(!re(n))throw new Error("RegionAnchorY must be between 0 and 100.");i=n}},viewportAnchorY:{enumerable:!0,get:function(){return f},set:function(n){if(!re(n))throw new Error("ViewportAnchorY must be between 0 and 100.");f=n}},viewportAnchorX:{enumerable:!0,get:function(){return u},set:function(n){if(!re(n))throw new Error("ViewportAnchorX must be between 0 and 100.");u=n}},scroll:{enumerable:!0,get:function(){return e},set:function(n){var t=sst(n);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");e=t}}})}function lst(n,t,i,r,u){var e,f;return u===void 0&&(u={}),e=n.textTracks(),u.kind=t,i&&(u.label=i),r&&(u.language=r),u.tech=n,f=new ct.text.TrackClass(u),e.addTrack(f),f}function ast(n,t){lr[n]=lr[n]||[];lr[n].push(t)}function vst(n,t,i){n.setTimeout(function(){return ar(t,lr[t.type],i,n)},1)}function yst(n,t){n.forEach(function(n){return n.setTech&&n.setTech(t)})}function vk(n,t,i){return n.reduceRight(kl(i),t[i]())}function pst(n,t,i,r){return t[i](n.reduce(kl(i),r))}function yk(n,t,i,r){r===void 0&&(r=null);var o="call"+b(i),u=n.reduce(kl(o),r),f=u===po,e=f?null:t[i](u);return kst(n,i,e,f),e}function kl(n){return function(t,i){return t===po?po:i[n]?i[n](t):t}}function kst(n,t,i,r){for(var f,u=n.length-1;u>=0;u--)f=n[u],f[t]&&f[t](r,i)}function dst(n){bl[n.id()]=null}function gst(n,t){var r=bl[n.id()],i=null,u;if(r===undefined||r===null)return i=t(n),bl[n.id()]=[[t,i]],i;for(u=0;u<r.length;u++){var f=r[u],e=f[0],o=f[1];e===t&&(i=o)}return i===null&&(i=t(n),r.push([t,i])),i}function ar(n,t,i,r,u,f){var o;n===void 0&&(n={});t===void 0&&(t=[]);u===void 0&&(u=[]);f===void 0&&(f=!1);var h=t,s=h[0],e=h.slice(1);if(typeof s=="string")ar(n,lr[s],i,r,u,f);else if(s){if(o=gst(r,s),!o.setSource)return u.push(o),ar(n,e,i,r,u,f);o.setSource(y({},n),function(t,s){if(t)return ar(n,e,i,r,u,f);u.push(o);ar(s,n.type===s.type?e:lr[s.type],i,r,u,f)})}else e.length?ar(n,e,i,r,u,f):f?i(n,u):ar(n,lr["*"],i,r,u,!0)}function kk(n){var t=wk(n.src);return!n.type&&t&&(n.type=t),n}function dl(n,t){var i;if(n.length===4)i=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)i=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function gl(n,t,i){try{n.style[t]=i}catch(r){return}}function rht(n){wo=n}function uht(){wo=ia}function cu(n,t){return t===void 0&&(t=n),wo(n,t)}function ig(n,t){return t&&(n=t(n)),n&&n!=="none"?n:void 0}function fht(n,t){var i=n.options[n.options.selectedIndex].value;return ig(i,t)}function eht(n,t,i){if(t)for(var r=0;r<n.options.length;r++)if(ig(n.options[r].value,i)===t){n.selectedIndex=r;break}}function og(){var n=oc(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return og=function(){return n},n}function hg(){var n=oc(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return hg=function(){return n},n}function i(n,u,f){var e=i.getPlayer(n),o,s;if(e)return u&&c.warn('Player "'+n+'" is already initialised. Options will not be applied.'),f&&e.ready(f),e;if(o=typeof n=="string"?ki("#"+yg(n)):n,!sf(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");return t.body.contains(o)||c.warn("The element supplied is not included in the DOM"),u=u||{},i.hooks("beforesetup").forEach(function(n){var t=n(o,p(u));if(!bi(t)||Array.isArray(t)){c.error("please return an object in beforesetup hooks");return}u=p(u,t)}),s=r.getComponent("Player"),e=new s(o,u,f),i.hooks("setup").forEach(function(n){return n(e)}),e}function sct(n,t){return t={exports:{}},n(t,t.exports),t.exports}function tlt(t){for(var r=n.atob(t),u=new Uint8Array(r.length),i=0;i<r.length;i++)u[i]=r.charCodeAt(i);return u}function pyt(n){return n.subarray(0,n.byteLength-n[n.byteLength-1])}function wrt(n,t){return function(i){var u=this,e,f,r;if(t){if(ef&&!i)return e=t.toString().replace(/^function.+?{/,"").slice(0,-1),f=brt(e),this[dy]=new ef(f),lwt(this[dy],f),this[dy];r={postMessage:function(n){u.onmessage&&setTimeout(function(){u.onmessage({data:n,target:r})})}};t.call(r);this.postMessage=function(n){setTimeout(function(){r.onmessage({data:n,target:u})})};this.isThisThread=!0}else return new ef(n)}}function brt(n){try{return ff.createObjectURL(new Blob([n],{type:hwt}))}catch(i){var t=new cwt;return t.append(n),ff.createObjectURL(t.getBlob(type))}}function lwt(n,t){if(n&&t){var i=n.terminate;n.objURL=t;n.terminate=function(){n.objURL&&ff.revokeObjectURL(n.objURL);i.call(n)}}}function no(){}var fc,at,lp,c,sc,ru,di,pc,aw,pf,dw,r,bf,kf,hr,cb,cr,vb,kb,vl,yt,su,ct,ao,pl,lk,ak,v,dk,fe,gk,td,id,oi,na,rd,ta,ia,wo,vr,bo,ko,ud,go,fd,ns,ed,od,ts,ra,ua,fa,cd,ld,rs,ea,ad,oa,sa,us,fs,es,lu,au,ha,yr,ca,os,ss,hs,cs,ls,la,as,aa,va,vs,ya,pa,vd,wa,ba,rg,ug,u,ee,tv,sg,lg,k,vu,oe,ds,gt,cv,h,hn,cn,lv,ln,an,vn,yn,av,pn,wn,bn,kn,dn,gn,ntt,ttt,itt,rtt,utt,ftt,vv,s,yv,ett,ott,stt,htt,ctt,ltt,att,vtt,rh,ytt,ptt,wtt,wr,le,dv,lh,ni,ah,gv,ny,nit,tit,vh,pe,iit,rit,yh,ic,gy,np,up,ht,dut,gut;n=n&&n.hasOwnProperty("default")?n["default"]:n;t=t&&t.hasOwnProperty("default")?t["default"]:t;fc="7.3.0";at=[];lp=function(t,i){return function(r,u,f){var o=i.levels[u],s=new RegExp("^("+o+")$"),e;(r!=="log"&&f.unshift(r.toUpperCase()+":"),f.unshift(t+":"),at&&at.push([].concat(f)),n.console)&&(e=n.console[r],e||r!=="debug"||(e=n.console.info||n.console.log),e&&o&&s.test(r))&&e[Array.isArray(f)?"apply":"call"](n.console,f)}};c=ap("VIDEOJS");sc=c.createLogger;var hc=function(n){for(var i="",t=0;t<arguments.length;t++)i+=ift(n[t])+(arguments[t+1]||"");return i},rft=Object.prototype.toString,vp=function(n){return bi(n)?Object.keys(n):[]};var ki=kp("querySelector"),ow=kp("querySelectorAll"),sw=Object.freeze({isReal:tu,isEl:sf,isInFrame:bp,createEl:d,textContent:hf,prependTo:ro,hasClass:ur,addClass:fr,removeClass:cf,toggleClass:dp,setAttributes:gp,getAttributes:ai,getAttribute:nw,setAttribute:lf,removeAttribute:uo,blockTextSelection:tw,unblockTextSelection:iw,getBoundingClientRect:af,findPosition:rw,getPointerPosition:lc,isTextNode:uw,emptyEl:ac,normalizeContent:fw,appendContent:vc,insertContent:ew,isSingleLeftClick:iu,$:ki,$$:ow}),eft=1;ru={};di="vdata"+(new Date).getTime();pc=!1,function(){try{var t=Object.defineProperty({},"passive",{get:function(){pc=!0}});n.addEventListener("test",null,t);n.removeEventListener("test",null,t)}catch(r){}}();aw=["touchstart","touchmove"];var oft=Object.freeze({fixEvent:fo,on:fi,off:vt,trigger:uu,one:yf}),wc=!1,bc,sft=function(){var r,u,n,f;if(tu()&&bc.options.autoSetup!==!1){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),o=Array.prototype.slice.call(t.getElementsByTagName("audio")),s=Array.prototype.slice.call(t.getElementsByTagName("video-js")),i=e.concat(o,s);if(i&&i.length>0)for(r=0,u=i.length;r<u;r++)if(n=i[r],n&&n.getAttribute)n.player===undefined&&(f=n.getAttribute("data-setup"),f!==null&&bc(n));else{kc(1);break}else wc||kc(1)}};tu()&&t.readyState==="complete"?wc=!0:yf(n,"load",function(){wc=!0});var vw=function(n){var i=t.createElement("style");return i.className=n,i},yw=function(n,t){n.styleSheet?n.styleSheet.cssText=t:n.textContent=t},o=function(n,t,i){t.guid||(t.guid=er());var r=function(){return t.apply(n,arguments)};return r.guid=i?i+"_"+t.guid:t.guid,r},fu=function(n,t){var i=Date.now();return function(){var r=Date.now();r-i>=t&&(n.apply(void 0,arguments),i=r)}},hft=function(t,i,r,u){u===void 0&&(u=n);var f,o=function(){u.clearTimeout(f);f=null},e=function(){var n=this,e=arguments,o=function(){f=null;o=null;r||t.apply(n,e)};!f&&r&&t.apply(n,e);u.clearTimeout(f);f=u.setTimeout(o,i)};return e.cancel=o,e},tt=function(){};tt.prototype.allowedEvents_={};tt.prototype.on=function(n,t){var i=this.addEventListener;this.addEventListener=function(){};fi(this,n,t);this.addEventListener=i};tt.prototype.addEventListener=tt.prototype.on;tt.prototype.off=function(n,t){vt(this,n,t)};tt.prototype.removeEventListener=tt.prototype.off;tt.prototype.one=function(n,t){var i=this.addEventListener;this.addEventListener=function(){};yf(this,n,t);this.addEventListener=i};tt.prototype.trigger=function(n){var t=n.type||n;typeof n=="string"&&(n={type:t});n=fo(n);this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](n);uu(this,n)};tt.prototype.dispatchEvent=tt.prototype.trigger;tt.prototype.queueTrigger=function(t){var u=this,r,i,f,e;pf||(pf=new Map);r=t.type||t;i=pf.get(this);i||(i=new Map,pf.set(this,i));f=i.get(r);i.delete(r);n.clearTimeout(f);e=n.setTimeout(function(){i.size===0&&(i=null,pf.delete(u));u.trigger(t)},0);i.set(r,e)};var eo=function(n){return n instanceof tt||!!n.eventBusEl_&&["on","one","off","trigger"].every(function(t){return typeof n[t]=="function"})},pw=function(n){return typeof n=="string"&&/\S/.test(n)||Array.isArray(n)&&!!n.length},dc=function(n){if(!n.nodeName&&!eo(n))throw new Error("Invalid target; must be a DOM node or evented object.");},ww=function(n){if(!pw(n))throw new Error("Invalid event type; must be a non-empty string or array.");},bw=function(n){if(typeof n!="function")throw new Error("Invalid listener; must be a function.");},kw=function(n,t){var f=t.length<3||t[0]===n||t[0]===n.eventBusEl_,r,u,i;return f?(r=n.eventBusEl_,t.length>=3&&t.shift(),u=t[0],i=t[1]):(r=t[0],u=t[1],i=t[2]),dc(r),ww(u),bw(i),i=o(n,i),{isTargetingSelf:f,target:r,type:u,listener:i}},wf=function(n,t,i,r){dc(n);n.nodeName?oft[t](n,i,r):n[t](i,r)},cft={on:function(){for(var r,f,e=this,o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];var t=kw(this,s),c=t.isTargetingSelf,u=t.target,h=t.type,i=t.listener;wf(u,"on",h,i);c||(r=function(){return e.off(u,h,i)},r.guid=i.guid,f=function(){return e.off("dispose",r)},f.guid=i.guid,wf(this,"on","dispose",r),wf(u,"on","dispose",f))},one:function(){for(var i,s=this,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];var t=kw(this,o),h=t.isTargetingSelf,r=t.target,u=t.type,f=t.listener;h?wf(r,"one",u,f):(i=function i(){s.off(r,u,i);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];f.apply(null,e)},i.guid=f.guid,wf(r,"one",u,i))},off:function(n,t,i){if(!n||pw(n))vt(this.eventBusEl_,n,t);else{var r=n,u=t;dc(r);ww(u);bw(i);i=o(this,i);this.off("dispose",i);r.nodeName?(vt(r,u,i),vt(r,"dispose",i)):eo(r)&&(r.off(u,i),r.off("dispose",i))}},trigger:function(n,t){return uu(this.eventBusEl_,n,t)}};dw={state:{},setState:function(n){var i=this,t;return typeof n=="function"&&(n=n()),nu(n,function(n,r){i.state[r]!==n&&(t=t||{},t[r]={from:i.state[r],to:n});i.state[r]=n}),t&&eo(this)&&this.trigger({changes:t,type:"statechanged"}),t}};r=function(){function i(n,t,i){if(this.player_=!n&&this.play?n=this:n,this.options_=p({},this.options_),t=this.options_=p(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=n&&n.id&&n.id()||"no_player";this.id_=r+"_component_"+er()}this.name_=t.name||null;t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl());t.evented!==!1&&gc(this,{eventBusKey:this.el_?"el_":null});gw(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};t.initChildren!==!1&&this.initChildren();this.ready(i);t.reportTouchActivity!==!1&&this.enableTouchActivity()}var t=i.prototype;return t.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),cw(this.el_),this.el_=null);this.player_=null},t.player=function(){return this.player_},t.options=function(n){return(c.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),!n)?this.options_:(this.options_=p(this.options_,n),this.options_)},t.el=function(){return this.el_},t.createEl=function(n,t,i){return d(n,t,i)},t.localize=function(n,t,i){i===void 0&&(i=n);var f=this.player_.language&&this.player_.language(),u=this.player_.languages&&this.player_.languages(),e=u&&u[f],s=f&&f.split("-")[0],o=u&&u[s],r=i;return e&&e[n]?r=e[n]:o&&o[n]&&(r=o[n]),t&&(r=r.replace(/\{(\d+)\}/g,function(n,i){var r=t[i-1],u=r;return typeof r=="undefined"&&(u=n),u})),r},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(n){return this.childIndex_[n]},t.getChild=function(n){if(n)return n=b(n),this.childNameIndex_[n]},t.addChild=function(n,t,r){var u,f,o,e,s,h;if(t===void 0&&(t={}),r===void 0&&(r=this.children_.length),typeof n=="string"){if(f=b(n),o=t.componentClass||f,t.name=f,e=i.getComponent(o),!e)throw new Error("Component "+o+" does not exist");if(typeof e!="function")return null;u=new e(this.player_||this,t)}else u=n;return this.children_.splice(r,0,u),typeof u.id=="function"&&(this.childIndex_[u.id()]=u),f=f||u.name&&b(u.name()),f&&(this.childNameIndex_[f]=u),typeof u.el=="function"&&u.el()&&(s=this.contentEl().children,h=s[r]||null,this.contentEl().insertBefore(u.el(),h)),u},t.removeChild=function(n){var i,t,r;if(typeof n=="string"&&(n=this.getChild(n)),n&&this.children_){for(i=!1,t=this.children_.length-1;t>=0;t--)if(this.children_[t]===n){i=!0;this.children_.splice(t,1);break}i&&(this.childIndex_[n.id()]=null,this.childNameIndex_[n.name()]=null,r=n.el(),r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(n.el()))}},t.initChildren=function(){var t=this,n=this.options_.children;if(n){var u=this.options_,f=function(n){var r=n.name,i=n.opts,f;(u[r]!==undefined&&(i=u[r]),i!==!1)&&(i===!0&&(i={}),i.playerOptions=t.options_.playerOptions,f=t.addChild(r,i),f&&(t[r]=f))},r,e=i.getComponent("Tech");r=Array.isArray(n)?n:Object.keys(n);r.concat(Object.keys(this.options_).filter(function(n){return!r.some(function(t){return typeof t=="string"?n===t:n===t.name})})).map(function(i){var r,u;return typeof i=="string"?(r=i,u=n[r]||t.options_[r]||{}):(r=i.name,u=i),{name:r,opts:u}}).filter(function(n){var t=i.getComponent(n.opts.componentClass||b(n.name));return t&&!e.isTech(t)}).forEach(f)}},t.buildCSSClass=function(){return""},t.ready=function(n,t){if(t===void 0&&(t=!1),n){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(n);return}t?n.call(this):this.setTimeout(n,1)}},t.triggerReady=function(){this.isReady_=!0;this.setTimeout(function(){var n=this.readyQueue_;this.readyQueue_=[];n&&n.length>0&&n.forEach(function(n){n.call(this)},this);this.trigger("ready")},1)},t.$=function(n,t){return ki(n,t||this.contentEl())},t.$$=function(n,t){return ow(n,t||this.contentEl())},t.hasClass=function(n){return ur(this.el_,n)},t.addClass=function(n){fr(this.el_,n)},t.removeClass=function(n){cf(this.el_,n)},t.toggleClass=function(n,t){dp(this.el_,n,t)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(n){return nw(this.el_,n)},t.setAttribute=function(n,t){lf(this.el_,n,t)},t.removeAttribute=function(n){uo(this.el_,n)},t.width=function(n,t){return this.dimension("width",n,t)},t.height=function(n,t){return this.dimension("height",n,t)},t.dimensions=function(n,t){this.width(n,!0);this.height(t)},t.dimension=function(n,t,i){if(t!==undefined){(t===null||t!==t)&&(t=0);this.el_.style[n]=(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?t:t==="auto"?"":t+"px";i||this.trigger("componentresize");return}if(!this.el_)return 0;var r=this.el_.style[n],u=r.indexOf("px");return u!==-1?parseInt(r.slice(0,u),10):parseInt(this.el_["offset"+b(n)],10)},t.currentDimension=function(t){var i=0,r,u;if(t!=="width"&&t!=="height")throw new Error("currentDimension only accepts width or height value");return typeof n.getComputedStyle=="function"&&(r=n.getComputedStyle(this.el_),i=r.getPropertyValue(t)||r[t]),i=parseFloat(i),i===0&&(u="offset"+b(t),i=this.el_[u]),i},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.emitTapEvents=function(){var r=0,n=null,u=10,f=200,t,i;this.on("touchstart",function(i){i.touches.length===1&&(n={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},r=(new Date).getTime(),t=!0)});this.on("touchmove",function(i){if(i.touches.length>1)t=!1;else if(n){var r=i.touches[0].pageX-n.pageX,f=i.touches[0].pageY-n.pageY,e=Math.sqrt(r*r+f*f);e>u&&(t=!1)}});i=function(){t=!1};this.on("touchleave",i);this.on("touchcancel",i);this.on("touchend",function(i){if(n=null,t===!0){var u=(new Date).getTime()-r;u<f&&(i.preventDefault(),this.trigger("tap"))}})},t.enableTouchActivity=function(){var n,t,i;if(this.player()&&this.player().reportUserActivity){n=o(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){n();this.clearInterval(t);t=this.setInterval(n,250)});i=function(){n();this.clearInterval(t)};this.on("touchmove",n);this.on("touchend",i);this.on("touchcancel",i)}},t.setTimeout=function(t,i){var f=this,r,u;t=o(this,t);r=n.setTimeout(function(){f.off("dispose",u);t()},i);u=function(){return f.clearTimeout(r)};u.guid="vjs-timeout-"+r;this.on("dispose",u);return r},t.clearTimeout=function(t){n.clearTimeout(t);var i=function(){};return i.guid="vjs-timeout-"+t,this.off("dispose",i),t},t.setInterval=function(t,i){var f=this,r,u;t=o(this,t);r=n.setInterval(t,i);u=function(){return f.clearInterval(r)};u.guid="vjs-interval-"+r;this.on("dispose",u);return r},t.clearInterval=function(t){n.clearInterval(t);var i=function(){};return i.guid="vjs-interval-"+t,this.off("dispose",i),t},t.requestAnimationFrame=function(t){var u=this,i,r;if(this.supportsRaf_){t=o(this,t);i=n.requestAnimationFrame(function(){u.off("dispose",r);t()});r=function(){return u.cancelAnimationFrame(i)};r.guid="vjs-raf-"+i;this.on("dispose",r);return i}return this.setTimeout(t,1e3/60)},t.cancelAnimationFrame=function(t){if(this.supportsRaf_){n.cancelAnimationFrame(t);var i=function(){};return i.guid="vjs-raf-"+t,this.off("dispose",i),t}return this.clearTimeout(t)},i.registerComponent=function(n,t){var s,r,u,f;if(typeof n!="string"||!n)throw new Error('Illegal component name, "'+n+'"; must be a non-empty string.');var e=i.getComponent("Tech"),o=e&&e.isTech(t),h=i===t||i.prototype.isPrototypeOf(t.prototype);if(o||!h){s=o?"techs must be registered using Tech.registerTech()":"must be a Component subclass";throw new Error('Illegal component, "'+n+'"; '+s+".");}if(n=b(n),i.components_||(i.components_={}),r=i.getComponent("Player"),n==="Player"&&r&&r.players&&(u=r.players,f=Object.keys(u),u&&f.length>0&&f.map(function(n){return u[n]}).every(Boolean)))throw new Error("Can not register Player component after player has been created.");return i.components_[n]=t,t},i.getComponent=function(n){if(n)return n=b(n),i.components_&&i.components_[n]?i.components_[n]:void 0},i}();r.prototype.supportsRaf_=typeof n.requestAnimationFrame=="function"&&typeof n.cancelAnimationFrame=="function";r.registerComponent("Component",r);var it=n.navigator&&n.navigator.userAgent||"",nb=/AppleWebKit\/([\d.]+)/i.exec(it),aft=nb?parseFloat(nb.pop()):null,nl=/iPad/i.test(it),tl=/iPhone/i.test(it)&&!nl,tb=/iPod/i.test(it),vi=tl||nl||tb,vft=function(){var n=it.match(/OS (\d+)_/i);return n&&n[1]?n[1]:null}(),or=/Android/i.test(it),il=function(){var n=it.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),t,i;return n?(t=n[1]&&parseFloat(n[1]),i=n[2]&&parseFloat(n[2]),t&&i)?parseFloat(n[1]+"."+n[2]):t?t:null:null}(),ib=or&&il<5&&aft<537,rb=/Firefox/i.test(it),rl=/Edge/i.test(it),gi=!rl&&(/Chrome/i.test(it)||/CriOS/i.test(it)),ub=function(){var n=it.match(/(Chrome|CriOS)\/(\d+)/);return n&&n[2]?parseFloat(n[2]):null}(),fb=function(){var t=/MSIE\s(\d+)\.\d/.exec(it),n=t&&parseFloat(t[1]);return!n&&/Trident\/7.0/i.test(it)&&/rv:11.0/.test(it)&&(n=11),n}(),eb=/Safari/i.test(it)&&!gi&&!or&&!rl,ob=(eb||vi)&&!gi,oo=tu()&&("ontouchstart"in n||n.navigator.maxTouchPoints||n.DocumentTouch&&n.document instanceof n.DocumentTouch),yft=Object.freeze({IS_IPAD:nl,IS_IPHONE:tl,IS_IPOD:tb,IS_IOS:vi,IOS_VERSION:vft,IS_ANDROID:or,ANDROID_VERSION:il,IS_NATIVE_ANDROID:ib,IS_FIREFOX:rb,IS_EDGE:rl,IS_CHROME:gi,CHROME_VERSION:ub,IE_VERSION:fb,IS_SAFARI:eb,IS_ANY_SAFARI:ob,TOUCH_ENABLED:oo});var so={},ho=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],wft=ho[0],co;for(bf=0;bf<ho.length;bf++)if(ho[bf][1]in t){co=ho[bf];break}if(co)for(kf=0;kf<co.length;kf++)so[wft[kf]]=co[kf];for(rt.prototype.code=0,rt.prototype.message="",rt.prototype.status=null,rt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],rt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},hr=0;hr<rt.errorTypes.length;hr++)rt[rt.errorTypes[hr]]=hr,rt.prototype[rt.errorTypes[hr]]=hr;cb=bft;var fl=function(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,i){return n[i]&&(t[i]=n[i]),t},{cues:n.cues&&Array.prototype.map.call(n.cues,function(n){return{startTime:n.startTime,endTime:n.endTime,text:n.text,id:n.id}})})},kft=function(n){var t=n.$$("track"),i=Array.prototype.map.call(t,function(n){return n.track}),r=Array.prototype.map.call(t,function(n){var t=fl(n.track);return n.src&&(t.src=n.src),t});return r.concat(Array.prototype.filter.call(n.textTracks(),function(n){return i.indexOf(n)===-1}).map(fl))},dft=function(n,t){return n.forEach(function(n){var i=t.addRemoteTextTrack(n).track;!n.src&&n.cues&&n.cues.forEach(function(n){return i.addCue(n)})}),t.textTracks()},ab={textTracksToJson:kft,jsonToTextTracks:dft,trackToJson_:fl},el="vjs-modal-dialog",gft=27,eu=function(i){function u(n,t){var r;return r=i.call(this,n,t)||this,r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=d("div",{className:el+"-content"},{role:"document"}),r.descEl_=d("p",{className:el+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),hf(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}e(u,i);var r=u.prototype;return r.createEl=function(){return i.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},r.dispose=function(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;i.prototype.dispose.call(this)},r.buildCSSClass=function(){return el+" vjs-hidden "+i.prototype.buildCSSClass.call(this)},r.handleKeyPress=function(n){n.which===gft&&this.closeable()&&this.close()},r.label=function(){return this.localize(this.options_.label||"Modal Window")},r.description=function(){var n=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(n+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),n},r.open=function(){if(!this.opened_){var n=this.player();if(this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!n.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&n.pause(),this.closeable())this.on(this.el_.ownerDocument,"keydown",o(this,this.handleKeyPress));this.hadControls_=n.controls();n.controls(!1);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=!0}},r.opened=function(n){return typeof n=="boolean"&&this[n?"open":"close"](),this.opened_},r.close=function(){if(this.opened_){var n=this.player();this.trigger("beforemodalclose");this.opened_=!1;this.wasPlaying_&&this.options_.pauseOnOpen&&n.play();this.closeable()&&this.off(this.el_.ownerDocument,"keydown",o(this,this.handleKeyPress));this.hadControls_&&n.controls(!0);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();this.options_.temporary&&this.dispose()}},r.closeable=function(n){var i,t,r;if(typeof n=="boolean"){if(i=this.closeable_=!!n,t=this.getChild("closeButton"),i&&!t){r=this.contentEl_;this.contentEl_=this.el_;t=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=r;this.on(t,"close",this.close)}!i&&t&&(this.off(t,"close",this.close),this.removeChild(t),t.dispose())}return this.closeable_},r.fill=function(){this.fillWith(this.content())},r.fillWith=function(n){var t=this.contentEl(),i=t.parentNode,u=t.nextSibling,r;this.trigger("beforemodalfill");this.hasBeenFilled_=!0;i.removeChild(t);this.empty();ew(t,n);this.trigger("modalfill");u?i.insertBefore(t,u):i.appendChild(t);r=this.getChild("closeButton");r&&i.appendChild(r.el_)},r.empty=function(){this.trigger("beforemodalempty");ac(this.contentEl());this.trigger("modalempty")},r.content=function(n){return typeof n!="undefined"&&(this.content_=n),this.content_},r.conditionalFocus_=function(){var n=t.activeElement,i=this.player_.el_;if(this.previouslyActiveEl_=null,i.contains(n)||i===n){this.previouslyActiveEl_=n;this.focus();this.on(t,"keydown",this.handleKeyDown)}},r.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null);this.off(t,"keydown",this.handleKeyDown)},r.handleKeyDown=function(n){var i,f,u,r;if(n.which===9){for(i=this.focusableEls_(),f=this.el_.querySelector(":focus"),r=0;r<i.length;r++)if(f===i[r]){u=r;break}t.activeElement===this.el_&&(u=0);n.shiftKey&&u===0?(i[i.length-1].focus(),n.preventDefault()):n.shiftKey||u!==i.length-1||(i[0].focus(),n.preventDefault())}},r.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof n.HTMLAnchorElement||t instanceof n.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof n.HTMLInputElement||t instanceof n.HTMLSelectElement||t instanceof n.HTMLTextAreaElement||t instanceof n.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof n.HTMLIFrameElement||t instanceof n.HTMLObjectElement||t instanceof n.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable")})},u}(r);eu.prototype.options_={pauseOnOpen:!0,temporary:!0};r.registerComponent("ModalDialog",eu);cr=function(n){function t(t){var i,r;for(t===void 0&&(t=[]),i=n.call(this)||this,i.tracks_=[],Object.defineProperty(f(f(i)),"length",{get:function(){return this.tracks_.length}}),r=0;r<t.length;r++)i.addTrack(t[r]);return i}e(t,n);var i=t.prototype;return i.addTrack=function(n){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}});this.tracks_.indexOf(n)===-1&&(this.tracks_.push(n),this.trigger({track:n,type:"addtrack"}))},i.removeTrack=function(n){for(var t,i=0,r=this.length;i<r;i++)if(this[i]===n){t=this[i];t.off&&t.off();this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack"})},i.getTrackById=function(n){for(var i,r=null,t=0,u=this.length;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},t}(tt);cr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(vb in cr.prototype.allowedEvents_)cr.prototype["on"+vb]=null;var ol=function(n,t){for(var i=0;i<n.length;i++)Object.keys(n[i]).length&&t.id!==n[i].id&&(n[i].enabled=!1)},net=function(n){function t(t){var r,i;for(t===void 0&&(t=[]),i=t.length-1;i>=0;i--)if(t[i].enabled){ol(t,t[i]);break}return r=n.call(this,t)||this,r.changing_=!1,r}e(t,n);var i=t.prototype;return i.addTrack=function(t){var i=this;(t.enabled&&ol(this,t),n.prototype.addTrack.call(this,t),t.addEventListener)&&t.addEventListener("enabledchange",function(){i.changing_||(i.changing_=!0,ol(i,t),i.changing_=!1,i.trigger("change"))})},t}(cr),sl=function(n,t){for(var i=0;i<n.length;i++)Object.keys(n[i]).length&&t.id!==n[i].id&&(n[i].selected=!1)},tet=function(n){function t(t){var r,i;for(t===void 0&&(t=[]),i=t.length-1;i>=0;i--)if(t[i].selected){sl(t,t[i]);break}return r=n.call(this,t)||this,r.changing_=!1,Object.defineProperty(f(f(r)),"selectedIndex",{get:function(){for(var n=0;n<this.length;n++)if(this[n].selected)return n;return-1},set:function(){}}),r}e(t,n);var i=t.prototype;return i.addTrack=function(t){var i=this;(t.selected&&sl(this,t),n.prototype.addTrack.call(this,t),t.addEventListener)&&t.addEventListener("selectedchange",function(){i.changing_||(i.changing_=!0,sl(i,t),i.changing_=!1,i.trigger("change"))})},t}(cr),yb=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.addTrack=function(t){n.prototype.addTrack.call(this,t);t.addEventListener("modechange",o(this,function(){this.queueTrigger("change")}));["metadata","chapters"].indexOf(t.kind)===-1&&t.addEventListener("modechange",o(this,function(){this.trigger("selectedlanguagechange")}))},t}(cr),iet=function(){function t(n){n===void 0&&(n=[]);this.trackElements_=[];Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=n.length;t<i;t++)this.addTrackElement_(n[t])}var n=t.prototype;return n.addTrackElement_=function(n){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}});this.trackElements_.indexOf(n)===-1&&this.trackElements_.push(n)},n.getTrackElementByTrack_=function(n){for(var i,t=0,r=this.trackElements_.length;t<r;t++)if(n===this.trackElements_[t].track){i=this.trackElements_[t];break}return i},n.removeTrackElement_=function(n){for(var t=0,i=this.trackElements_.length;t<i;t++)if(n===this.trackElements_[t]){this.trackElements_.splice(t,1);break}},t}(),pb=function(){function n(t){n.prototype.setCues_.call(this,t);Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=n.prototype;return t.setCues_=function(n){var i=this.length||0,t=0,r=n.length,u;if(this.cues_=n,this.length_=n.length,u=function(n){""+n in this||Object.defineProperty(this,""+n,{get:function(){return this.cues_[n]}})},i<r)for(t=i;t<r;t++)u.call(this,t)},t.getCueById=function(n){for(var i,r=null,t=0,u=this.length;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},n}(),ret={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},uet={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},fet={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},wb={disabled:"disabled",hidden:"hidden",showing:"showing"},hl=function(n){function t(t){var i,r,u,e;t===void 0&&(t={});i=n.call(this)||this;r={id:t.id||"vjs_track_"+er(),kind:t.kind||"",label:t.label||"",language:t.language||""};u=function(n){Object.defineProperty(f(f(i)),n,{get:function(){return r[n]},set:function(){}})};for(e in r)u(e);return i}return e(t,n),t}(tt),cl=function(i){var o=["protocol","hostname","port","pathname","search","hash","host"],f=t.createElement("a"),s,u,r,e;for(f.href=i,s=f.host===""&&f.protocol!=="file:",s&&(u=t.createElement("div"),u.innerHTML='<a href="'+i+'"><\/a>',f=u.firstChild,u.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(u)),r={},e=0;e<o.length;e++)r[o[e]]=f[o[e]];return r.protocol==="http:"&&(r.host=r.host.replace(/:80$/,"")),r.protocol==="https:"&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=n.location.protocol),s&&t.body.removeChild(u),r},bb=function(n){if(!n.match(/^https?:\/\//)){var i=t.createElement("div");i.innerHTML='<a href="'+n+'">x<\/a>';n=i.firstChild.href}return n},ll=function(n){if(typeof n=="string"){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(n);if(t)return t.pop().toLowerCase()}return""},lo=function(t){var i=n.location,r=cl(t),u=r.protocol===":"?i.protocol:r.protocol;return u+r.host!==i.protocol+i.host},eet=Object.freeze({parseUrl:cl,getAbsoluteURL:bb,getFileExtension:ll,isCrossOrigin:lo}),oet=het,set=Object.prototype.toString;kb=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};var gf=al(function(n,t){function i(n){return n.replace(/^\s*|\s*$/g,"")}t=n.exports=i;t.left=function(n){return n.replace(/^\s*/,"")};t.right=function(n){return n.replace(/\s*$/,"")}}),kdt=gf.left,ddt=gf.right,db=Function.prototype.toString,cet=/^\s*class\b/,gb=function(n){try{var t=db.call(n);return cet.test(t)}catch(i){return!1}},aet=function(n){try{return gb(n)?!1:(db.call(n),!0)}catch(t){return!1}},vet=Object.prototype.toString,yet="[object Function]",pet="[object GeneratorFunction]",wet=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",bet=function(n){if(!n||typeof n!="function"&&typeof n!="object")return!1;if(typeof n=="function"&&!n.prototype)return!0;if(wet)return aet(n);if(gb(n))return!1;var t=vet.call(n);return t===yet||t===pet},ket=Object.prototype.toString,nk=Object.prototype.hasOwnProperty,det=function(n,t,i){for(var r=0,u=n.length;r<u;r++)nk.call(n,r)&&(i==null?t(n[r],r,n):t.call(i,n[r],r,n))},get=function(n,t,i){for(var r=0,u=n.length;r<u;r++)i==null?t(n.charAt(r),r,n):t.call(i,n.charAt(r),r,n)},not=function(n,t,i){for(var r in n)nk.call(n,r)&&(i==null?t(n[r],r,n):t.call(i,n[r],r,n))},tot=function(n,t,i){if(!bet(t))throw new TypeError("iterator must be a function");var r;arguments.length>=3&&(r=i);ket.call(n)==="[object Array]"?det(n,t,r):typeof n=="string"?get(n,t,r):not(n,t,r)},iot=tot,rot=function(n){return Object.prototype.toString.call(n)==="[object Array]"},uot=function(n){if(!n)return{};var t={};return iot(gf(n).split("\n"),function(n){var u=n.indexOf(":"),i=gf(n.slice(0,u)).toLowerCase(),r=gf(n.slice(u+1));typeof t[i]=="undefined"?t[i]=r:rot(t[i])?t[i].push(r):t[i]=[t[i],r]}),t},fot=oot,eot=Object.prototype.hasOwnProperty;vl=nr;nr.XMLHttpRequest=n.XMLHttpRequest||lot;nr.XDomainRequest="withCredentials"in new nr.XMLHttpRequest?nr.XMLHttpRequest:n.XDomainRequest;sot(["get","put","post","patch","head","delete"],function(n){nr[n==="delete"?"del":n]=function(t,i,r){return i=tk(t,i,r),i.method=n.toUpperCase(),ik(i)}});var rk=function(t,i){var r=new n.WebVTT.Parser(n,n.vttjs,n.WebVTT.StringDecoder()),u=[];r.oncue=function(n){i.addCue(n)};r.onparsingerror=function(n){u.push(n)};r.onflush=function(){i.trigger({type:"loadeddata",target:i})};r.parse(t);u.length>0&&(n.console&&n.console.groupCollapsed&&n.console.groupCollapsed("Text Track parsing errors for "+i.src),u.forEach(function(n){return c.error(n)}),n.console&&n.console.groupEnd&&n.console.groupEnd());r.flush()},aot=function(t,i){var r={uri:t},u=lo(t);u&&(r.cors=u);vl(r,o(this,function(t,r,u){if(t)return c.error(t,r);if(i.loaded_=!0,typeof n.WebVTT!="function"){if(i.tech_){var f=function(){return rk(u,i)};i.tech_.on("vttjsloaded",f);i.tech_.on("vttjserror",function(){c.error("vttjs failed to load, stopping trying to process "+i.src);i.tech_.off("vttjsloaded",f)})}}else rk(u,i)}))},ne=function(t){function i(n){var i;if(n===void 0&&(n={}),!n.tech)throw new Error("A tech was not provided.");var r=p(n,{kind:fet[n.kind]||"subtitles",language:n.language||n.srclang||""}),u=wb[r.mode]||"disabled",c=r.default;(r.kind==="metadata"||r.kind==="chapters")&&(u="hidden");i=t.call(this,r)||this;i.tech_=r.tech;i.cues_=[];i.activeCues_=[];var l=new pb(i.cues_),s=new pb(i.activeCues_),e=!1,h=o(f(f(i)),function(){this.activeCues=this.activeCues;e&&(this.trigger("cuechange"),e=!1)});return u!=="disabled"&&i.tech_.ready(function(){i.tech_.on("timeupdate",h)},!0),Object.defineProperties(f(f(i)),{"default":{get:function(){return c},set:function(){}},mode:{get:function(){return u},set:function(n){var t=this;wb[n]&&(u=n,u!=="disabled"?this.tech_.ready(function(){t.tech_.on("timeupdate",h)},!0):this.tech_.off("timeupdate",h),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?l:null},set:function(){}},activeCues:{get:function(){var i,t,r,f,n,u;if(!this.loaded_)return null;if(this.cues.length===0)return s;for(i=this.tech_.currentTime(),t=[],r=0,f=this.cues.length;r<f;r++)n=this.cues[r],n.startTime<=i&&n.endTime>=i?t.push(n):n.startTime===n.endTime&&n.startTime<=i&&n.startTime+.5>=i&&t.push(n);if(e=!1,t.length!==this.activeCues_.length)e=!0;else for(u=0;u<t.length;u++)this.activeCues_.indexOf(t[u])===-1&&(e=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),r.src?(i.src=r.src,aot(r.src,f(f(i)))):i.loaded_=!0,i}e(i,t);var r=i.prototype;return r.addCue=function(t){var i=t,u,f,r;if(n.vttjs&&!(t instanceof n.vttjs.VTTCue)){i=new n.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(u in t)u in i||(i[u]=t[u]);i.id=t.id;i.originalCue_=t}for(f=this.tech_.textTracks(),r=0;r<f.length;r++)f[r]!==this&&f[r].removeCue(i);this.cues_.push(i);this.cues.setCues_(this.cues_)},r.removeCue=function(n){for(var i=this.cues_.length,t;i--;)if(t=this.cues_[i],t===n||t.originalCue_&&t.originalCue_===n){this.cues_.splice(i,1);this.cues.setCues_(this.cues_);break}},i}(hl);ne.prototype.allowedEvents_={cuechange:"cuechange"};var uk=function(n){function t(t){var i,r,u;return t===void 0&&(t={}),r=p(t,{kind:uet[t.kind]||""}),i=n.call(this,r)||this,u=!1,Object.defineProperty(f(f(i)),"enabled",{get:function(){return u},set:function(n){typeof n=="boolean"&&n!==u&&(u=n,this.trigger("enabledchange"))}}),r.enabled&&(i.enabled=r.enabled),i.loaded_=!0,i}return e(t,n),t}(hl),fk=function(n){function t(t){var i,r,u;return t===void 0&&(t={}),r=p(t,{kind:ret[t.kind]||""}),i=n.call(this,r)||this,u=!1,Object.defineProperty(f(f(i)),"selected",{get:function(){return u},set:function(n){typeof n=="boolean"&&n!==u&&(u=n,this.trigger("selectedchange"))}}),r.selected&&(i.selected=r.selected),i}return e(t,n),t}(hl),ek=0,ok=2,ou=function(n){function t(t){var i,u,r;return t===void 0&&(t={}),i=n.call(this)||this,r=new ne(t),i.kind=r.kind,i.src=r.src,i.srclang=r.language,i.label=r.label,i.default=r.default,Object.defineProperties(f(f(i)),{readyState:{get:function(){return u}},track:{get:function(){return r}}}),u=ek,r.addEventListener("loadeddata",function(){u=ok;i.trigger({type:"load",target:f(f(i))})}),i}return e(t,n),t}(tt);ou.prototype.allowedEvents_={load:"load"};ou.NONE=ek;ou.LOADING=1;ou.LOADED=ok;ou.ERROR=3;yt={audio:{ListClass:net,TrackClass:uk,capitalName:"Audio"},video:{ListClass:tet,TrackClass:fk,capitalName:"Video"},text:{ListClass:yb,TrackClass:ne,capitalName:"Text"}};Object.keys(yt).forEach(function(n){yt[n].getterName=n+"Tracks";yt[n].privateName=n+"Tracks_"});su={remoteText:{ListClass:yb,TrackClass:ne,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:iet,TrackClass:ou,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};ct=p(yt,su);su.names=Object.keys(su);yt.names=Object.keys(yt);ct.names=[].concat(su.names).concat(yt.names);ao=Object.create||function(){function n(){}return function(t){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=t,new n}}();pt.prototype=ao(Error.prototype);pt.prototype.constructor=pt;pt.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};te.prototype={set:function(n,t){this.get(n)||t===""||(this.values[n]=t)},get:function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},has:function(n){return n in this.values},alt:function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},integer:function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},percent:function(n,t){var i;return(i=t.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(t=parseFloat(t),t>=0&&t<=100)?(this.set(n,t),!0):!1}};var yot={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"â€Ž","&rlm;":"â€","&nbsp;":"Â "},pot={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},wot={v:"title",lang:"lang"},sk={rt:"ruby"};pl=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];vo.prototype.applyStyles=function(n,t){t=t||this.div;for(var i in n)n.hasOwnProperty(i)&&(t.style[i]=n[i])};vo.prototype.formatStyle=function(n,t){return n===0?0:n+t};yo.prototype=ao(vo.prototype);yo.prototype.constructor=yo;ut.prototype.move=function(n,t){t=t!==undefined?t:this.lineHeight;switch(n){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t}};ut.prototype.overlaps=function(n){return this.left<n.right&&this.right>n.left&&this.top<n.bottom&&this.bottom>n.top};ut.prototype.overlapsAny=function(n){for(var t=0;t<n.length;t++)if(this.overlaps(n[t]))return!0;return!1};ut.prototype.within=function(n){return this.top>=n.top&&this.bottom<=n.bottom&&this.left>=n.left&&this.right<=n.right};ut.prototype.overlapsOppositeAxis=function(n,t){switch(t){case"+x":return this.left<n.left;case"-x":return this.right>n.right;case"+y":return this.top<n.top;case"-y":return this.bottom>n.bottom}};ut.prototype.intersectPercentage=function(n){var t=Math.max(0,Math.min(this.right,n.right)-Math.max(this.left,n.left)),i=Math.max(0,Math.min(this.bottom,n.bottom)-Math.max(this.top,n.top)),r=t*i;return r/(this.height*this.width)};ut.prototype.toCSSCompatValues=function(n){return{top:this.top-n.top,bottom:n.bottom-this.bottom,left:this.left-n.left,right:n.right-this.right,height:this.height,width:this.width}};ut.getSimpleBoxPosition=function(n){var t=n.div?n.div.offsetHeight:n.tagName?n.offsetHeight:0,r=n.div?n.div.offsetWidth:n.tagName?n.offsetWidth:0,i=n.div?n.div.offsetTop:n.tagName?n.offsetTop:0;return n=n.div?n.div.getBoundingClientRect():n.tagName?n.getBoundingClientRect():n,{left:n.left,right:n.right,top:n.top||i,height:n.height||t,bottom:n.bottom||i+(n.height||t),width:n.width||r}};hu.StringDecoder=function(){return{decode:function(n){if(!n)return"";if(typeof n!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}};hu.convertCueToDOMTree=function(n,t){return!n||!t?null:hk(n,t)};var nst=.05,tst="sans-serif",ist="1.5%";hu.processCues=function(n,t,i){function o(n){for(var t=0;t<n.length;t++)if(n[t].hasBeenReset||!n[t].displayState)return!0;return!1}var r,u;if(!n||!t||!i)return null;while(i.firstChild)i.removeChild(i.firstChild);if(r=n.document.createElement("div"),r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin=ist,i.appendChild(r),!o(t)){for(u=0;u<t.length;u++)r.appendChild(t[u].displayState);return}var f=[],e=ut.getSimpleBoxPosition(r),s=Math.round(e.height*nst*100)/100,h={font:s+"px "+tst};(function(){for(var i,u,o=0;o<t.length;o++)u=t[o],i=new yo(n,u,h),r.appendChild(i.div),got(n,i,e,f),u.displayState=i.div,f.push(ut.getSimpleBoxPosition(i))})()};hu.Parser=function(n,t,i){i||(i=t,t={});t||(t={});this.window=n;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=i||new TextDecoder("utf8");this.regionList=[]};hu.Parser.prototype={reportOrThrowError:function(n){if(n instanceof pt)this.onparsingerror&&this.onparsingerror(n);else throw n;},parse:function(n){function f(){for(var i=t.buffer,n=0,r;n<i.length&&i[n]!=="\r"&&i[n]!=="\n";)++n;return r=i.substr(0,n),i[n]==="\r"&&++n,i[n]==="\n"&&++n,t.buffer=i.substr(n),r}function s(n){var i=new te,r;ie(n,function(n,t){var u,r;switch(n){case"id":i.set(n,t);break;case"width":i.percent(n,t);break;case"lines":i.integer(n,t);break;case"regionanchor":case"viewportanchor":if(u=t.split(","),u.length!==2)break;if(r=new te,r.percent("x",u[0]),r.percent("y",u[1]),!r.has("x")||!r.has("y"))break;i.set(n+"X",r.get("x"));i.set(n+"Y",r.get("y"));break;case"scroll":i.alt(n,t,["up"])}},/=/,/\s/);i.has("id")&&(r=new(t.vttjs.VTTRegion||t.window.VTTRegion),r.width=i.get("width",100),r.lines=i.get("lines",3),r.regionAnchorX=i.get("regionanchorX",0),r.regionAnchorY=i.get("regionanchorY",100),r.viewportAnchorX=i.get("viewportanchorX",0),r.viewportAnchorY=i.get("viewportanchorY",100),r.scroll=i.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:i.get("id"),region:r}))}function h(n){var i=new te;ie(n,function(n,t){switch(n){case"MPEGT":i.integer(n+"S",t);break;case"LOCA":i.set(n+"L",yl(t))}},/[^\d]:/,/,/);t.ontimestampmap&&t.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}function c(n){n.match(/X-TIMESTAMP-MAP/)?ie(n,function(n,t){switch(n){case"X-TIMESTAMP-MAP":h(t)}},/=/):ie(n,function(n,t){switch(n){case"Region":s(t)}},/:/)}var t=this,i,u,r,o;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;if(i=f(),u=i.match(/^WEBVTT([ \t].*)?$/),!u||!u[0])throw new pt(pt.Errors.BadSignature);t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;r?r=!1:i=f();switch(t.state){case"HEADER":/:/.test(i)?c(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":try{vot(i,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e);t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(o=i.indexOf("-->")!==-1,!i||o&&(r=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){if(t.reportOrThrowError(e),t.state==="CUETEXT"&&t.cue&&t.oncue)t.oncue(t.cue);t.cue=null;t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var n=this;try{if(n.buffer+=n.decoder.decode(),(n.cue||n.state==="HEADER")&&(n.buffer+="\n\n",n.parse()),n.state==="INITIAL")throw new pt(pt.Errors.BadSignature);}catch(t){n.reportOrThrowError(t)}return n.onflush&&n.onflush(),this}};var rst=hu,ust="auto",fst={"":1,lr:1,rl:1},est={start:1,middle:1,end:1,left:1,right:1};ck.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};lk=ck;ak={"":!0,up:!0};var cst=hst,ue=al(function(t){var i=t.exports={WebVTT:rst,VTTCue:lk,VTTRegion:cst};n.vttjs=i;n.WebVTT=i.WebVTT;var r=i.VTTCue,u=i.VTTRegion,f=n.VTTCue,e=n.VTTRegion;i.shim=function(){n.VTTCue=r;n.VTTRegion=u};i.restore=function(){n.VTTCue=f;n.VTTRegion=e};n.VTTCue||i.shim()}),sgt=ue.WebVTT,hgt=ue.VTTCue,cgt=ue.VTTRegion;v=function(i){function u(n,t){var r;n===void 0&&(n={});t===void 0&&(t=function(){});n.reportTouchActivity=!1;r=i.call(this,null,n,t)||this;r.hasStarted_=!1;r.on("playing",function(){this.hasStarted_=!0});r.on("loadstart",function(){this.hasStarted_=!1});return ct.names.forEach(function(t){var i=ct[t];n&&n[i.getterName]&&(r[i.privateName]=n[i.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){n["native"+t+"Tracks"]===!1&&(r["featuresNative"+t+"Tracks"]=!1)}),n.nativeCaptions===!1||n.nativeTextTracks===!1?r.featuresNativeTextTracks=!1:(n.nativeCaptions===!0||n.nativeTextTracks===!0)&&(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.autoRemoteTextTracks_=new ct.text.ListClass,r.initTrackListeners(),n.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}e(u,i);var r=u.prototype;return r.triggerSourceset=function(n){var t=this;if(!this.isReady_)this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(n)},1)});this.trigger({src:n,type:"sourceset"})},r.manualProgressOn=function(){this.on("durationchange",this.onDurationChange);this.manualProgress=!0;this.one("ready",this.trackProgress)},r.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)},r.trackProgress=function(){this.stopTrackingProgress();this.progressInterval=this.setInterval(o(this,function(){var n=this.bufferedPercent();this.bufferedPercent_!==n&&this.trigger("progress");this.bufferedPercent_=n;n===1&&this.stopTrackingProgress()}),500)},r.onDurationChange=function(){this.duration_=this.duration()},r.buffered=function(){return sr(0,0)},r.bufferedPercent=function(){return hb(this.buffered(),this.duration_)},r.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},r.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)},r.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)},r.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},r.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.dispose=function(){this.clearTracks(yt.names);this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff();i.prototype.dispose.call(this)},r.clearTracks=function(n){var t=this;n=[].concat(n);n.forEach(function(n){for(var i=t[n+"Tracks"]()||[],u=i.length,r;u--;)r=i[u],n==="text"&&t.removeRemoteTextTrack(r),i.removeTrack(r)})},r.cleanupAutoTextTracks=function(){for(var n=this.autoRemoteTextTracks_||[],t=n.length,i;t--;)i=n[t],this.removeRemoteTextTrack(i)},r.reset=function(){},r.error=function(n){return n!==undefined&&(this.error_=new rt(n),this.trigger("error")),this.error_},r.played=function(){return this.hasStarted_?sr(0,0):sr()},r.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.initTrackListeners=function(){var n=this;yt.names.forEach(function(t){var u=yt[t],i=function(){n.trigger(t+"trackchange")},r=n[u.getterName]();r.addEventListener("removetrack",i);r.addEventListener("addtrack",i);n.on("dispose",function(){r.removeEventListener("removetrack",i);r.removeEventListener("addtrack",i)})})},r.addWebVttScript_=function(){var r=this,i;if(!n.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&of(ue)&&Object.keys(ue).length>0){this.trigger("vttjsloaded");return}i=t.createElement("script");i.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";i.onload=function(){r.trigger("vttjsloaded")};i.onerror=function(){r.trigger("vttjserror")};this.on("dispose",function(){i.onload=null;i.onerror=null});n.WebVTT=!0;this.el().parentNode.appendChild(i)}else this.ready(this.addWebVttScript_)},r.emulateTextTracks=function(){var e=this,n=this.textTracks(),r=this.remoteTextTracks(),u=function(t){return n.addTrack(t.track)},f=function(t){return n.removeTrack(t.track)},i,t;r.on("addtrack",u);r.on("removetrack",f);this.addWebVttScript_();i=function(){return e.trigger("texttrackchange")};t=function(){var t,r;for(i(),t=0;t<n.length;t++)r=n[t],r.removeEventListener("cuechange",i),r.mode==="showing"&&r.addEventListener("cuechange",i)};t();n.addEventListener("change",t);n.addEventListener("addtrack",t);n.addEventListener("removetrack",t);this.on("dispose",function(){var e,o;for(r.off("addtrack",u),r.off("removetrack",f),n.removeEventListener("change",t),n.removeEventListener("addtrack",t),n.removeEventListener("removetrack",t),e=0;e<n.length;e++)o=n[e],o.removeEventListener("cuechange",i)})},r.addTextTrack=function(n,t,i){if(!n)throw new Error("TextTrack kind is required but was not provided");return lst(this,n,t,i)},r.createRemoteTextTrack=function(n){var t=p(n,{tech:this});return new su.remoteTextEl.TrackClass(t)},r.addRemoteTextTrack=function(n,t){var r=this,i;return n===void 0&&(n={}),i=this.createRemoteTextTrack(n),t!==!0&&t!==!1&&(c.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t!==!0&&this.ready(function(){return r.autoRemoteTextTracks_.addTrack(i.track)}),i},r.removeRemoteTextTrack=function(n){var t=this.remoteTextTrackEls().getTrackElementByTrack_(n);this.remoteTextTrackEls().removeTrackElement_(t);this.remoteTextTracks().removeTrack(n);this.autoRemoteTextTracks_.removeTrack(n)},r.getVideoPlaybackQuality=function(){return{}},r.setPoster=function(){},r.playsinline=function(){},r.setPlaysinline=function(){},r.overrideNativeAudioTracks=function(){},r.overrideNativeVideoTracks=function(){},r.canPlayType=function(){return""},u.canPlayType=function(){return""},u.canPlaySource=function(n){return u.canPlayType(n.type)},u.isTech=function(n){return n.prototype instanceof u||n instanceof u||n===u},u.registerTech=function(n,t){if(u.techs_||(u.techs_={}),!u.isTech(t))throw new Error("Tech "+n+" must be a Tech");if(!u.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!u.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return n=b(n),u.techs_[n]=t,n!=="Tech"&&u.defaultTechOrder_.push(n),t},u.getTech=function(t){if(t)return(t=b(t),u.techs_&&u.techs_[t])?u.techs_[t]:n&&n.videojs&&n.videojs[t]?(c.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),n.videojs[t]):void 0},u}(r);ct.names.forEach(function(n){var t=ct[n];v.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}});v.prototype.featuresVolumeControl=!0;v.prototype.featuresMuteControl=!0;v.prototype.featuresFullscreenResize=!1;v.prototype.featuresPlaybackRate=!1;v.prototype.featuresProgressEvents=!1;v.prototype.featuresSourceset=!1;v.prototype.featuresTimeupdateEvents=!1;v.prototype.featuresNativeTextTracks=!1;v.withSourceHandlers=function(n){n.registerSourceHandler=function(t,i){var r=n.sourceHandlers;r||(r=n.sourceHandlers=[]);i===undefined&&(i=r.length);r.splice(i,0,t)};n.canPlayType=function(t){for(var u=n.sourceHandlers||[],i,r=0;r<u.length;r++)if(i=u[r].canPlayType(t),i)return i;return""};n.selectSourceHandler=function(t,i){for(var u=n.sourceHandlers||[],f,r=0;r<u.length;r++)if(f=u[r].canHandleSource(t,i),f)return u[r];return null};n.canPlaySource=function(t,i){var r=n.selectSourceHandler(t,i);return r?r.canHandleSource(t,i):""};["seekable","seeking","duration"].forEach(function(n){var t=this[n];typeof t=="function"&&(this[n]=function(){return this.sourceHandler_&&this.sourceHandler_[n]?this.sourceHandler_[n].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},n.prototype);n.prototype.setSource=function(t){var i=n.selectSourceHandler(t,this.options_);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:c.error("No source handler found for the current source."));this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);i!==n.nativeSourceHandler&&(this.currentSource_=t);this.sourceHandler_=i.handleSource(t,this,this.options_);this.on("dispose",this.disposeSourceHandler)};n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null);this.cleanupAutoTextTracks();this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};r.registerComponent("Tech",v);v.registerTech("Tech",v);v.defaultTechOrder_=[];var lr={},bl={},po={};var wst={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},bst={setCurrentTime:1},pk={play:1,pause:1};var nht={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},wk=function(n){n===void 0&&(n="");var t=ll(n),i=nht[t.toLowerCase()];return i||""},tht=function(n,t){var u,f,r,i;if(!t)return"";if(n.cache_.source.src===t&&n.cache_.source.type)return n.cache_.source.type;if(u=n.cache_.sources.filter(function(n){return n.src===t}),u.length)return u[0].type;for(f=n.$$("source"),r=0;r<f.length;r++)if(i=f[r],i.type&&i.src&&i.src===t)return i.type;return wk(t)},bk=function bk(n){if(Array.isArray(n)){var t=[];n.forEach(function(n){n=bk(n);Array.isArray(n)?t=t.concat(n):bi(n)&&t.push(n)});n=t}else n=typeof n=="string"&&n.trim()?[kk({src:n})]:bi(n)&&typeof n.src=="string"&&n.src&&n.src.trim()?[kk(n)]:[];return n};dk=function(n){function t(t,i,u){var h,c=p({createEl:!1},i),e,s,f,o;if(h=n.call(this,t,c,u)||this,i.playerOptions.sources&&i.playerOptions.sources.length!==0)t.src(i.playerOptions.sources);else for(e=0,s=i.playerOptions.techOrder;e<s.length;e++)if(f=b(s[e]),o=v.getTech(f),f||(o=r.getComponent(f)),o&&o.isSupported()){t.loadTech_(f);break}return h}return e(t,n),t}(r);r.registerComponent("MediaLoader",dk);fe=function(n){function r(t,i){var r;return r=n.call(this,t,i)||this,r.emitTapEvents(),r.enable(),r}e(r,n);var i=r.prototype;return i.createEl=function(t,i,r){t===void 0&&(t="div");i===void 0&&(i={});r===void 0&&(r={});i=y({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>',className:this.buildCSSClass(),tabIndex:0},i);t==="button"&&c.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead.");r=y({role:"button"},r);this.tabIndex_=i.tabIndex;var u=n.prototype.createEl.call(this,t,i,r);return this.createControlTextEl(u),u},i.dispose=function(){this.controlTextEl_=null;n.prototype.dispose.call(this)},i.createControlTextEl=function(n){return this.controlTextEl_=d("span",{className:"vjs-control-text"},{"aria-live":"polite"}),n&&n.appendChild(this.controlTextEl_),this.controlText(this.controlText_,n),this.controlTextEl_},i.controlText=function(n,t){if(t===void 0&&(t=this.el()),n===undefined)return this.controlText_||"Need Text";var i=this.localize(n);this.controlText_=n;hf(this.controlTextEl_,i);this.nonIconControl||t.setAttribute("title",i)},i.buildCSSClass=function(){return"vjs-control vjs-button "+n.prototype.buildCSSClass.call(this)},i.enable=function(){if(!this.enabled_){this.enabled_=!0;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_);this.on(["tap","click"],this.handleClick);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur)}},i.disable=function(){this.enabled_=!1;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex");this.off(["tap","click"],this.handleClick);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur)},i.handleClick=function(){},i.handleFocus=function(){fi(t,"keydown",o(this,this.handleKeyPress))},i.handleKeyPress=function(t){t.which===32||t.which===13?(t.preventDefault(),this.trigger("click")):n.prototype.handleKeyPress&&n.prototype.handleKeyPress.call(this,t)},i.handleBlur=function(){vt(t,"keydown",o(this,this.handleKeyPress))},r}(r);r.registerComponent("ClickableComponent",fe);gk=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.update();t.on("posterchange",o(f(f(r)),r.update));return r}e(i,n);var t=i.prototype;return t.dispose=function(){this.player().off("posterchange",this.update);n.prototype.dispose.call(this)},t.createEl=function(){return d("div",{className:"vjs-poster",tabIndex:-1})},t.update=function(){var n=this.player().poster();this.setSrc(n);n?this.show():this.hide()},t.setSrc=function(n){var t="";n&&(t='url("'+n+'")');this.el_.style.backgroundImage=t},t.handleClick=function(){this.player_.controls()&&(this.player_.paused()?df(this.player_.play()):this.player_.pause())},i}(fe);r.registerComponent("PosterImage",gk);var kt="#222",nd="#ccc",iht={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};td=function(t){function r(i,r,u){var e,s;e=t.call(this,i,r,u)||this;s=o(f(f(e)),e.updateDisplay);i.on("loadstart",o(f(f(e)),e.toggleDisplay));i.on("texttrackchange",s);i.on("loadstart",o(f(f(e)),e.preselectTrack));return i.ready(o(f(f(e)),function(){var r,t;if(i.tech_&&i.tech_.featuresNativeTextTracks){this.hide();return}i.on("fullscreenchange",s);i.on("playerresize",s);n.addEventListener("orientationchange",s);i.on("dispose",function(){return n.removeEventListener("orientationchange",s)});for(r=this.options_.playerOptions.tracks||[],t=0;t<r.length;t++)this.player_.addRemoteTextTrack(r[t],!0);this.preselectTrack()})),e}e(r,t);var i=r.prototype;return i.preselectTrack=function(){for(var n,o={captions:1,subtitles:1},e=this.player_.textTracks(),t=this.player_.cache_.selectedLanguage,r,u,i,f=0;f<e.length;f++)n=e[f],t&&t.enabled&&t.language===n.language?n.kind===t.kind?i=n:i||(i=n):t&&!t.enabled?(i=null,r=null,u=null):n.default&&(n.kind!=="descriptions"||r?n.kind in o&&!u&&(u=n):r=n);i?i.mode="showing":u?u.mode="showing":r&&(r.mode="showing")},i.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function(){typeof n.WebVTT=="function"&&n.WebVTT.processCues(n,[],this.el_)},i.updateDisplay=function(){var r=this.player_.textTracks(),n;this.clearDisplay();for(var t=null,i=null,u=r.length;u--;)n=r[u],n.mode==="showing"&&(n.kind==="descriptions"?t=n:i=n);i?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(i)):t&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(t))},i.updateForTrack=function(t){var u,f,i,e,o,r,s;if(typeof n.WebVTT=="function"&&t.activeCues){for(u=[],f=0;f<t.activeCues.length;f++)u.push(t.activeCues[f]);if(n.WebVTT.processCues(n,u,this.el_),this.player_.textTrackSettings)for(i=this.player_.textTrackSettings.getValues(),e=u.length;e--;)(o=u[e],o)&&(r=o.displayState,i.color&&(r.firstChild.style.color=i.color),i.textOpacity&&gl(r.firstChild,"color",dl(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(r.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&gl(r.firstChild,"backgroundColor",dl(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?gl(r,"backgroundColor",dl(i.windowColor,i.windowOpacity)):r.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?r.firstChild.style.textShadow="2px 2px 3px "+kt+", 2px 2px 4px "+kt+", 2px 2px 5px "+kt:i.edgeStyle==="raised"?r.firstChild.style.textShadow="1px 1px "+kt+", 2px 2px "+kt+", 3px 3px "+kt:i.edgeStyle==="depressed"?r.firstChild.style.textShadow="1px 1px "+nd+", 0 1px "+nd+", -1px -1px "+kt+", 0 -1px "+kt:i.edgeStyle==="uniform"&&(r.firstChild.style.textShadow="0 0 4px "+kt+", 0 0 4px "+kt+", 0 0 4px "+kt+", 0 0 4px "+kt)),i.fontPercent&&i.fontPercent!==1&&(s=n.parseFloat(r.style.fontSize),r.style.fontSize=s*i.fontPercent+"px",r.style.height="auto",r.style.top="auto",r.style.bottom="2px"),i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?r.firstChild.style.fontVariant="small-caps":r.firstChild.style.fontFamily=iht[i.fontFamily]))}},r}(r);r.registerComponent("TextTrackDisplay",td);id=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){var i=this.player_.isAudio(),r=this.localize(i?"Audio Player":"Video Player"),u=d("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[r])}),t=n.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return t.appendChild(u),t},t}(r);r.registerComponent("LoadingSpinner",id);oi=function(n){function i(){return n.apply(this,arguments)||this}e(i,n);var t=i.prototype;return t.createEl=function(n,t,i){t===void 0&&(t={});i===void 0&&(i={});n="button";t=y({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>',className:this.buildCSSClass()},t);i=y({type:"button"},i);var u=r.prototype.createEl.call(this,n,t,i);return this.createControlTextEl(u),u},t.addChild=function(n,t){t===void 0&&(t={});var i=this.constructor.name;return c.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead."),r.prototype.addChild.call(this,n,t)},t.enable=function(){n.prototype.enable.call(this);this.el_.removeAttribute("disabled")},t.disable=function(){n.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")},t.handleKeyPress=function(t){t.which!==32&&t.which!==13&&n.prototype.handleKeyPress.call(this,t)},i}(fe);r.registerComponent("Button",oi);na=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.mouseused_=!1;r.on("mousedown",r.handleMouseDown);return r}e(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(n){var t=this.player_.play(),i,r,u;if(this.mouseused_&&n.clientX&&n.clientY){df(t);return}if(i=this.player_.getChild("controlBar"),r=i&&i.getChild("playToggle"),!r){this.player_.focus();return}u=function(){return r.focus()};lb(t)?t.then(u,function(){}):this.setTimeout(u,1)},t.handleKeyPress=function(t){this.mouseused_=!1;n.prototype.handleKeyPress.call(this,t)},t.handleMouseDown=function(){this.mouseused_=!0},i}(oi);na.prototype.controlText_="Play Video";r.registerComponent("BigPlayButton",na);rd=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.controlText(i&&i.controlText||r.localize("Close")),r}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+n.prototype.buildCSSClass.call(this)},i.handleClick=function(){this.trigger({type:"close",bubbles:!1})},t}(oi);r.registerComponent("CloseButton",rd);ta=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on(t,"play",r.handlePlay);r.on(t,"pause",r.handlePause);r.on(t,"ended",r.handleEnded);return r}e(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleSeeked=function(n){this.removeClass("vjs-ended");this.player_.paused()?this.handlePause(n):this.handlePlay(n)},t.handlePlay=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")},t.handlePause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")},t.handleEnded=function(){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)},i}(oi);ta.prototype.controlText_="Play";r.registerComponent("PlayToggle",ta);ia=function(n,t){n=n<0?0:n;var i=Math.floor(n%60),r=Math.floor(n/60%60),u=Math.floor(n/3600),f=Math.floor(t/60%60),e=Math.floor(t/3600);return(isNaN(n)||n===Infinity)&&(u=r=i="-"),u=u>0||e>0?u+":":"",r=((u||f>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,u+r+i};wo=ia;vr=function(n){function r(t,i){var r;r=n.call(this,t,i)||this;r.throttledUpdateContent=fu(o(f(f(r)),r.updateContent),25);r.on(t,"timeupdate",r.throttledUpdateContent);return r}e(r,n);var i=r.prototype;return i.createEl=function(){var t=this.buildCSSClass(),i=n.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text">'+this.localize(this.labelText_)+"Â <\/span>"});return this.contentEl_=d("span",{className:t+"-display"},{"aria-live":"off"}),this.updateTextNode_(),i.appendChild(this.contentEl_),i},i.dispose=function(){this.contentEl_=null;this.textNode_=null;n.prototype.dispose.call(this)},i.updateTextNode_=function(){if(this.contentEl_){while(this.contentEl_.firstChild)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0));this.contentEl_.appendChild(this.textNode_)}},i.formatTime_=function(n){return cu(n)},i.updateFormattedTime_=function(n){var t=this.formatTime_(n);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},i.updateContent=function(){},r}(r);vr.prototype.labelText_="Time";vr.prototype.controlText_="Time";r.registerComponent("TimeDisplay",vr);bo=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"ended",r.handleEnded);return r}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(n)},i.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},t}(vr);bo.prototype.labelText_="Current Time";bo.prototype.controlText_="Current Time";r.registerComponent("CurrentTimeDisplay",bo);ko=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"durationchange",r.updateContent);r.on(t,"loadedmetadata",r.throttledUpdateContent);return r}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(){var n=this.player_.duration();n&&this.duration_!==n&&(this.duration_=n,this.updateFormattedTime_(n))},t}(vr);ko.prototype.labelText_="Duration";ko.prototype.controlText_="Duration";r.registerComponent("DurationDisplay",ko);ud=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/<\/span><\/div>"})},t}(r);r.registerComponent("TimeDivider",ud);go=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on(t,"durationchange",r.throttledUpdateContent);r.on(t,"ended",r.handleEnded);return r}e(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-remaining-time"},t.formatTime_=function(t){return"-"+n.prototype.formatTime_.call(this,t)},t.updateContent=function(){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},t.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(0)},i}(vr);go.prototype.labelText_="Remaining Time";go.prototype.controlText_="Remaining Time";r.registerComponent("RemainingTimeDisplay",go);fd=function(n){function t(t,i){var r;r=n.call(this,t,i)||this;r.updateShowing();r.on(r.player(),"durationchange",r.updateShowing);return r}e(t,n);var i=t.prototype;return i.createEl=function(){var t=n.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=d("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"Â <\/span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},i.dispose=function(){this.contentEl_=null;n.prototype.dispose.call(this)},i.updateShowing=function(){this.player().duration()===Infinity?this.show():this.hide()},t}(r);r.registerComponent("LiveDisplay",fd);ns=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}e(i,n);var t=i.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){if(!this.enabled()){this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("focus",this.handleFocus);this.on("blur",this.handleBlur);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent)this.on(this.player_,this.playerEvent,this.update);this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=!0}},t.disable=function(){if(this.enabled()){var n=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("focus",this.handleFocus);this.off("blur",this.handleBlur);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(n,"mousemove",this.handleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchmove",this.handleMouseMove);this.off(n,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");this.playerEvent&&this.off(this.player_,this.playerEvent,this.update);this.enabled_=!1}},t.createEl=function(t,i,r){return i===void 0&&(i={}),r===void 0&&(r={}),i.className=i.className+" vjs-slider",i=y({tabIndex:0},i),r=y({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),n.prototype.createEl.call(this,t,i,r)},t.handleMouseDown=function(n){var t=this.bar.el_.ownerDocument;n.type==="mousedown"&&n.preventDefault();n.type!=="touchstart"||gi||n.preventDefault();tw();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(t,"mousemove",this.handleMouseMove);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchmove",this.handleMouseMove);this.on(t,"touchend",this.handleMouseUp);this.handleMouseMove(n)},t.handleMouseMove=function(){},t.handleMouseUp=function(){var n=this.bar.el_.ownerDocument;iw();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(n,"mousemove",this.handleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchmove",this.handleMouseMove);this.off(n,"touchend",this.handleMouseUp);this.update()},t.update=function(){var n,t,i,r;if(this.el_)return(n=this.getPercent(),t=this.bar,!t)?void 0:((typeof n!="number"||n!==n||n<0||n===Infinity)&&(n=0),i=(n*100).toFixed(2)+"%",r=t.el().style,this.vertical()?r.height=i:r.width=i,n)},t.calculateDistance=function(n){var t=lc(this.el_,n);return this.vertical()?t.y:t.x},t.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.handleKeyPress=function(n){n.which===37||n.which===40?(n.preventDefault(),this.stepBack()):(n.which===38||n.which===39)&&(n.preventDefault(),this.stepForward())},t.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},t.handleClick=function(n){n.stopImmediatePropagation();n.preventDefault()},t.vertical=function(n){if(n===undefined)return this.vertical_||!1;this.vertical_=!!n;this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},i}(r);r.registerComponent("Slider",ns);ed=function(n){function t(t,i){var r;r=n.call(this,t,i)||this;r.partEls_=[];r.on(t,"progress",r.update);return r}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"<\/span>: 0%<\/span>"})},i.dispose=function(){this.partEls_=null;n.prototype.dispose.call(this)},i.update=function(){var t=this.player_.buffered(),s=this.player_.duration(),f=this.player_.bufferedEnd(),i=this.partEls_,e=function(n,t){var i=n/t||0;return(i>=1?1:i)*100+"%"},n,u;for(this.el_.style.width=e(f,s),n=0;n<t.length;n++){var o=t.start(n),h=t.end(n),r=i[n];r||(r=this.el_.appendChild(d()),i[n]=r);r.style.left=e(o,f);r.style.width=e(h-o,f)}for(u=i.length;u>t.length;u--)this.el_.removeChild(i[u-1]);i.length=t.length},t}(r);r.registerComponent("LoadProgressBar",ed);od=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})},i.update=function(n,t,i){var u=af(this.el_),f=af(this.player_.el()),e=n.width*t;if(f&&u){var o=n.left-f.left+e,s=n.width-e+(f.right-n.right),r=u.width/2;o<r?r+=r-o:s<r&&(r=s);r<0?r=0:r>u.width&&(r=u.width);this.el_.style.right="-"+r+"px";hf(this.el_,i)}},t}(r);r.registerComponent("TimeTooltip",od);ts=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"<\/span>: 0%<\/span>"})},i.update=function(n,t){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_);this.rafId_=this.requestAnimationFrame(function(){var u=i.player_.scrubbing()?i.player_.getCache().currentTime:i.player_.currentTime(),f=cu(u,i.player_.duration()),r=i.getChild("timeTooltip");r&&r.update(n,t,f)})},t}(r);ts.prototype.options_={children:[]};vi||or||ts.prototype.options_.children.push("timeTooltip");r.registerComponent("PlayProgressBar",ts);ra=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.update=fu(o(f(f(r)),r.update),25),r}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(n,t){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_);this.rafId_=this.requestAnimationFrame(function(){var r=i.player_.duration(),u=cu(t*r,r);i.el_.style.left=n.width*t+"px";i.getChild("timeTooltip").update(n,t,u)})},t}(r);ra.prototype.options_={children:["timeTooltip"]};r.registerComponent("MouseTimeDisplay",ra);var sd=5,hd=30,is=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.setEventHandlers_(),r}e(i,n);var t=i.prototype;return t.setEventHandlers_=function(){var n=this;this.update=fu(o(this,this.update),hd);this.on(this.player_,"timeupdate",this.update);this.on(this.player_,"ended",this.handleEnded);this.updateInterval=null;this.on(this.player_,["playing"],function(){n.clearInterval(n.updateInterval);n.updateInterval=n.setInterval(function(){n.requestAnimationFrame(function(){n.update()})},hd)});this.on(this.player_,["ended","pause","waiting"],function(){n.clearInterval(n.updateInterval)});this.on(this.player_,["timeupdate","ended"],this.update)},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update_=function(n,t){var i=this.player_.duration();this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2));this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[cu(n,i),cu(i,i)],"{1} of {2}"));this.bar.update(af(this.el_),t)},t.update=function(){var t=n.prototype.update.call(this);return this.update_(this.getCurrentTime_(),t),t},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.handleEnded=function(){this.update_(this.player_.duration(),1)},t.getPercent=function(){var n=this.getCurrentTime_()/this.player_.duration();return n>=1?1:n||0},t.handleMouseDown=function(t){iu(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),n.prototype.handleMouseDown.call(this,t))},t.handleMouseMove=function(n){if(iu(n)){var t=this.calculateDistance(n)*this.player_.duration();t===this.player_.duration()&&(t=t-.1);this.player_.currentTime(t)}},t.enable=function(){n.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},t.disable=function(){n.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},t.handleMouseUp=function(t){n.prototype.handleMouseUp.call(this,t);t&&t.stopPropagation();this.player_.scrubbing(!1);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0});this.videoWasPlaying&&df(this.player_.play())},t.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+sd)},t.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-sd)},t.handleAction=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyPress=function(t){t.which===32||t.which===13?(t.preventDefault(),this.handleAction(t)):n.prototype.handleKeyPress&&n.prototype.handleKeyPress.call(this,t)},i}(ns);is.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};vi||or||is.prototype.options_.children.splice(1,0,"mouseTimeDisplay");is.prototype.playerEvent="timeupdate";r.registerComponent("SeekBar",is);ua=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.handleMouseMove=fu(o(f(f(r)),r.handleMouseMove),25),r.throttledHandleMouseSeek=fu(o(f(f(r)),r.handleMouseSeek),25),r.enable(),r}e(i,n);var t=i.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(n){var i=this.getChild("seekBar");if(i){var r=i.getChild("mouseTimeDisplay"),u=i.el(),f=af(u),t=lc(u,n).x;t>1?t=1:t<0&&(t=0);r&&r.update(f,t)}},t.handleMouseSeek=function(n){var t=this.getChild("seekBar");t&&t.handleMouseMove(n)},t.enabled=function(){return this.enabled_},t.disable=function(){(this.children().forEach(function(n){return n.disable&&n.disable()}),this.enabled())&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},t.enable=function(){if(this.children().forEach(function(n){return n.enable&&n.enable()}),!this.enabled()){this.on(["mousedown","touchstart"],this.handleMouseDown);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=!0}},t.handleMouseDown=function(n){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(n);this.on(t,"mousemove",this.throttledHandleMouseSeek);this.on(t,"touchmove",this.throttledHandleMouseSeek);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(n){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(n);this.off(t,"mousemove",this.throttledHandleMouseSeek);this.off(t,"touchmove",this.throttledHandleMouseSeek);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchend",this.handleMouseUp)},i}(r);ua.prototype.options_={children:["seekBar"]};r.registerComponent("ProgressControl",ua);fa=function(n){function i(i,r){var u=n.call(this,i,r)||this;u.on(i,"fullscreenchange",u.handleFullscreenChange);return t[so.fullscreenEnabled]===!1&&u.disable(),u}e(i,n);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+n.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},i}(oi);fa.prototype.controlText_="Fullscreen";r.registerComponent("FullscreenToggle",fa);cd=function(n,t){t.tech_&&!t.tech_.featuresVolumeControl&&n.addClass("vjs-hidden");n.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};ld=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"><\/span>'})},t}(r);r.registerComponent("VolumeLevel",ld);rs=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on("slideractive",r.updateLastVolume_);r.on(t,"volumechange",r.updateARIAAttributes);return t.ready(function(){return r.updateARIAAttributes()}),r}e(i,n);var t=i.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(t){iu(t)&&n.prototype.handleMouseDown.call(this,t)},t.handleMouseMove=function(n){iu(n)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(n)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(){var n=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",n);this.el_.setAttribute("aria-valuetext",n+"%")},t.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},t.updateLastVolume_=function(){var n=this,t=this.player_.volume();this.one("sliderinactive",function(){n.player_.volume()===0&&n.player_.lastVolume_(t)})},i}(ns);rs.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};rs.prototype.playerEvent="volumechange";r.registerComponent("VolumeBar",rs);ea=function(n){function i(t,i){var r;i===void 0&&(i={});i.vertical=i.vertical||!1;(typeof i.volumeBar=="undefined"||of(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical);r=n.call(this,t,i)||this;cd(f(f(r)),t);r.throttledHandleMouseMove=fu(o(f(f(r)),r.handleMouseMove),25);r.on("mousedown",r.handleMouseDown);r.on("touchstart",r.handleMouseDown);r.on(r.volumeBar,["focus","slideractive"],function(){r.volumeBar.addClass("vjs-slider-active");r.addClass("vjs-slider-active");r.trigger("slideractive")});r.on(r.volumeBar,["blur","sliderinactive"],function(){r.volumeBar.removeClass("vjs-slider-active");r.removeClass("vjs-slider-active");r.trigger("sliderinactive")});return r}e(i,n);var t=i.prototype;return t.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},t.handleMouseDown=function(){var n=this.el_.ownerDocument;this.on(n,"mousemove",this.throttledHandleMouseMove);this.on(n,"touchmove",this.throttledHandleMouseMove);this.on(n,"mouseup",this.handleMouseUp);this.on(n,"touchend",this.handleMouseUp)},t.handleMouseUp=function(){var n=this.el_.ownerDocument;this.off(n,"mousemove",this.throttledHandleMouseMove);this.off(n,"touchmove",this.throttledHandleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchend",this.handleMouseUp)},t.handleMouseMove=function(n){this.volumeBar.handleMouseMove(n)},i}(r);ea.prototype.options_={children:["volumeBar"]};r.registerComponent("VolumeControl",ea);ad=function(n,t){t.tech_&&!t.tech_.featuresMuteControl&&n.addClass("vjs-hidden");n.on(t,"loadstart",function(){t.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};oa=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;ad(f(f(r)),t);r.on(t,["loadstart","volumechange"],r.update);return r}e(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){var i=this.player_.volume(),n=this.player_.lastVolume_(),t;i===0?(t=n<.1?.1:n,this.player_.volume(t),this.player_.muted(!1)):this.player_.muted(this.player_.muted()?!1:!0)},t.update=function(){this.updateIcon_();this.updateControlText_()},t.updateIcon_=function(){var i=this.player_.volume(),n=3,t;for(vi&&this.player_.muted(this.player_.tech_.el_.muted),i===0||this.player_.muted()?n=0:i<.33?n=1:i<.67&&(n=2),t=0;t<4;t++)cf(this.el_,"vjs-vol-"+t);fr(this.el_,"vjs-vol-"+n)},t.updateControlText_=function(){var t=this.player_.muted()||this.player_.volume()===0,n=t?"Unmute":"Mute";this.controlText()!==n&&this.controlText(n)},i}(oi);oa.prototype.controlText_="Mute";r.registerComponent("MuteToggle",oa);sa=function(n){function i(t,i){var r;i===void 0&&(i={});i.inline=typeof i.inline!="undefined"?i.inline:!0;(typeof i.volumeControl=="undefined"||of(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline);r=n.call(this,t,i)||this;r.on(t,["loadstart"],r.volumePanelState_);r.on(r.volumeControl,["slideractive"],r.sliderActive_);r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_);return r}e(i,n);var t=i.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden");this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},i}(r);sa.prototype.options_={children:["muteToggle","volumeControl"]};r.registerComponent("VolumePanel",sa);us=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;i&&(r.menuButton_=i.menuButton);r.focusedChild_=-1;r.on("keydown",r.handleKeyPress);return r}e(i,n);var t=i.prototype;return t.addItem=function(n){this.addChild(n);n.on("click",o(this,function(){this.menuButton_&&(this.menuButton_.unpressButton(),n.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus())}))},t.createEl=function(){var i=this.options_.contentElType||"ul",t;return this.contentEl_=d(i,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu"),t=n.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"}),t.appendChild(this.contentEl_),fi(t,"click",function(n){n.preventDefault();n.stopImmediatePropagation()}),t},t.dispose=function(){this.contentEl_=null;n.prototype.dispose.call(this)},t.handleKeyPress=function(n){n.which===37||n.which===40?(n.preventDefault(),this.stepForward()):(n.which===38||n.which===39)&&(n.preventDefault(),this.stepBack())},t.stepForward=function(){var n=0;this.focusedChild_!==undefined&&(n=this.focusedChild_+1);this.focus(n)},t.stepBack=function(){var n=0;this.focusedChild_!==undefined&&(n=this.focusedChild_-1);this.focus(n)},t.focus=function(n){n===void 0&&(n=0);var t=this.children().slice(),i=t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className);i&&t.shift();t.length>0&&(n<0?n=0:n>=t.length&&(n=t.length-1),this.focusedChild_=n,t[n].el_.focus())},i}(r);r.registerComponent("Menu",us);fs=function(n){function r(t,i){var r,u;i===void 0&&(i={});r=n.call(this,t,i)||this;r.menuButton_=new oi(t,i);r.menuButton_.controlText(r.controlText_);r.menuButton_.el_.setAttribute("aria-haspopup","true");u=oi.prototype.buildCSSClass();r.menuButton_.el_.className=r.buildCSSClass()+" "+u;r.menuButton_.removeClass("vjs-control");r.addChild(r.menuButton_);r.update();r.enabled_=!0;r.on(r.menuButton_,"tap",r.handleClick);r.on(r.menuButton_,"click",r.handleClick);r.on(r.menuButton_,"focus",r.handleFocus);r.on(r.menuButton_,"blur",r.handleBlur);r.on("keydown",r.handleSubmenuKeyPress);return r}e(r,n);var i=r.prototype;return i.update=function(){var n=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu));this.menu=n;this.addChild(n);this.buttonPressed_=!1;this.menuButton_.el_.setAttribute("aria-expanded","false");this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function(){var n=new us(this.player_,{menuButton:this}),i,t;if(this.hideThreshold_=0,this.options_.title&&(i=d("li",{className:"vjs-menu-title",innerHTML:b(this.options_.title),tabIndex:-1}),this.hideThreshold_+=1,n.children_.unshift(i),ro(i,n.contentEl())),this.items=this.createItems(),this.items)for(t=0;t<this.items.length;t++)n.addItem(this.items[t]);return n},i.createItems=function(){},i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function(){var t="vjs-menu-button",i;return t+=this.options_.inline===!0?"-inline":"-popup",i=oi.prototype.buildCSSClass(),"vjs-menu-button "+t+" "+i+" "+n.prototype.buildCSSClass.call(this)},i.buildCSSClass=function(){var t="vjs-menu-button";return t+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+t+" "+n.prototype.buildCSSClass.call(this)},i.controlText=function(n,t){return t===void 0&&(t=this.menuButton_.el()),this.menuButton_.controlText(n,t)},i.handleClick=function(){this.one(this.menu.contentEl(),"mouseleave",o(this,function(){this.unpressButton();this.el_.blur()}));this.buttonPressed_?this.unpressButton():this.pressButton()},i.focus=function(){this.menuButton_.focus()},i.blur=function(){this.menuButton_.blur()},i.handleFocus=function(){fi(t,"keydown",o(this,this.handleKeyPress))},i.handleBlur=function(){vt(t,"keydown",o(this,this.handleKeyPress))},i.handleKeyPress=function(n){n.which===27||n.which===9?(this.buttonPressed_&&this.unpressButton(),n.which!==9&&(n.preventDefault(),this.menuButton_.el_.focus())):(n.which===38||n.which===40)&&(this.buttonPressed_||(this.pressButton(),n.preventDefault()))},i.handleSubmenuKeyPress=function(n){(n.which===27||n.which===9)&&(this.buttonPressed_&&this.unpressButton(),n.which!==9&&(n.preventDefault(),this.menuButton_.el_.focus()))},i.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),vi&&bp())return;this.menu.focus()}},i.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function(){this.unpressButton();this.enabled_=!1;this.addClass("vjs-disabled");this.menuButton_.disable()},i.enable=function(){this.enabled_=!0;this.removeClass("vjs-disabled");this.menuButton_.enable()},r}(r);r.registerComponent("MenuButton",fs);es=function(n){function t(t,i){var r,e=i.tracks,u;if(r=n.call(this,t,i)||this,r.items.length<=1&&r.hide(),!e)return f(r);u=o(f(f(r)),r.update);e.addEventListener("removetrack",u);e.addEventListener("addtrack",u);r.player_.on("ready",u);r.player_.on("dispose",function(){e.removeEventListener("removetrack",u);e.removeEventListener("addtrack",u)});return r}return e(t,n),t}(fs);r.registerComponent("TrackButton",es);lu=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.selectable=i.selectable,r.isSelected_=i.selected||!1,r.multiSelectable=i.multiSelectable,r.selected(r.isSelected_),r.selectable?r.multiSelectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitemradio"):r.el_.setAttribute("role","menuitem"),r}e(t,n);var i=t.prototype;return i.createEl=function(t,i,r){return this.nonIconControl=!0,n.prototype.createEl.call(this,"li",y({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"<\/span>",tabIndex:-1},i),r)},i.handleClick=function(){this.selected(!0)},i.selected=function(n){this.selectable&&(n?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(fe);r.registerComponent("MenuItem",lu);au=function(i){function u(r,u){var e,c=u.track,o=r.textTracks(),s,l,h;u.label=c.label||c.language||"Unknown";u.selected=c.mode==="showing";e=i.call(this,r,u)||this;e.track=c;s=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.handleTracksChange.apply(f(f(e)),i)};l=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];e.handleSelectedLanguageChange.apply(f(f(e)),i)};r.on(["loadstart","texttrackchange"],s);o.addEventListener("change",s);o.addEventListener("selectedlanguagechange",l);e.on("dispose",function(){r.off(["loadstart","texttrackchange"],s);o.removeEventListener("change",s);o.removeEventListener("selectedlanguagechange",l)});if(o.onchange===undefined)e.on(["tap","click"],function(){if(typeof n.Event!="object")try{h=new n.Event("change")}catch(i){}h||(h=t.createEvent("Event"),h.initEvent("change",!0,!0));o.dispatchEvent(h)});return e.handleTracksChange(),e}e(u,i);var r=u.prototype;return r.handleClick=function(n){var e=this.track.kind,u=this.track.kinds,f=this.player_.textTracks(),r,t;if(u||(u=[e]),i.prototype.handleClick.call(this,n),f)for(r=0;r<f.length;r++)t=f[r],t===this.track&&u.indexOf(t.kind)>-1?t.mode!=="showing"&&(t.mode="showing"):t.mode!=="disabled"&&(t.mode="disabled")},r.handleTracksChange=function(){var n=this.track.mode==="showing";n!==this.isSelected_&&this.selected(n)},r.handleSelectedLanguageChange=function(){if(this.track.mode==="showing"){var n=this.player_.cache_.selectedLanguage;if(n&&n.enabled&&n.language===this.track.language&&n.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},r.dispose=function(){this.track=null;i.prototype.dispose.call(this)},u}(lu);r.registerComponent("TextTrackMenuItem",au);ha=function(n){function t(t,i){return i.track={player:t,kind:i.kind,kinds:i.kinds,"default":!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.track.label=i.label?i.label:i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,n.call(this,t,i)||this}e(t,n);var i=t.prototype;return i.handleTracksChange=function(){for(var i,r=this.player().textTracks(),n=!0,t=0,u=r.length;t<u;t++)if(i=r[t],this.options_.kinds.indexOf(i.kind)>-1&&i.mode==="showing"){n=!1;break}n!==this.isSelected_&&this.selected(n)},i.handleSelectedLanguageChange=function(){for(var t,i=this.player().textTracks(),r=!0,n=0,u=i.length;n<u;n++)if(t=i[n],["captions","descriptions","subtitles"].indexOf(t.kind)>-1&&t.mode==="showing"){r=!1;break}r&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(au);r.registerComponent("OffTextTrackMenuItem",ha);yr=function(n){function t(t,i){return i===void 0&&(i={}),i.tracks=t.textTracks(),n.call(this,t,i)||this}e(t,n);var i=t.prototype;return i.createItems=function(n,t){var e,u,i,r,f;for(n===void 0&&(n=[]),t===void 0&&(t=au),this.label_&&(e=this.label_+" off"),n.push(new ha(this.player_,{kinds:this.kinds_,kind:this.kind_,label:e})),this.hideThreshold_+=1,u=this.player_.textTracks(),Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]),i=0;i<u.length;i++)r=u[i],this.kinds_.indexOf(r.kind)>-1&&(f=new t(this.player_,{track:r,selectable:!0,multiSelectable:!1}),f.addClass("vjs-"+r.kind+"-menu-item"),n.push(f));return n},t}(es);r.registerComponent("TextTrackButton",yr);ca=function(n){function t(t,i){var r,e=i.track,u=i.cue,s=t.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=u.text,i.selected=u.startTime<=s&&s<u.endTime,r=n.call(this,t,i)||this,r.track=e,r.cue=u,e.addEventListener("cuechange",o(f(f(r)),r.update)),r}e(t,n);var i=t.prototype;return i.handleClick=function(){n.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)},i.update=function(){var n=this.cue,t=this.player_.currentTime();this.selected(n.startTime<=t&&t<n.endTime)},t}(lu);r.registerComponent("ChaptersTrackMenuItem",ca);os=function(n){function i(t,i,r){return n.call(this,t,i,r)||this}e(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildWrapperCSSClass.call(this)},t.update=function(t){(!this.track_||t&&(t.type==="addtrack"||t.type==="removetrack"))&&this.setTrack(this.findChaptersTrack());n.prototype.update.call(this)},t.setTrack=function(n){var t,i;this.track_!==n&&(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_&&(t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_),t&&t.removeEventListener("load",this.updateHandler_),this.track_=null),this.track_=n,this.track_&&(this.track_.mode="hidden",i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_),i&&i.addEventListener("load",this.updateHandler_)))},t.findChaptersTrack=function(){for(var t,i=this.player_.textTracks()||[],n=i.length-1;n>=0;n--)if(t=i[n],t.kind===this.kind_)return t},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(b(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),n.prototype.createMenu.call(this)},t.createItems=function(){var i=[],n,t,r,u,f;if(!this.track_||(n=this.track_.cues,!n))return i;for(t=0,r=n.length;t<r;t++)u=n[t],f=new ca(this.player_,{track:this.track_,cue:u}),i.push(f);return i},i}(yr);os.prototype.kind_="chapters";os.prototype.controlText_="Chapters";r.registerComponent("ChaptersButton",os);ss=function(n){function t(t,i,r){var u,e,s;u=n.call(this,t,i,r)||this;e=t.textTracks();s=o(f(f(u)),u.handleTracksChange);e.addEventListener("change",s);u.on("dispose",function(){e.removeEventListener("change",s)});return u}e(t,n);var i=t.prototype;return i.handleTracksChange=function(){for(var t,i=this.player().textTracks(),r=!1,n=0,u=i.length;n<u;n++)if(t=i[n],t.kind!==this.kind_&&t.mode==="showing"){r=!0;break}r?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(yr);ss.prototype.kind_="descriptions";ss.prototype.controlText_="Descriptions";r.registerComponent("DescriptionsButton",ss);hs=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(yr);hs.prototype.kind_="subtitles";hs.prototype.controlText_="Subtitles";r.registerComponent("SubtitlesButton",hs);cs=function(n){function t(t,i){var r;return i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:!1,"default":!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",r=n.call(this,t,i)||this,r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+i.kind+" settings dialog"),r}e(t,n);var i=t.prototype;return i.handleClick=function(){this.player().getChild("textTrackSettings").open()},t}(au);r.registerComponent("CaptionSettingsMenuItem",cs);ls=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new cs(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,t)},t}(yr);ls.prototype.kind_="captions";ls.prototype.controlText_="Captions";r.registerComponent("CaptionsButton",ls);la=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(t,i,r){var u='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="captions"&&(u+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"<\/span>\n      "),u+="<\/span>",n.prototype.createEl.call(this,t,y({innerHTML:u},i),r)},t}(au);r.registerComponent("SubsCapsMenuItem",la);as=function(n){function t(t,i){var r;return i===void 0&&(i={}),r=n.call(this,t,i)||this,r.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(b(r.label_)),r}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new cs(this.player_,{kind:this.label_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,t,la)},t}(yr);as.prototype.kinds_=["captions","subtitles"];as.prototype.controlText_="Subtitles";r.registerComponent("SubsCapsButton",as);aa=function(n){function t(t,i){var r,u=i.track,o=t.audioTracks(),e;i.label=u.label||u.language||"Unknown";i.selected=u.enabled;r=n.call(this,t,i)||this;r.track=u;r.addClass("vjs-"+u.kind+"-menu-item");e=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.handleTracksChange.apply(f(f(r)),i)};o.addEventListener("change",e);r.on("dispose",function(){o.removeEventListener("change",e)});return r}e(t,n);var i=t.prototype;return i.createEl=function(t,i,r){var u='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="main-desc"&&(u+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"<\/span>\n      "),u+="<\/span>",n.prototype.createEl.call(this,t,y({innerHTML:u},i),r)},i.handleClick=function(t){var u=this.player_.audioTracks(),i,r;for(n.prototype.handleClick.call(this,t),i=0;i<u.length;i++)r=u[i],r.enabled=r===this.track},i.handleTracksChange=function(){this.selected(this.track.enabled)},t}(lu);r.registerComponent("AudioTrackMenuItem",aa);va=function(n){function t(t,i){return i===void 0&&(i={}),i.tracks=t.audioTracks(),n.call(this,t,i)||this}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(n){var i,t,r;for(n===void 0&&(n=[]),this.hideThreshold_=1,i=this.player_.audioTracks(),t=0;t<i.length;t++)r=i[t],n.push(new aa(this.player_,{track:r,selectable:!0,multiSelectable:!1}));return n},t}(es);va.prototype.controlText_="Audio Track";r.registerComponent("AudioTrackButton",va);vs=function(n){function t(t,i){var r,u=i.rate,f=parseFloat(u,10);i.label=u;i.selected=f===1;i.selectable=!0;i.multiSelectable=!1;r=n.call(this,t,i)||this;r.label=u;r.rate=f;r.on(t,"ratechange",r.update);return r}e(t,n);var i=t.prototype;return i.handleClick=function(){n.prototype.handleClick.call(this);this.player().playbackRate(this.rate)},i.update=function(){this.selected(this.player().playbackRate()===this.rate)},t}(lu);vs.prototype.contentElType="button";r.registerComponent("PlaybackRateMenuItem",vs);ya=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.updateVisibility();r.updateLabel();r.on(t,"loadstart",r.updateVisibility);r.on(t,"ratechange",r.updateLabel);return r}e(i,n);var t=i.prototype;return t.createEl=function(){var t=n.prototype.createEl.call(this);return this.labelEl_=d("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},t.dispose=function(){this.labelEl_=null;n.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildWrapperCSSClass.call(this)},t.createMenu=function(){var i=new us(this.player()),t=this.playbackRates(),n;if(t)for(n=t.length-1;n>=0;n--)i.addChild(new vs(this.player(),{rate:t[n]+"x"}));return i},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(){for(var r=this.player().playbackRate(),n=this.playbackRates(),i=n[0],t=0;t<n.length;t++)if(n[t]>r){i=n[t];break}this.player().playbackRate(i)},t.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},t.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},i}(fs);ya.prototype.controlText_="Playback Rate";r.registerComponent("PlaybackRateMenuButton",ya);pa=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+n.prototype.buildCSSClass.call(this)},i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(r);r.registerComponent("Spacer",pa);vd=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+n.prototype.buildCSSClass.call(this)},i.createEl=function(){var t=n.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="Â ",t},t}(pa);r.registerComponent("CustomControlSpacer",vd);wa=function(n){function t(){return n.apply(this,arguments)||this}e(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(r);wa.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};r.registerComponent("ControlBar",wa);ba=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"error",r.open);return r}e(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+n.prototype.buildCSSClass.call(this)},i.content=function(){var n=this.player().error();return n?this.localize(n.message):""},t}(eu);ba.prototype.options_=p(eu.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});r.registerComponent("ErrorDisplay",ba);var ka="vjs-text-track-settings",yd=["#000","Black"],pd=["#00F","Blue"],wd=["#0FF","Cyan"],bd=["#0F0","Green"],kd=["#F0F","Magenta"],dd=["#F00","Red"],gd=["#FFF","White"],ng=["#FF0","Yellow"],da=["1","Opaque"],ga=["0.5","Semi-Transparent"],tg=["0","Transparent"],pr={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[yd,gd,dd,bd,pd,ng,kd,wd]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[da,ga,tg]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[gd,yd,dd,bd,pd,ng,kd,wd]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],"default":2,parser:function(n){return n==="1.00"?null:Number(n)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[da,ga]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[tg,ga,da]}};pr.windowColor.options=pr.backgroundColor.options;rg=function(i){function u(n,t){var r;t.temporary=!1;r=i.call(this,n,t)||this;r.updateDisplay=o(f(f(r)),r.updateDisplay);r.fill();r.hasBeenOpened_=r.hasBeenFilled_=!0;r.endDialog=d("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")});r.el().appendChild(r.endDialog);r.setDefaults();t.persistTextTrackSettings===undefined&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings);r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings();r.close()});r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults();r.updateDisplay()});return nu(pr,function(n){r.on(r.$(n.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}e(u,i);var r=u.prototype;return r.dispose=function(){this.endDialog=null;i.prototype.dispose.call(this)},r.createElSelect_=function(n,t,i){var e=this;t===void 0&&(t="");i===void 0&&(i="label");var r=pr[n],u=r.id.replace("%s",this.id_),f=[t,u].join(" ").trim();return["<"+i+' id="'+u+'" class="'+(i==="label"?"vjs-label":"")+'">',this.localize(r.label),"<\/"+i+">",'<select aria-labelledby="'+f+'">'].concat(r.options.map(function(n){var t=u+"-"+n[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+n[0]+'" ','aria-labelledby="'+f+" "+t+'">',e.localize(n[1]),"<\/option>"].join("")})).concat("<\/select>").join("")},r.createElFgColor_=function(){var n="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Text"),"<\/legend>",this.createElSelect_("color",n),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",n),"<\/span>","<\/fieldset>"].join("")},r.createElBgColor_=function(){var n="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Background"),"<\/legend>",this.createElSelect_("backgroundColor",n),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",n),"<\/span>","<\/fieldset>"].join("")},r.createElWinColor_=function(){var n="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Window"),"<\/legend>",this.createElSelect_("windowColor",n),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",n),"<\/span>","<\/fieldset>"].join("")},r.createElColors_=function(){return d("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return d("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"<\/fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"<\/fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"<\/fieldset>"].join("")})},r.createElControls_=function(){var n=this.localize("restore all settings to the default values");return d("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+n+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+n+"<\/span>","<\/button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"<\/button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return i.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var n=this;return uft(pr,function(t,i,r){var u=fht(n.$(i.selector),i.parser);return u!==undefined&&(t[r]=u),t},{})},r.setValues=function(n){var t=this;nu(pr,function(i,r){eht(t.$(i.selector),n[r],i.parser)})},r.setDefaults=function(){var n=this;nu(pr,function(t){var i=t.hasOwnProperty("default")?t.default:0;n.$(t.selector).selectedIndex=i})},r.restoreSettings=function(){var t;try{t=JSON.parse(n.localStorage.getItem(ka))}catch(i){c.warn(i)}t&&this.setValues(t)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?n.localStorage.setItem(ka,JSON.stringify(t)):n.localStorage.removeItem(ka)}catch(i){c.warn(i)}}},r.updateDisplay=function(){var n=this.player_.getChild("textTrackDisplay");n&&n.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;this.off(t,"keydown",this.handleKeyDown);var n=this.player_.controlBar,i=n&&n.subsCapsButton,r=n&&n.captionsButton;i?i.focus():r&&r.focus()},u}(eu);r.registerComponent("TextTrackSettings",rg);ug=function(t){function i(i,r){var u,e=r.ResizeObserver||n.ResizeObserver,o;if(r.ResizeObserver===null&&(e=!1),o=p({createEl:!e,reportTouchActivity:!1},r),u=t.call(this,i,o)||this,u.ResizeObserver=r.ResizeObserver||n.ResizeObserver,u.loadListener_=null,u.resizeObserver_=null,u.debouncedHandler_=hft(function(){u.resizeHandler()},100,!1,f(f(u))),e)u.resizeObserver_=new u.ResizeObserver(u.debouncedHandler_),u.resizeObserver_.observe(i.el());else{u.loadListener_=function(){u.el_&&u.el_.contentWindow&&fi(u.el_.contentWindow,"resize",u.debouncedHandler_)};u.one("load",u.loadListener_)}return u}e(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel();this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect());this.el_&&this.el_.contentWindow&&vt(this.el_.contentWindow,"resize",this.debouncedHandler_);this.loadListener_&&this.off("load",this.loadListener_);this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null},i}(r);r.registerComponent("ResizeManager",ug);var nv=function(n){var f=n.el(),i,r;if(f.hasAttribute("src"))return n.triggerSourceset(f.src),!0;var u=n.$$("source"),t=[],e="";if(!u.length)return!1;for(i=0;i<u.length;i++)r=u[i].src,r&&t.indexOf(r)===-1&&t.push(r);return t.length?(t.length===1&&(e=t[0]),n.triggerSourceset(e),!0):!1},oht=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(i){var r=t.createElement(this.nodeName.toLowerCase()),u;for(r.innerHTML=i,u=t.createDocumentFragment();r.childNodes.length;)u.appendChild(r.childNodes[0]);return this.innerText="",n.Element.prototype.appendChild.call(this,u),this.innerHTML}}),fg=function(n,t){for(var i={},r=0;r<n.length;r++)if(i=Object.getOwnPropertyDescriptor(n[r],t),i&&i.set&&i.get)break;return i.enumerable=!0,i.configurable=!0,i},sht=function(t){return fg([t.el(),n.HTMLMediaElement.prototype,n.Element.prototype,oht],"innerHTML")},eg=function(n){var t=n.el();if(!t.resetSourceWatch_){var i={},r=sht(n),u=function(i){return function(){for(var e,u=arguments.length,f=new Array(u),r=0;r<u;r++)f[r]=arguments[r];return e=i.apply(t,f),nv(n),e}};["append","appendChild","insertAdjacentHTML"].forEach(function(n){t[n]&&(i[n]=t[n],t[n]=u(i[n]))});Object.defineProperty(t,"innerHTML",p(r,{set:u(r.set)}));t.resetSourceWatch_=function(){t.resetSourceWatch_=null;Object.keys(i).forEach(function(n){t[n]=i[n]});Object.defineProperty(t,"innerHTML",r)};n.one("sourceset",t.resetSourceWatch_)}},hht=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?bb(n.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return n.Element.prototype.setAttribute.call(this,"src",t),t}}),cht=function(t){return fg([t.el(),n.HTMLMediaElement.prototype,hht],"src")},lht=function(n){var t;if(n.featuresSourceset&&(t=n.el(),!t.resetSourceset_)){var i=cht(n),r=t.setAttribute,u=t.load;Object.defineProperty(t,"src",p(i,{set:function(r){var u=i.set.call(t,r);return n.triggerSourceset(t.src),u}}));t.setAttribute=function(i,u){var f=r.call(t,i,u);return/src/i.test(i)&&n.triggerSourceset(t.src),f};t.load=function(){var i=u.call(t);return nv(n)||(n.triggerSourceset(""),eg(n)),i};t.currentSrc?n.triggerSourceset(t.currentSrc):nv(n)||eg(n);t.resetSourceset_=function(){t.resetSourceset_=null;t.load=u;t.setAttribute=r;Object.defineProperty(t,"src",i);t.resetSourceWatch_&&t.resetSourceWatch_()}}};u=function(i){function u(n,t){var r,f,e,u,a,o;if(r=i.call(this,n,t)||this,f=n.source,e=!1,f&&(r.el_.currentSrc!==f.src||n.tag&&n.tag.initNetworkState_===3)?r.setSource(f):r.handleLateInit_(r.el_),n.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){for(var h=r.el_.childNodes,l=h.length,s=[];l--;)u=h[l],a=u.nodeName.toLowerCase(),a==="track"&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(u),r.remoteTextTracks().addTrack(u.track),r.textTracks().addTrack(u.track),e||r.el_.hasAttribute("crossorigin")||!lo(u.src)||(e=!0)):s.push(u));for(o=0;o<s.length;o++)r.el_.removeChild(s[o])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&e&&c.warn(hc(og())),r.restoreMetadataTracksInIOSNativePlayer_(),(oo||tl||ib)&&n.nativeControlsForTouch===!0&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}e(u,i);var r=u.prototype;return r.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_();u.disposeMediaElement(this.el_);this.options_=null;i.prototype.dispose.call(this)},r.setupSourcesetHandling_=function(){lht(this)},r.restoreMetadataTracksInIOSNativePlayer_=function(){var n=this.textTracks(),r,t=function(){var t,i;for(r=[],t=0;t<n.length;t++)i=n[t],i.kind==="metadata"&&r.push({track:i,storedMode:i.mode})},i;t();n.addEventListener("change",t);this.on("dispose",function(){return n.removeEventListener("change",t)});i=function i(){for(var t,u=0;u<r.length;u++)t=r[u],t.track.mode==="disabled"&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode);n.removeEventListener("change",i)};this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",t);n.removeEventListener("change",i);n.addEventListener("change",i)});this.on("webkitendfullscreen",function(){n.removeEventListener("change",t);n.addEventListener("change",t);n.removeEventListener("change",i)})},r.overrideNative_=function(n,t){var r=this,i;t===this["featuresNative"+n+"Tracks"]&&(i=n.toLowerCase(),this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(function(n){var t=r.el()[i+"Tracks"];t.removeEventListener(n,r[i+"TracksListeners_"][n])}),this["featuresNative"+n+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i))},r.overrideNativeAudioTracks=function(n){this.overrideNative_("Audio",n)},r.overrideNativeVideoTracks=function(n){this.overrideNative_("Video",n)},r.proxyNativeTracksForType_=function(n){var e=this,r=yt[n],i=this.el()[r.getterName],t=this[r.getterName](),u,f;if(this["featuresNative"+r.capitalName+"Tracks"]&&i&&i.addEventListener){u={change:function(){t.trigger({type:"change",target:t,currentTarget:t,srcElement:t})},addtrack:function(n){t.addTrack(n.track)},removetrack:function(n){t.removeTrack(n.track)}};f=function(){for(var f,r,u=[],n=0;n<t.length;n++){for(f=!1,r=0;r<i.length;r++)if(i[r]===t[n]){f=!0;break}f||u.push(t[n])}while(u.length)t.removeTrack(u.shift())};this[r.getterName+"Listeners_"]=u;Object.keys(u).forEach(function(n){var t=u[n];i.addEventListener(n,t);e.on("dispose",function(){return i.removeEventListener(n,t)})});this.on("loadstart",f);this.on("dispose",function(){return e.off("loadstart",f)})}},r.proxyNativeTracks_=function(){var n=this;yt.names.forEach(function(t){n.proxyNativeTracksForType_(t)})},r.createEl=function(){var n=this.options_.tag,e,h,o,s,r,i,f;for(n&&(this.options_.playerElIngest||this.movingMediaElementInDOM)||(n?(e=n.cloneNode(!0),n.parentNode&&n.parentNode.insertBefore(e,n),u.disposeMediaElement(n),n=e):(n=t.createElement("video"),h=this.options_.tag&&ai(this.options_.tag),o=p({},h),oo&&this.options_.nativeControlsForTouch===!0||delete o.controls,gp(n,y(o,{id:this.options_.techId,"class":"vjs-tech"}))),n.playerId=this.options_.playerId),typeof this.options_.preload!="undefined"&&lf(n,"preload",this.options_.preload),s=["loop","muted","playsinline","autoplay"],r=0;r<s.length;r++)i=s[r],f=this.options_[i],typeof f!="undefined"&&(f?lf(n,i,i):uo(n,i),n[i]=f);return n},r.handleLateInit_=function(n){var i,r,u,t;if(n.networkState!==0&&n.networkState!==3){if(n.readyState===0){i=!1;r=function(){i=!0};this.on("loadstart",r);u=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",u);this.ready(function(){this.off("loadstart",r);this.off("loadedmetadata",u);i||this.trigger("loadstart")});return}t=["loadstart"];t.push("loadedmetadata");n.readyState>=2&&t.push("loadeddata");n.readyState>=3&&t.push("canplay");n.readyState>=4&&t.push("canplaythrough");this.ready(function(){t.forEach(function(n){this.trigger(n)},this)})}},r.setCurrentTime=function(n){try{this.el_.currentTime=n}catch(t){c(t,"Video is not ready. (Video.js)")}},r.duration=function(){var n=this,t;if(this.el_.duration===Infinity&&or&&gi&&this.el_.currentTime===0){t=function t(){n.el_.currentTime>0&&(n.el_.duration===Infinity&&n.trigger("durationchange"),n.off("timeupdate",t))};this.on("timeupdate",t);return NaN}return this.el_.duration||NaN},r.width=function(){return this.el_.offsetWidth},r.height=function(){return this.el_.offsetHeight},r.proxyWebkitFullscreen_=function(){var i=this,n,t;if("webkitDisplayingFullscreen"in this.el_){n=function(){this.trigger("fullscreenchange",{isFullscreen:!1})};t=function(){if("webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"){this.one("webkitendfullscreen",n);this.trigger("fullscreenchange",{isFullscreen:!0})}};this.on("webkitbeginfullscreen",t);this.on("dispose",function(){i.off("webkitbeginfullscreen",t);i.off("webkitendfullscreen",n)})}},r.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var t=n.navigator&&n.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},r.enterFullScreen=function(){var n=this.el_;n.paused&&n.networkState<=n.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){n.pause();n.webkitEnterFullScreen()},0)):n.webkitEnterFullScreen()},r.exitFullScreen=function(){this.el_.webkitExitFullScreen()},r.src=function(n){if(n===undefined)return this.el_.src;this.setSrc(n)},r.reset=function(){u.resetMediaElement(this.el_)},r.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},r.setControls=function(n){this.el_.controls=!!n},r.addTextTrack=function(n,t,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(n,t,r):i.prototype.addTextTrack.call(this,n,t,r)},r.createRemoteTextTrack=function(n){if(!this.featuresNativeTextTracks)return i.prototype.createRemoteTextTrack.call(this,n);var r=t.createElement("track");return n.kind&&(r.kind=n.kind),n.label&&(r.label=n.label),(n.language||n.srclang)&&(r.srclang=n.language||n.srclang),n.default&&(r.default=n.default),n.id&&(r.id=n.id),n.src&&(r.src=n.src),r},r.addRemoteTextTrack=function(n,t){var r=i.prototype.addRemoteTextTrack.call(this,n,t);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},r.removeRemoteTextTrack=function(n){if(i.prototype.removeRemoteTextTrack.call(this,n),this.featuresNativeTextTracks)for(var t=this.$$("track"),r=t.length;r--;)(n===t[r]||n===t[r].track)&&this.el().removeChild(t[r])},r.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var t={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),n.performance&&typeof n.performance.now=="function"?t.creationTime=n.performance.now():n.performance&&n.performance.timing&&typeof n.performance.timing.navigationStart=="number"&&(t.creationTime=n.Date.now()-n.performance.timing.navigationStart),t},u}(v);tu()&&(u.TEST_VID=t.createElement("video"),ee=t.createElement("track"),ee.kind="captions",ee.srclang="en",ee.label="English",u.TEST_VID.appendChild(ee));u.isSupported=function(){try{u.TEST_VID.volume=.5}catch(n){return!1}return!!(u.TEST_VID&&u.TEST_VID.canPlayType)};u.canPlayType=function(n){return u.TEST_VID.canPlayType(n)};u.canPlaySource=function(n){return u.canPlayType(n.type)};u.canControlVolume=function(){try{var n=u.TEST_VID.volume;return u.TEST_VID.volume=n/2+.1,n!==u.TEST_VID.volume}catch(t){return!1}};u.canMuteVolume=function(){try{var n=u.TEST_VID.muted;return u.TEST_VID.muted=!n,u.TEST_VID.muted?lf(u.TEST_VID,"muted","muted"):uo(u.TEST_VID,"muted","muted"),n!==u.TEST_VID.muted}catch(t){return!1}};u.canControlPlaybackRate=function(){if(or&&gi&&ub<58)return!1;try{var n=u.TEST_VID.playbackRate;return u.TEST_VID.playbackRate=n/2+.1,n!==u.TEST_VID.playbackRate}catch(t){return!1}};u.canOverrideAttributes=function(){try{var n=function(){};Object.defineProperty(t.createElement("video"),"src",{get:n,set:n});Object.defineProperty(t.createElement("audio"),"src",{get:n,set:n});Object.defineProperty(t.createElement("video"),"innerHTML",{get:n,set:n});Object.defineProperty(t.createElement("audio"),"innerHTML",{get:n,set:n})}catch(i){return!1}return!0};u.supportsNativeTextTracks=function(){return ob||vi&&gi};u.supportsNativeVideoTracks=function(){return!!(u.TEST_VID&&u.TEST_VID.videoTracks)};u.supportsNativeAudioTracks=function(){return!!(u.TEST_VID&&u.TEST_VID.audioTracks)};u.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];u.prototype.featuresVolumeControl=u.canControlVolume();u.prototype.featuresMuteControl=u.canMuteVolume();u.prototype.featuresPlaybackRate=u.canControlPlaybackRate();u.prototype.featuresSourceset=u.canOverrideAttributes();u.prototype.movingMediaElementInDOM=!vi;u.prototype.featuresFullscreenResize=!0;u.prototype.featuresProgressEvents=!0;u.prototype.featuresTimeupdateEvents=!0;u.prototype.featuresNativeTextTracks=u.supportsNativeTextTracks();u.prototype.featuresNativeVideoTracks=u.supportsNativeVideoTracks();u.prototype.featuresNativeAudioTracks=u.supportsNativeAudioTracks();tv=u.TEST_VID&&u.TEST_VID.constructor.prototype.canPlayType;sg=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;u.patchCanPlayType=function(){il>=4&&!rb&&!gi&&(u.TEST_VID.constructor.prototype.canPlayType=function(n){return n&&sg.test(n)?"maybe":tv.call(this,n)})};u.unpatchCanPlayType=function(){var n=u.TEST_VID.constructor.prototype.canPlayType;return u.TEST_VID.constructor.prototype.canPlayType=tv,n};u.patchCanPlayType();u.disposeMediaElement=function(n){if(n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}};u.resetMediaElement=function(n){if(n){for(var t=n.querySelectorAll("source"),i=t.length;i--;)n.removeChild(t[i]);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){u.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){u.prototype["set"+b(n)]=function(t){this.el_[n]=t;t?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(n){u.prototype[n]=function(){return this.el_[n]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(n){u.prototype["set"+b(n)]=function(t){this.el_[n]=t}});["pause","load","play"].forEach(function(n){u.prototype[n]=function(){return this.el_[n]()}});v.withSourceHandlers(u);u.nativeSourceHandler={};u.nativeSourceHandler.canPlayType=function(n){try{return u.TEST_VID.canPlayType(n)}catch(t){return""}};u.nativeSourceHandler.canHandleSource=function(n){if(n.type)return u.nativeSourceHandler.canPlayType(n.type);if(n.src){var t=ll(n.src);return u.nativeSourceHandler.canPlayType("video/"+t)}return""};u.nativeSourceHandler.handleSource=function(n,t){t.setSrc(n.src)};u.nativeSourceHandler.dispose=function(){};u.registerSourceHandler(u.nativeSourceHandler);v.registerTech("Html5",u);var cg=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],iv={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},rv=["tiny","xsmall","small","medium","large","xlarge","huge"],ys={};rv.forEach(function(n){var t=n.charAt(0)==="x"?"x-"+n.substring(1):n;ys[n]="vjs-layout-"+t});lg={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};k=function(i){function s(n,t,r){var u,o,e,h,l,c,a;if(n.id=n.id||t.id||"vjs_video_"+er(),t=y(s.getTagSettings(n),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if(typeof n.closest=="function")o=n.closest("[lang]"),o&&o.getAttribute&&(t.language=o.getAttribute("lang"));else for(e=n;e&&e.nodeType===1;){if(ai(e).hasOwnProperty("lang")){t.language=e.getAttribute("lang");break}e=e.parentNode}if(u=i.call(this,null,t,r)||this,u.log=sc(u.id_),u.isPosterFromTech_=!1,u.queuedCallbacks_=[],u.isReady_=!1,u.hasStarted_=!1,u.userActive_=!1,!u.options_||!u.options_.techOrder||!u.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");u.tag=n;u.tagAttributes=n&&ai(n);u.language(u.options_.language);t.languages?(h={},Object.getOwnPropertyNames(t.languages).forEach(function(n){h[n.toLowerCase()]=t.languages[n]}),u.languages_=h):u.languages_=s.prototype.options_.languages;u.cache_={};u.poster_=t.poster||"";u.controls_=!!t.controls;u.cache_.lastVolume=1;n.controls=!1;n.removeAttribute("controls");n.hasAttribute("autoplay")?u.options_.autoplay=!0:u.autoplay(u.options_.autoplay);u.scrubbing_=!1;u.el_=u.createEl();u.cache_.lastPlaybackRate=u.defaultPlaybackRate();gc(f(f(u)),{eventBusKey:"el_"});l=p(u.options_);t.plugins&&(c=t.plugins,Object.keys(c).forEach(function(n){if(typeof this[n]=="function")this[n](c[n]);else throw new Error('plugin "'+n+'" does not exist');},f(f(u))));u.options_.playerOptions=l;u.middleware_=[];u.initChildren();u.isAudio(n.nodeName.toLowerCase()==="audio");u.controls()?u.addClass("vjs-controls-enabled"):u.addClass("vjs-controls-disabled");u.el_.setAttribute("role","region");u.isAudio()?u.el_.setAttribute("aria-label",u.localize("Audio Player")):u.el_.setAttribute("aria-label",u.localize("Video Player"));u.isAudio()&&u.addClass("vjs-audio");u.flexNotSupported_()&&u.addClass("vjs-no-flex");vi||u.addClass("vjs-workinghover");s.players[u.id_]=f(f(u));a=fc.split(".")[0];u.addClass("vjs-v"+a);u.userActive(!0);u.reportUserActivity();u.one("play",u.listenForUserActivity_);u.on("fullscreenchange",u.handleFullscreenChange_);u.on("stageclick",u.handleStageClick_);return u.breakpoints(u.options_.breakpoints),u.responsive(u.options_.responsive),u.changingSrc_=!1,u.playWaitingForReady_=!1,u.playOnLoadstart_=null,u}e(s,i);var u=s.prototype;return u.dispose=function(){this.trigger("dispose");this.off("dispose");this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null);s.players[this.id_]=null;this.tag&&this.tag.player&&(this.tag.player=null);this.el_&&this.el_.player&&(this.el_.player=null);this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_="");this.playerElIngest_&&(this.playerElIngest_=null);this.tag&&(this.tag=null);dst(this);i.prototype.dispose.call(this)},u.createEl=function(){var r=this.tag,u,s=this.playerElIngest_=r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player"),e=this.tag.tagName.toLowerCase()==="video-js",f,h,c,l,o,a;if(s?u=this.el_=r.parentNode:e||(u=this.el_=i.prototype.createEl.call(this,"div")),f=ai(r),e){for(u=this.el_=r,r=this.tag=t.createElement("video");u.children.length;)r.appendChild(u.firstChild);ur(u,"video-js")||fr(u,"video-js");u.appendChild(r);s=this.playerElIngest_=u;Object.keys(u).forEach(function(n){r[n]=u[n]})}for(r.setAttribute("tabindex","-1"),f.tabindex="-1",fb&&(r.setAttribute("role","application"),f.role="application"),r.removeAttribute("width"),r.removeAttribute("height"),("width"in f)&&delete f.width,("height"in f)&&delete f.height,Object.getOwnPropertyNames(f).forEach(function(n){e&&n==="class"||u.setAttribute(n,f[n]);e&&r.setAttribute(n,f[n])}),r.playerId=r.id,r.id+="_html5_api",r.className="vjs-tech",r.player=u.player=this,this.addClass("vjs-paused"),n.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&(this.styleEl_=vw("vjs-styles-dimensions"),h=ki(".vjs-styles-defaults"),c=ki("head"),c.insertBefore(this.styleEl_,h?h.nextSibling:c.firstChild)),this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),l=r.getElementsByTagName("a"),o=0;o<l.length;o++)a=l.item(o),fr(a,"vjs-hidden"),a.setAttribute("hidden","hidden");return r.initNetworkState_=r.networkState,r.parentNode&&!s&&r.parentNode.insertBefore(u,r),ro(r,u),this.children_.unshift(r),this.el_.setAttribute("lang",this.language_),this.el_=u,u},u.width=function(n){return this.dimension("width",n)},u.height=function(n){return this.dimension("height",n)},u.dimension=function(n,t){var i=n+"_",r;if(t===undefined)return this[i]||0;if(t===""){this[i]=undefined;this.updateStyleEl_();return}if(r=parseFloat(t),isNaN(r)){c.error('Improper value "'+t+'" supplied for for '+n);return}this[i]=r;this.updateStyleEl_()},u.fluid=function(n){if(n===undefined)return!!this.fluid_;this.fluid_=!!n;n?(this.addClass("vjs-fluid"),this.fill(!1)):this.removeClass("vjs-fluid");this.updateStyleEl_()},u.fill=function(n){if(n===undefined)return!!this.fill_;this.fill_=!!n;n?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},u.aspectRatio=function(n){if(n===undefined)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(n))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=n;this.fluid(!0);this.updateStyleEl_()},u.updateStyleEl_=function(){var u,s,h,t,f,i;if(n.VIDEOJS_NO_DYNAMIC_STYLE===!0){var e=typeof this.width_=="number"?this.width_:this.options_.width,o=typeof this.height_=="number"?this.height_:this.options_.height,r=this.tech_&&this.tech_.el();r&&(e>=0&&(r.width=e),o>=0&&(r.height=o));return}h=this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";f=h.split(":");i=f[1]/f[0];u=this.width_!==undefined?this.width_:this.height_!==undefined?this.height_/i:this.videoWidth()||300;s=this.height_!==undefined?this.height_:u*i;t=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions";this.addClass(t);yw(this.styleEl_,"\n      ."+t+" {\n        width: "+u+"px;\n        height: "+s+"px;\n      }\n\n      ."+t+".vjs-fluid {\n        padding-top: "+i*100+"%;\n      }\n    ")},u.loadTech_=function(n,t){var i=this,u,f,s,r,e;if(this.tech_&&this.unloadTech_(),u=b(n),f=n.charAt(0).toLowerCase()+n.slice(1),u!=="Html5"&&this.tag&&(v.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=u,this.isReady_=!1,s=typeof this.autoplay()=="string"?!1:this.autoplay(),r={source:t,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+f+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset},ct.names.forEach(function(n){var t=ct[n];r[t.getterName]=i[t.privateName]}),y(r,this.options_[u]),y(r,this.options_[f]),y(r,this.options_[n.toLowerCase()]),this.tag&&(r.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(r.startTime=this.cache_.currentTime),e=v.getTech(n),!e)throw new Error("No Tech named '"+u+"' exists! '"+u+"' should be registered using videojs.registerTech()'");this.tech_=new e(r);this.tech_.ready(o(this,this.handleTechReady_),!0);ab.jsonToTextTracks(this.textTracksJson_||[],this.tech_);cg.forEach(function(n){i.on(i.tech_,n,i["handleTech"+b(n)+"_"])});Object.keys(iv).forEach(function(n){i.on(i.tech_,n,function(t){if(i.tech_.playbackRate()===0&&i.tech_.seeking()){i.queuedCallbacks_.push({callback:i["handleTech"+iv[n]+"_"].bind(i),event:t});return}i["handleTech"+iv[n]+"_"](t)})});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"sourceset",this.handleTechSourceset_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.usingNativeControls(this.techGet_("controls"));this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_();this.tech_.el().parentNode===this.el()||u==="Html5"&&this.tag||ro(this.tech_.el(),this.el());this.tag&&(this.tag.player=null,this.tag=null)},u.unloadTech_=function(){var n=this;ct.names.forEach(function(t){var i=ct[t];n[i.privateName]=n[i.getterName]()});this.textTracksJson_=ab.textTracksToJson(this.tech_);this.isReady_=!1;this.tech_.dispose();this.tech_=!1;this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange"));this.isPosterFromTech_=!1},u.tech=function(n){return n===undefined&&c.warn(hc(hg())),this.tech_},u.addTechControlsListeners_=function(){this.removeTechControlsListeners_();this.on(this.tech_,"mousedown",this.handleTechClick_);this.on(this.tech_,"dblclick",this.handleTechDoubleClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)},u.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mousedown",this.handleTechClick_);this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},u.handleTechReady_=function(){this.triggerReady();this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume);this.handleTechPosterChange_();this.handleTechDurationChange_()},u.handleTechLoadStart_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"));this.manualAutoplay_(this.autoplay())},u.manualAutoplay_=function(n){var i=this,r,t;if(this.tech_&&typeof n=="string")return(r=function(){var t=i.muted(),n;if(i.muted(!0),n=i.play(),n&&n.then&&n.catch)return n.catch(function(){i.muted(t)})},n==="any"?(t=this.play(),t&&t.then&&t.catch&&t.catch(function(){return r()})):t=n==="muted"?r():this.play(),!t||!t.then||!t.catch)?void 0:t.then(function(){i.trigger({type:"autoplay-success",autoplay:n})}).catch(function(){i.trigger({type:"autoplay-failure",autoplay:n})})},u.updateSourceCaches_=function(n){var t,i,u,r;n===void 0&&(n="");t=n;i="";typeof t!="string"&&(t=n.src,i=n.type);this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];t&&!i&&(i=tht(this,t));this.cache_.source=p({},n,{src:t,type:i});var f=this.cache_.sources.filter(function(n){return n.src&&n.src===t}),e=[],o=this.$$("source"),s=[];for(u=0;u<o.length;u++)r=ai(o[u]),e.push(r),r.src&&r.src===t&&s.push(r.src);s.length&&!f.length?this.cache_.sources=e:f.length||(this.cache_.sources=[this.cache_.source]);this.cache_.src=t},u.handleTechSourceset_=function(n){var t=this,u;if(!this.changingSrc_){var f=function(n){return t.updateSourceCaches_(n)},i=this.currentSource().src,r=n.src;if(i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(this.lastSource_&&(this.lastSource_.tech===r||this.lastSource_.player===i)||(f=function(){})),f(r),!n.src){u=function u(n){if(n.type!=="sourceset"){var i=t.techGet("currentSrc");t.lastSource_.tech=i;t.updateSourceCaches_(i)}t.tech_.off(["sourceset","loadstart"],u)};this.tech_.one(["sourceset","loadstart"],u)}}this.lastSource_={player:this.currentSource().src,tech:n.src};this.trigger({src:n.src,type:"sourceset"})},u.hasStarted=function(n){if(n===undefined)return this.hasStarted_;n!==this.hasStarted_&&(this.hasStarted_=n,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},u.handleTechPlay_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(!0);this.trigger("play")},u.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(n){return n.callback(n.event)}),this.queuedCallbacks_=[]);this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")},u.handleTechWaiting_=function(){var n=this;this.addClass("vjs-waiting");this.trigger("waiting");this.one("timeupdate",function(){return n.removeClass("vjs-waiting")})},u.handleTechCanPlay_=function(){this.removeClass("vjs-waiting");this.trigger("canplay")},u.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")},u.handleTechPlaying_=function(){this.removeClass("vjs-waiting");this.trigger("playing")},u.handleTechSeeking_=function(){this.addClass("vjs-seeking");this.trigger("seeking")},u.handleTechSeeked_=function(){this.removeClass("vjs-seeking");this.trigger("seeked")},u.handleTechFirstPlay_=function(){this.options_.starttime&&(c.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime));this.addClass("vjs-has-started");this.trigger("firstplay")},u.handleTechPause_=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")},u.handleTechEnded_=function(){this.addClass("vjs-ended");this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause();this.trigger("ended")},u.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},u.handleTechClick_=function(n){iu(n)&&this.controls_&&(this.paused()?df(this.play()):this.pause())},u.handleTechDoubleClick_=function(n){if(this.controls_){var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(n.target)});t||(this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},u.handleTechTap_=function(){this.userActive(!this.userActive())},u.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},u.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},u.handleTechTouchEnd_=function(n){n.preventDefault()},u.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},u.handleStageClick_=function(){this.reportUserActivity()},u.handleTechFullscreenChange_=function(n,t){t&&this.isFullscreen(t.isFullscreen);this.trigger("fullscreenchange")},u.handleTechError_=function(){var n=this.tech_.error();this.error(n)},u.handleTechTextData_=function(){var n=null;arguments.length>1&&(n=arguments[1]);this.trigger("textdata",n)},u.getCache=function(){return this.cache_},u.techCall_=function(n,t){this.ready(function(){if(n in bst)return pst(this.middleware_,this.tech_,n,t);if(n in pk)return yk(this.middleware_,this.tech_,n,t);try{this.tech_&&this.tech_[n](t)}catch(i){c(i);throw i;}},!0)},u.techGet_=function(n){if(this.tech_&&this.tech_.isReady_){if(n in wst)return vk(this.middleware_,this.tech_,n);if(n in pk)return yk(this.middleware_,this.tech_,n);try{return this.tech_[n]()}catch(t){if(this.tech_[n]===undefined){c("Video.js: "+n+" method not defined for "+this.techName_+" playback technology.",t);throw t;}if(t.name==="TypeError"){c("Video.js: "+n+" unavailable on "+this.techName_+" playback technology element.",t);this.tech_.isReady_=!1;throw t;}c(t);throw t;}}},u.play=function(){var i=this,t=this.options_.Promise||n.Promise;return t?new t(function(n){i.play_(n)}):this.play_()},u.play_=function(n){var t=this;if(n===void 0&&(n=df),this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc())){n(this.techGet_("play"));return}this.playOnLoadstart_=function(){t.playOnLoadstart_=null;n(t.play())};this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0;this.ready(function(){t.playWaitingForReady_=!1;n(t.play())})}},u.pause=function(){this.techCall_("pause")},u.paused=function(){return this.techGet_("paused")===!1?!1:!0},u.played=function(){return this.techGet_("played")||sr(0,0)},u.scrubbing=function(n){if(typeof n=="undefined")return this.scrubbing_;this.scrubbing_=!!n;n?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},u.currentTime=function(n){if(typeof n!="undefined"){n<0&&(n=0);this.techCall_("setCurrentTime",n);return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},u.duration=function(n){if(n===undefined)return this.cache_.duration!==undefined?this.cache_.duration:NaN;n=parseFloat(n);n<0&&(n=Infinity);n!==this.cache_.duration&&(this.cache_.duration=n,n===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))},u.remainingTime=function(){return this.duration()-this.currentTime()},u.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},u.buffered=function(){var n=this.techGet_("buffered");return n&&n.length||(n=sr(0,0)),n},u.bufferedPercent=function(){return hb(this.buffered(),this.duration())},u.bufferedEnd=function(){var t=this.buffered(),i=this.duration(),n=t.end(t.length-1);return n>i&&(n=i),n},u.volume=function(n){var t;if(n!==undefined){t=Math.max(0,Math.min(1,parseFloat(n)));this.cache_.volume=t;this.techCall_("setVolume",t);t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t},u.muted=function(n){if(n!==undefined){this.techCall_("setMuted",n);return}return this.techGet_("muted")||!1},u.defaultMuted=function(n){return n!==undefined?this.techCall_("setDefaultMuted",n):this.techGet_("defaultMuted")||!1},u.lastVolume_=function(n){if(n!==undefined&&n!==0){this.cache_.lastVolume=n;return}return this.cache_.lastVolume},u.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},u.isFullscreen=function(n){if(n!==undefined){this.isFullscreen_=!!n;return}return!!this.isFullscreen_},u.requestFullscreen=function(){var n=so;this.isFullscreen(!0);n.requestFullscreen?(fi(t,n.fullscreenchange,o(this,function i(){this.isFullscreen(t[n.fullscreenElement]);this.isFullscreen()===!1&&vt(t,n.fullscreenchange,i);this.trigger("fullscreenchange")})),this.el_[n.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},u.exitFullscreen=function(){var n=so;this.isFullscreen(!1);n.requestFullscreen?t[n.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},u.enterFullWindow=function(){this.isFullWindow=!0;this.docOrigOverflow=t.documentElement.style.overflow;fi(t,"keydown",o(this,this.fullWindowOnEscKey));t.documentElement.style.overflow="hidden";fr(t.body,"vjs-full-window");this.trigger("enterFullWindow")},u.fullWindowOnEscKey=function(n){n.keyCode===27&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},u.exitFullWindow=function(){this.isFullWindow=!1;vt(t,"keydown",this.fullWindowOnEscKey);t.documentElement.style.overflow=this.docOrigOverflow;cf(t.body,"vjs-full-window");this.trigger("exitFullWindow")},u.canPlayType=function(n){for(var i,t,u,f=0,e=this.options_.techOrder;f<e.length;f++){if(i=e[f],t=v.getTech(i),t||(t=r.getComponent(i)),!t){c.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.');continue}if(t.isSupported()&&(u=t.canPlayType(n),u))return u}return""},u.selectSource=function(n){var f=this,t=this.options_.techOrder.map(function(n){return[n,v.getTech(n)]}).filter(function(n){var i=n[0],t=n[1];return t?t.isSupported():(c.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),i=function(n,t,i){var r;return n.some(function(n){return t.some(function(t){return r=i(n,t),r?!0:void 0})}),r},r,e=function(n){return function(t,i){return n(i,t)}},u=function(n,t){var i=n[0],r=n[1];if(r.canPlaySource(t,f.options_[i.toLowerCase()]))return{source:t,tech:i}};return r=this.options_.sourceOrder?i(n,t,e(u)):i(t,n,u),r||!1},u.src=function(n){var t=this,i;if(typeof n=="undefined")return this.cache_.src||"";if(i=bk(n),!i.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}this.changingSrc_=!0;this.cache_.sources=i;this.updateSourceCaches_(i[0]);vst(this,i[0],function(n,r){t.middleware_=r;t.cache_.sources=i;t.updateSourceCaches_(n);var u=t.src_(n);if(u){if(i.length>1)return t.src(i.slice(1));t.changingSrc_=!1;t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);t.triggerReady();return}yst(r,t.tech_)})},u.src_=function(n){var i=this,t=this.selectSource([n]);return t?lft(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",n):this.techCall_("src",n.src);this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(function(){i.changingSrc_=!1}),!1):!0},u.load=function(){this.techCall_("load")},u.reset=function(){this.tech_&&this.tech_.clearTracks("text");this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset")},u.currentSources=function(){var n=this.currentSource(),t=[];return Object.keys(n).length!==0&&t.push(n),this.cache_.sources||t},u.currentSource=function(){return this.cache_.source||{}},u.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},u.currentType=function(){return this.currentSource()&&this.currentSource().type||""},u.preload=function(n){if(n!==undefined){this.techCall_("setPreload",n);this.options_.preload=n;return}return this.techGet_("preload")},u.autoplay=function(n){if(n===undefined)return this.options_.autoplay||!1;var t;typeof n=="string"&&/(any|play|muted)/.test(n)?(this.options_.autoplay=n,this.manualAutoplay_(n),t=!1):this.options_.autoplay=n?!0:!1;t=t||this.options_.autoplay;this.tech_&&this.techCall_("setAutoplay",t)},u.playsinline=function(n){return n!==undefined?(this.techCall_("setPlaysinline",n),this.options_.playsinline=n,this):this.techGet_("playsinline")},u.loop=function(n){if(n!==undefined){this.techCall_("setLoop",n);this.options_.loop=n;return}return this.techGet_("loop")},u.poster=function(n){if(n===undefined)return this.poster_;(n||(n=""),n!==this.poster_)&&(this.poster_=n,this.techCall_("setPoster",n),this.isPosterFromTech_=!1,this.trigger("posterchange"))},u.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var n=this.tech_.poster()||"";n!==this.poster_&&(this.poster_=n,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},u.controls=function(n){if(n===undefined)return!!this.controls_;(n=!!n,this.controls_!==n)&&(this.controls_=n,this.usingNativeControls()&&this.techCall_("setControls",n),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},u.usingNativeControls=function(n){if(n===undefined)return!!this.usingNativeControls_;(n=!!n,this.usingNativeControls_!==n)&&(this.usingNativeControls_=n,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},u.error=function(n){if(n===undefined)return this.error_||null;if(n===null){this.error_=n;this.removeClass("vjs-error");this.errorDisplay&&this.errorDisplay.close();return}this.error_=new rt(n);this.addClass("vjs-error");c.error("(CODE:"+this.error_.code+" "+rt.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return},u.reportUserActivity=function(){this.userActivity_=!0},u.userActive=function(n){if(n===undefined)return this.userActive_;if(n=!!n,n!==this.userActive_){if(this.userActive_=n,this.userActive_){this.userActivity_=!0;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_)this.tech_.one("mousemove",function(n){n.stopPropagation();n.preventDefault()});this.userActivity_=!1;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}},u.listenForUserActivity_=function(){var t,i,r,n=o(this,this.reportUserActivity),f=function(t){(t.screenX!==i||t.screenY!==r)&&(i=t.screenX,r=t.screenY,n())},e=function(){n();this.clearInterval(t);t=this.setInterval(n,250)},s=function(){n();this.clearInterval(t)},u;this.on("mousedown",e);this.on("mousemove",f);this.on("mouseup",s);this.on("keydown",n);this.on("keyup",n);this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1;this.userActive(!0);this.clearTimeout(u);var n=this.options_.inactivityTimeout;n<=0||(u=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},n))}},250)},u.playbackRate=function(n){if(n!==undefined){this.techCall_("setPlaybackRate",n);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},u.defaultPlaybackRate=function(n){return n!==undefined?this.techCall_("setDefaultPlaybackRate",n):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},u.isAudio=function(n){if(n!==undefined){this.isAudio_=!!n;return}return!!this.isAudio_},u.addTextTrack=function(n,t,i){if(this.tech_)return this.tech_.addTextTrack(n,t,i)},u.addRemoteTextTrack=function(n,t){if(this.tech_)return this.tech_.addRemoteTextTrack(n,t)},u.removeRemoteTextTrack=function(n){n===void 0&&(n={});var i=n,t=i.track;return t||(t=n),this.tech_?this.tech_.removeRemoteTextTrack(t):void 0},u.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},u.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},u.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},u.language=function(n){if(n===undefined)return this.language_;this.language_=String(n).toLowerCase()},u.languages=function(){return p(s.prototype.options_.languages,this.languages_)},u.toJSON=function(){var i=p(this.options_),r=i.tracks,n,t;for(i.tracks=[],n=0;n<r.length;n++)t=r[n],t=p(t),t.player=undefined,i.tracks[n]=t;return i},u.createModal=function(n,t){var r=this,i;t=t||{};t.content=n||"";i=new eu(this,t);this.addChild(i);i.on("dispose",function(){r.removeChild(i)});return i.open(),i},u.updateCurrentBreakpoint_=function(){var t,r,i,n,u;if(this.responsive())for(t=this.currentBreakpoint(),r=this.currentWidth(),i=0;i<rv.length;i++)if(n=rv[i],u=this.breakpoints_[n],r<=u){if(t===n)return;t&&this.removeClass(ys[t]);this.addClass(ys[n]);this.breakpoint_=n;break}},u.removeCurrentBreakpoint_=function(){var n=this.currentBreakpointClass();this.breakpoint_="";n&&this.removeClass(n)},u.breakpoints=function(n){return n===undefined?y(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=y({},lg,n),this.updateCurrentBreakpoint_(),y(this.breakpoints_))},u.responsive=function(n){if(n===undefined)return this.responsive_;n=Boolean(n);var t=this.responsive_;if(n!==t){if(this.responsive_=n,n){this.on("playerresize",this.updateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_();return n}},u.currentBreakpoint=function(){return this.breakpoint_},u.currentBreakpointClass=function(){return ys[this.breakpoint_]||""},s.getTagSettings=function(n){var i={sources:[],tracks:[]},t=ai(n),o=t["data-setup"],f,r,l,u,e;if(ur(n,"vjs-fill")&&(t.fill=!0),ur(n,"vjs-fluid")&&(t.fluid=!0),o!==null){var s=cb(o||"{}"),h=s[0],a=s[1];h&&c.error(h);y(t,a)}if(y(i,t),n.hasChildNodes())for(f=n.childNodes,r=0,l=f.length;r<l;r++)u=f[r],e=u.nodeName.toLowerCase(),e==="source"?i.sources.push(ai(u)):e==="track"&&i.tracks.push(ai(u));return i},u.flexNotSupported_=function(){var n=t.createElement("i");return!("flexBasis"in n.style||"webkitFlexBasis"in n.style||"mozFlexBasis"in n.style||"msFlexBasis"in n.style||"msFlexOrder"in n.style)},s}(r);ct.names.forEach(function(n){var t=ct[n];k.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}});k.players={};vu=n.navigator;k.prototype.options_={techOrder:v.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:vu&&(vu.languages&&vu.languages[0]||vu.userLanguage||vu.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(n){k.prototype[n]=function(){return this.techGet_(n)}});cg.forEach(function(n){k.prototype["handleTech"+b(n)+"_"]=function(){return this.trigger(n)}});r.registerComponent("Player",k);var ps="plugin",yu="activePlugins_",pu={},ws=function(n){return pu.hasOwnProperty(n)},bs=function(n){return ws(n)?pu[n]:undefined},ag=function(n,t){n[yu]=n[yu]||{};n[yu][t]=!0},ks=function(n,t,i){var r=(i?"before":"")+"pluginsetup";n.trigger(r,t);n.trigger(r+":"+t.name,t)},aht=function(n,t){var i=function(){ks(this,{name:n,plugin:t,instance:null},!0);var i=t.apply(this,arguments);return ag(this,n),ks(this,{name:n,plugin:t,instance:i}),i};return Object.keys(t).forEach(function(n){i[n]=t[n]}),i},vg=function(n,t){return t.prototype.name=n,function(){var r;ks(this,{name:n,plugin:t,instance:null},!0);for(var u=arguments.length,f=new Array(u),i=0;i<u;i++)f[i]=arguments[i];return r=io(t,[this].concat(f)),this[n]=function(){return r},ks(this,r.getEventHash()),r}},si=function(){function n(t){if(this.constructor===n)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t;gc(this);delete this.trigger;gw(this,this.constructor.defaultState);ag(t,this.name);this.dispose=o(this,this.dispose);t.on("dispose",this.dispose)}var t=n.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(n){return n===void 0&&(n={}),n.name=this.name,n.plugin=this.constructor,n.instance=this,n},t.trigger=function(n,t){return t===void 0&&(t={}),uu(this.eventBusEl_,n,this.getEventHash(t))},t.handleStateChanged=function(){},t.dispose=function(){var n=this.name,t=this.player;this.trigger("dispose");this.off();t.off("dispose",this.dispose);t[yu][n]=!1;this.player=this.state=null;t[n]=vg(n,pu[n])},n.isBasic=function(t){var i=typeof t=="string"?bs(t):t;return typeof i=="function"&&!n.prototype.isPrototypeOf(i.prototype)},n.registerPlugin=function(t,i){if(typeof t!="string")throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(ws(t))c.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(k.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if(typeof i!="function")throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".");return pu[t]=i,t!==ps&&(k.prototype[t]=n.isBasic(i)?aht(t,i):vg(t,i)),i},n.deregisterPlugin=function(n){if(n===ps)throw new Error("Cannot de-register base plugin.");ws(n)&&(delete pu[n],delete k.prototype[n])},n.getPlugins=function(n){n===void 0&&(n=Object.keys(pu));var t;return n.forEach(function(n){var i=bs(n);i&&(t=t||{},t[n]=i)}),t},n.getPluginVersion=function(n){var t=bs(n);return t&&t.VERSION||""},n}();si.getPlugin=bs;si.BASE_PLUGIN_NAME=ps;si.registerPlugin(ps,si);k.prototype.usingPlugin=function(n){return!!this[yu]&&this[yu][n]===!0};k.prototype.hasPlugin=function(n){return!!ws(n)};var vht=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(n.super_=t)},yht=function(n,t){var i,r,u;t===void 0&&(t={});i=function(){n.apply(this,arguments)};r={};typeof t=="object"?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),r=t):typeof t=="function"&&(i=t);vht(i,n);for(u in r)r.hasOwnProperty(u)&&(i.prototype[u]=r[u]);return i},yg=function(n){return n.indexOf("#")===0?n.slice(1):n};i.hooks_={};i.hooks=function(n,t){return i.hooks_[n]=i.hooks_[n]||[],t&&(i.hooks_[n]=i.hooks_[n].concat(t)),i.hooks_[n]};i.hook=function(n,t){i.hooks(n,t)};i.hookOnce=function(n,t){i.hooks(n,[].concat(t).map(function(t){var r=function r(){return i.removeHook(n,r),t.apply(void 0,arguments)};return r}))};i.removeHook=function(n,t){var r=i.hooks(n).indexOf(t);return r<=-1?!1:(i.hooks_[n]=i.hooks_[n].slice(),i.hooks_[n].splice(r,1),!0)};n.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&tu()&&(oe=ki(".vjs-styles-defaults"),oe||(oe=vw("vjs-styles-defaults"),ds=ki("head"),ds&&ds.insertBefore(oe,ds.firstChild),yw(oe,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")));kc(1,i);i.VERSION=fc;i.options=k.prototype.options_;i.getPlayers=function(){return k.players};i.getPlayer=function(n){var i=k.players,t,r,u;if(typeof n=="string"){if(r=yg(n),u=i[r],u)return u;t=ki("#"+r)}else t=n;if(sf(t)){var f=t,e=f.player,o=f.playerId;if(e||i[o])return e||i[o]}};i.getAllPlayers=function(){return Object.keys(k.players).map(function(n){return k.players[n]}).filter(Boolean)};i.players=k.players;i.getComponent=r.getComponent;i.registerComponent=function(n,t){v.isTech(t)&&c.warn("The "+n+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");r.registerComponent.call(r,n,t)};i.getTech=v.getTech;i.registerTech=v.registerTech;i.use=ast;Object.defineProperty(i,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(i.middleware,"TERMINATOR",{value:po,writeable:!1,enumerable:!0});i.browser=yft;i.TOUCH_ENABLED=oo;i.extend=yht;i.mergeOptions=p;i.bind=o;i.registerPlugin=si.registerPlugin;i.deregisterPlugin=si.deregisterPlugin;i.plugin=function(n,t){return c.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),si.registerPlugin(n,t)};i.getPlugins=si.getPlugins;i.getPlugin=si.getPlugin;i.getPluginVersion=si.getPluginVersion;i.addLanguage=function(n,t){var r;return n=(""+n).toLowerCase(),i.options.languages=p(i.options.languages,(r={},r[n]=t,r)),i.options.languages[n]};i.log=c;i.createLogger=sc;i.createTimeRange=i.createTimeRanges=sr;i.formatTime=cu;i.setFormatTime=rht;i.resetFormatTime=uht;i.parseUrl=cl;i.isCrossOrigin=lo;i.EventTarget=tt;i.on=fi;i.one=yf;i.off=vt;i.trigger=uu;i.xhr=vl;i.TextTrack=ne;i.AudioTrack=uk;i.VideoTrack=fk;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(n){i[n]=function(){return c.warn("videojs."+n+"() is deprecated; use videojs.dom."+n+"() instead"),sw[n].apply(null,arguments)}});i.computedStyle=cc;i.dom=sw;i.url=eet;var pg=al(function(n){(function(){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,u=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),i=i.trim(),!i){if(!u.alwaysNormalize)return n;if(s=t.parseURL(n),!s)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=t.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&e.path[0]!=="/"&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,f.path[0]!=="/"&&(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query))))),o.path===null&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parseURL:function(n){var t=i.exec(n);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t})(kb)}),gs=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},pht=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},uv=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)},fv=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n},ev=function(){function n(){gs(this,n);this.listeners={}}return n.prototype.on=function(n,t){this.listeners[n]||(this.listeners[n]=[]);this.listeners[n].push(t)},n.prototype.off=function(n,t){if(!this.listeners[n])return!1;var i=this.listeners[n].indexOf(t);return this.listeners[n].splice(i,1),i>-1},n.prototype.trigger=function(n){var i=this.listeners[n],t=void 0,r=void 0,u=void 0;if(i)if(arguments.length===2)for(r=i.length,t=0;t<r;++t)i[t].call(this,arguments[1]);else for(u=Array.prototype.slice.call(arguments,1),r=i.length,t=0;t<r;++t)i[t].apply(this,u)},n.prototype.dispose=function(){this.listeners={}},n.prototype.pipe=function(n){this.on("data",function(t){n.push(t)})},n}(),wht=function(n){function t(){gs(this,t);var i=fv(this,n.call(this));return i.buffer="",i}return uv(t,n),t.prototype.push=function(n){var t=void 0;for(this.buffer+=n,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(ev),bht=function(){return new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')},se=function(n){for(var i=n.split(bht()),u={},r=i.length,t=void 0;r--;)i[r]!==""&&(t=/([^=]*)=(.*)/.exec(i[r]).slice(1),t[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),u[t[0]]=t[1]);return u},kht=function(n){function t(){gs(this,t);var i=fv(this,n.call(this));return i.customParsers=[],i}return uv(t,n),t.prototype.push=function(n){var i=void 0,t=void 0,f,r,u,e;if(n=n.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),n.length!==0){if(n[0]!=="#"){this.trigger("data",{type:"uri",uri:n});return}for(f=0;f<this.customParsers.length;f++)if(this.customParsers[f].call(this,n))return;if(n.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:n.slice(1)});return}if(n=n.replace("\r",""),i=/^#EXTM3U/.exec(n),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(n),i){t={type:"tag",tagType:"inf"};i[1]&&(t.duration=parseFloat(i[1]));i[2]&&(t.title=i[2]);this.trigger("data",t);return}if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"targetduration"};i[1]&&(t.duration=parseInt(i[1],10));this.trigger("data",t);return}if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"totalduration"};i[1]&&(t.duration=parseInt(i[1],10));this.trigger("data",t);return}if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"version"};i[1]&&(t.version=parseInt(i[1],10));this.trigger("data",t);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"media-sequence"};i[1]&&(t.number=parseInt(i[1],10));this.trigger("data",t);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"discontinuity-sequence"};i[1]&&(t.number=parseInt(i[1],10));this.trigger("data",t);return}if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"playlist-type"};i[1]&&(t.playlistType=i[1]);this.trigger("data",t);return}if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"byterange"};i[1]&&(t.length=parseInt(i[1],10));i[2]&&(t.offset=parseInt(i[2],10));this.trigger("data",t);return}if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(n),i){t={type:"tag",tagType:"allow-cache"};i[1]&&(t.allowed=!/NO/.test(i[1]));this.trigger("data",t);return}if(i=/^#EXT-X-MAP:?(.*)$/.exec(n),i){if(t={type:"tag",tagType:"map"},i[1]&&(r=se(i[1]),r.URI&&(t.uri=r.URI),r.BYTERANGE)){var o=r.BYTERANGE.split("@"),s=o[0],h=o[1];t.byterange={};s&&(t.byterange.length=parseInt(s,10));h&&(t.byterange.offset=parseInt(h,10))}this.trigger("data",t);return}if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(n),i){t={type:"tag",tagType:"stream-inf"};i[1]&&(t.attributes=se(i[1]),t.attributes.RESOLUTION&&(u=t.attributes.RESOLUTION.split("x"),e={},u[0]&&(e.width=parseInt(u[0],10)),u[1]&&(e.height=parseInt(u[1],10)),t.attributes.RESOLUTION=e),t.attributes.BANDWIDTH&&(t.attributes.BANDWIDTH=parseInt(t.attributes.BANDWIDTH,10)),t.attributes["PROGRAM-ID"]&&(t.attributes["PROGRAM-ID"]=parseInt(t.attributes["PROGRAM-ID"],10)));this.trigger("data",t);return}if(i=/^#EXT-X-MEDIA:?(.*)$/.exec(n),i){t={type:"tag",tagType:"media"};i[1]&&(t.attributes=se(i[1]));this.trigger("data",t);return}if(i=/^#EXT-X-ENDLIST/.exec(n),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(n),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(n),i){t={type:"tag",tagType:"program-date-time"};i[1]&&(t.dateTimeString=i[1],t.dateTimeObject=new Date(i[1]));this.trigger("data",t);return}if(i=/^#EXT-X-KEY:?(.*)$/.exec(n),i){t={type:"tag",tagType:"key"};i[1]&&(t.attributes=se(i[1]),t.attributes.IV&&(t.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(t.attributes.IV=t.attributes.IV.substring(2)),t.attributes.IV=t.attributes.IV.match(/.{8}/g),t.attributes.IV[0]=parseInt(t.attributes.IV[0],16),t.attributes.IV[1]=parseInt(t.attributes.IV[1],16),t.attributes.IV[2]=parseInt(t.attributes.IV[2],16),t.attributes.IV[3]=parseInt(t.attributes.IV[3],16),t.attributes.IV=new Uint32Array(t.attributes.IV)));this.trigger("data",t);return}if(i=/^#EXT-X-START:?(.*)$/.exec(n),i){t={type:"tag",tagType:"start"};i[1]&&(t.attributes=se(i[1]),t.attributes["TIME-OFFSET"]=parseFloat(t.attributes["TIME-OFFSET"]),t.attributes.PRECISE=/YES/.test(t.attributes.PRECISE));this.trigger("data",t);return}if(i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-out-cont"};t.data=i[1]?i[1]:"";this.trigger("data",t);return}if(i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-out"};t.data=i[1]?i[1]:"";this.trigger("data",t);return}if(i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-in"};t.data=i[1]?i[1]:"";this.trigger("data",t);return}this.trigger("data",{type:"tag",data:n.slice(4)})}},t.prototype.addParser=function(n){var i=this,r=n.expression,u=n.customType,t=n.dataParser,f=n.segment;typeof t!="function"&&(t=function(n){return n});this.customParsers.push(function(n){var e=r.exec(n);if(e)return i.trigger("data",{type:"custom",data:t(n),customType:u,segment:f}),!0})},t}(ev),wg=function(n){function t(){var r;gs(this,t);r=fv(this,n.call(this));r.lineStream=new wht;r.parseStream=new kht;r.lineStream.pipe(r.parseStream);var s=r,e=[],i={},u=void 0,f=void 0,c=function(){},h={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},o=0;r.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};r.parseStream.on("data",function(n){var r=void 0,t=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=n.allowed;"allowed"in n||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in n&&(i.byterange=t,t.length=n.length,"offset"in n||(this.trigger("info",{message:"defaulting offset to zero"}),n.offset=0));"offset"in n&&(i.byterange=t,t.offset=n.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"}));"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"}));n.duration>0&&(i.duration=n.duration);n.duration===0&&(i.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"}));this.manifest.segments=e},key:function(){if(!n.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(n.attributes.METHOD==="NONE"){f=null;return}if(!n.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}n.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"});f={method:n.attributes.METHOD||"AES-128",uri:n.attributes.URI};typeof n.attributes.IV!="undefined"&&(f.iv=n.attributes.IV)},"media-sequence":function(){if(!isFinite(n.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+n.number});return}this.manifest.mediaSequence=n.number},"discontinuity-sequence":function(){if(!isFinite(n.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+n.number});return}this.manifest.discontinuitySequence=n.number;o=n.number},"playlist-type":function(){if(!/VOD|EVENT/.test(n.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+n.playlist});return}this.manifest.playlistType=n.playlistType},map:function(){u={};n.uri&&(u.uri=n.uri);n.byterange&&(u.byterange=n.byterange)},"stream-inf":function(){if(this.manifest.playlists=e,this.manifest.mediaGroups=this.manifest.mediaGroups||h,!n.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}i.attributes||(i.attributes={});pht(i.attributes,n.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||h,!(n.attributes&&n.attributes.TYPE&&n.attributes["GROUP-ID"]&&n.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var i=this.manifest.mediaGroups[n.attributes.TYPE];i[n.attributes["GROUP-ID"]]=i[n.attributes["GROUP-ID"]]||{};r=i[n.attributes["GROUP-ID"]];t={"default":/yes/i.test(n.attributes.DEFAULT)};t.autoselect=t["default"]?!0:/yes/i.test(n.attributes.AUTOSELECT);n.attributes.LANGUAGE&&(t.language=n.attributes.LANGUAGE);n.attributes.URI&&(t.uri=n.attributes.URI);n.attributes["INSTREAM-ID"]&&(t.instreamId=n.attributes["INSTREAM-ID"]);n.attributes.CHARACTERISTICS&&(t.characteristics=n.attributes.CHARACTERISTICS);n.attributes.FORCED&&(t.forced=/yes/i.test(n.attributes.FORCED));r[n.attributes.NAME]=t},discontinuity:function(){o+=1;i.discontinuity=!0;this.manifest.discontinuityStarts.push(e.length)},"program-date-time":function(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=n.dateTimeString,this.manifest.dateTimeObject=n.dateTimeObject);i.dateTimeString=n.dateTimeString;i.dateTimeObject=n.dateTimeObject},targetduration:function(){if(!isFinite(n.duration)||n.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+n.duration});return}this.manifest.targetDuration=n.duration},totalduration:function(){if(!isFinite(n.duration)||n.duration<0){this.trigger("warn",{message:"ignoring invalid total duration: "+n.duration});return}this.manifest.totalDuration=n.duration},start:function(){if(!n.attributes||isNaN(n.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:n.attributes["TIME-OFFSET"],precise:n.attributes.PRECISE}},"cue-out":function(){i.cueOut=n.data},"cue-out-cont":function(){i.cueOutCont=n.data},"cue-in":function(){i.cueIn=n.data}}[n.tagType]||c).call(s)},uri:function(){i.uri=n.uri;e.push(i);!this.manifest.targetDuration||"duration"in i||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),i.duration=this.manifest.targetDuration);f&&(i.key=f);i.timeline=o;u&&(i.map=u);i={}},comment:function(){},custom:function(){n.segment?(i.custom=i.custom||{},i.custom[n.customType]=n.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[n.customType]=n.data)}})[n.type].call(s)});return r}return uv(t,n),t.prototype.push=function(n){this.lineStream.push(n)},t.prototype.end=function(){this.lineStream.push("\n")},t.prototype.addParser=function(n){this.parseStream.addParser(n)},t}(ev);
/*! @name mpd-parser @version 0.7.0 @license Apache-2.0 */
var bg=function(n){return!!n&&typeof n=="object"},lt=function lt(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.reduce(function(n,t){return Object.keys(t).forEach(function(i){n[i]=Array.isArray(n[i])&&Array.isArray(t[i])?n[i].concat(t[i]):bg(n[i])&&bg(t[i])?lt(n[i],t[i]):t[i]}),n},{})},dht=function(n){return Object.keys(n).map(function(t){return n[t]})},ght=function(n,t){for(var r=[],i=n;i<t;i++)r.push(i);return r},nh=function(n){return n.reduce(function(n,t){return n.concat(t)},[])},kg=function(n){var i,t;if(!n.length)return[];for(i=[],t=0;t<n.length;t++)i.push(n[t]);return i},nct=function(n,t){return n.reduce(function(n,i,r){return i[t]&&n.push(r),n},[])},dg=function(n){var t=dht(n.reduce(function(n,t){var i=t.attributes.id+(t.attributes.lang||""),r;return n[i]?(t.segments[0].discontinuity=!0,(r=n[i].segments).push.apply(r,t.segments),t.attributes.contentProtection&&(n[i].attributes.contentProtection=t.attributes.contentProtection)):n[i]=t,n},{}));return t.map(function(n){return n.discontinuityStarts=nct(n.segments,"discontinuity"),n})},tct=function(n){var i,t=n.attributes,r=n.segments,u={attributes:(i={NAME:t.id,BANDWIDTH:t.bandwidth,CODECS:t.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:"",targetDuration:t.duration,segments:r,mediaSequence:r.length?r[0].number:1};return t.contentProtection&&(u.contentProtection=t.contentProtection),u},ict=function(n){var r,t=n.attributes,i=n.segments;return typeof i=="undefined"&&(i=[{uri:t.baseUrl,timeline:t.periodIndex,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration),{attributes:(r={NAME:t.id,BANDWIDTH:t.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:t.baseUrl||"",targetDuration:t.duration,segments:i,mediaSequence:i.length?i[0].number:1}},rct=function(n){return n.reduce(function(n,t){var r=t.attributes.role&&t.attributes.role.value||"main",u=t.attributes.lang||"",i="main";return(u&&(i=t.attributes.lang+" ("+r+")"),n[i]&&n[i].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth)?n:(n[i]={language:u,autoselect:!0,"default":r==="main",playlists:[tct(t)],uri:""},n)},{})},uct=function(n){return n.reduce(function(n,t){var i=t.attributes.lang||"text";return n[i]?n:(n[i]={language:i,"default":!1,autoselect:!1,playlists:[ict(t)],uri:""},n)},{})},fct=function(n){var i,t=n.attributes,r=n.segments,u={attributes:(i={NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:"",targetDuration:t.duration,segments:r,mediaSequence:r.length?r[0].number:1};return t.contentProtection&&(u.contentProtection=t.contentProtection),u},ect=function(n){var t;if(!n.length)return{};var r=n[0].attributes,o=r.sourceDuration,u=r.minimumUpdatePeriod,s=u===void 0?0:u,h=function(n){var t=n.attributes;return t.mimeType==="video/mp4"||t.contentType==="video"},c=function(n){var t=n.attributes;return t.mimeType==="audio/mp4"||t.contentType==="audio"},l=function(n){var t=n.attributes;return t.mimeType==="text/vtt"||t.contentType==="text"},a=dg(n.filter(h)).map(fct),f=dg(n.filter(c)),e=n.filter(l),i={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(t={AUDIO:{},VIDEO:{}},t["CLOSED-CAPTIONS"]={},t.SUBTITLES={},t),uri:"",duration:o,playlists:a,minimumUpdatePeriod:s*1e3};return f.length&&(i.mediaGroups.AUDIO.audio=rct(f)),e.length&&(i.mediaGroups.SUBTITLES.subs=uct(e)),i},oct=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};var gg=sct(function(n){(function(){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,u=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),i=i.trim(),!i){if(!u.alwaysNormalize)return n;if(s=t.parseURL(n),!s)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=t.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&e.path[0]!=="/"&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,f.path[0]!=="/"&&(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query))))),o.path===null&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parseURL:function(n){var t=i.exec(n);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t})(oct)}),ov=function(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=gg.buildAbsoluteURL(n.location.href,t)),gg.buildAbsoluteURL(t,i))},he=function(n){var t=n.baseUrl,h=t===void 0?"":t,i=n.source,r=i===void 0?"":i,u=n.range,f=u===void 0?"":u,e={uri:r,resolvedUri:ov(h||"",r)};if(f){var o=f.split("-"),s=parseInt(o[0],10),c=parseInt(o[1],10);e.byterange={length:c-s,offset:s}}return e},hct=function(n,t,i){var e=n.NOW,o=n.clientOffset,s=n.availabilityStartTime,r=n.timescale,h=r===void 0?1:r,u=n.start,c=u===void 0?0:u,f=n.minimumUpdatePeriod,l=f===void 0?0:f,a=(e+o)/1e3,v=s+c,y=a+l,p=y-v;return Math.ceil((p*h-t)/i)},nn=function(n,t){for(var o,c,d,s,l=n.type,g=l===void 0?"static":l,a=n.minimumUpdatePeriod,nt=a===void 0?0:a,v=n.media,tt=v===void 0?"":v,it=n.sourceDuration,y=n.timescale,p=y===void 0?1:y,w=n.startNumber,b=w===void 0?1:w,rt=n.periodIndex,u=[],i=-1,f=0;f<t.length;f++){var h=t[f],r=h.d,k=h.r||0,e=h.t||0;for(i<0&&(i=e),e&&e>i&&(i=e),o=void 0,k<0?(c=f+1,o=c===t.length?g==="dynamic"&&nt>0&&tt.indexOf("$Number$")>0?hct(n,i,r):(it*p-i)/r:(t[c].t-i)/r):o=k+1,d=b+u.length+o,s=b+u.length;s<d;)u.push({number:s,duration:r/p,time:i,timeline:rt}),i+=r,s++}return u},cct={static:function(n){var i=n.duration,t=n.timescale,r=t===void 0?1:t,u=n.sourceDuration;return{start:0,end:Math.ceil(u/(i/r))}},dynamic:function(n){var h=n.NOW,c=n.clientOffset,l=n.availabilityStartTime,f=n.timescale,t=f===void 0?1:f,i=n.duration,e=n.start,a=e===void 0?0:e,o=n.minimumUpdatePeriod,v=o===void 0?0:o,s=n.timeShiftBufferDepth,y=s===void 0?Infinity:s,r=(h+c)/1e3,u=l+a,p=r+v,w=p-u,b=Math.ceil(w*t/i),k=Math.floor((r-u-y)*t/i),d=Math.floor((r-u)*t/i);return{start:Math.max(0,k),end:Math.min(b,d)}}},lct=function(n){return function(t,i){var r=n.duration,u=n.timescale,e=u===void 0?1:u,o=n.periodIndex,f=n.startNumber,s=f===void 0?1:f;return{number:s+t,duration:r/e,timeline:o,time:i*r}}},sv=function(n){var r=n.type,u=r===void 0?"static":r,o=n.duration,f=n.timescale,s=f===void 0?1:f,h=n.sourceDuration,e=cct[u](n),c=e.start,l=e.end,t=ght(c,l).map(lct(n)),i;return u==="static"&&(i=t.length-1,t[i].duration=h-o/s*i),t},act=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,vct=function(n){return function(t,i,r,u){if(t==="$$")return"$";if(typeof n[i]=="undefined")return t;var f=""+n[i];return i==="RepresentationID"?f:(u=r?parseInt(u,10):1,f.length>=u)?f:""+new Array(u-f.length+1).join("0")+f}},tn=function(n,t){return n.replace(act,vct(t))},yct=function(n,t){return!n.duration&&!t?[{number:n.startNumber||1,duration:n.sourceDuration,time:0,timeline:n.periodIndex}]:n.duration?sv(n):nn(n,t)},pct=function(n,t){var i={RepresentationID:n.id,Bandwidth:n.bandwidth||0},r=n.initialization,u=r===void 0?{sourceURL:"",range:""}:r,f=he({baseUrl:n.baseUrl,source:tn(u.sourceURL,i),range:u.range}),e=yct(n,t);return e.map(function(t){i.Number=t.number;i.Time=t.time;var r=tn(n.media||"",i);return{uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:ov(n.baseUrl||"",r),map:f,number:t.number}})},wu={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},wct=function(n,t){var i=n.baseUrl,r=n.initialization,u=r===void 0?{}:r,e=he({baseUrl:i,source:u.sourceURL,range:u.range}),f=he({baseUrl:i,source:t.media,range:t.mediaRange});return f.map=e,f},bct=function(n,t){var i=n.duration,f=n.segmentUrls,e=f===void 0?[]:f,r,u;if(!i&&!t||i&&t)throw new Error(wu.SEGMENT_TIME_UNSPECIFIED);return r=e.map(function(t){return wct(n,t)}),i&&(u=sv(n)),t&&(u=nn(n,t)),u.map(function(n,t){if(r[t]){var i=r[t];return i.timeline=n.timeline,i.duration=n.duration,i.number=n.number,i}}).filter(function(n){return n})},kct=function(n){var i=n.baseUrl,u=n.initialization,f=u===void 0?{}:u,e=n.sourceDuration,o=n.timescale,c=o===void 0?1:o,s=n.indexRange,l=s===void 0?"":s,a=n.duration,h,t,r;if(!i)throw new Error(wu.NO_BASE_URL);return h=he({baseUrl:i,source:f.sourceURL,range:f.range}),t=he({baseUrl:i,source:i,range:l}),t.map=h,a?(r=sv(n),r.length&&(t.duration=r[0].duration,t.timeline=r[0].timeline)):e&&(t.duration=e/c,t.timeline=0),t.number=0,[t]},dct=function(n){var u=n.attributes,i=n.segmentInfo,t,r,f;if(i.template?(r=pct,t=lt(u,i.template)):i.base?(r=kct,t=lt(u,i.base)):i.list&&(r=bct,t=lt(u,i.list)),!r)return{attributes:u};if(f=r(t,i.timeline),t.duration){var e=t,s=e.duration,o=e.timescale,h=o===void 0?1:o;t.duration=s/h}else t.duration=f.length?f.reduce(function(n,t){return Math.max(n,Math.ceil(t.duration))},0):0;return{attributes:t,segments:f}},gct=function(n){return n.map(dct)},g=function(n,t){return kg(n.childNodes).filter(function(n){var i=n.tagName;return i===t})},rn=function(n){return n.textContent.trim()},ce=function(n){var i=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n);if(!i)return 0;var t=i.slice(1),r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5];return parseFloat(r||0)*31536e3+parseFloat(u||0)*2592e3+parseFloat(f||0)*86400+parseFloat(e||0)*3600+parseFloat(o||0)*60+parseFloat(s||0)},nlt=function(n){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n)&&(n+="Z"),Date.parse(n)},un={mediaPresentationDuration:function(n){return ce(n)},availabilityStartTime:function(n){return nlt(n)/1e3},minimumUpdatePeriod:function(n){return ce(n)},timeShiftBufferDepth:function(n){return ce(n)},start:function(n){return ce(n)},width:function(n){return parseInt(n,10)},height:function(n){return parseInt(n,10)},bandwidth:function(n){return parseInt(n,10)},startNumber:function(n){return parseInt(n,10)},timescale:function(n){return parseInt(n,10)},duration:function(n){var t=parseInt(n,10);return isNaN(t)?ce(n):t},d:function(n){return parseInt(n,10)},t:function(n){return parseInt(n,10)},r:function(n){return parseInt(n,10)},DEFAULT:function(n){return n}},ft=function(n){return(n&&n.attributes)?kg(n.attributes).reduce(function(n,t){var i=un[t.name]||un.DEFAULT;return n[t.name]=i(t.value),n},{}):{}};var ilt={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},th=function(n,t){return t.length?nh(n.map(function(n){return t.map(function(t){return ov(n,rn(t))})})):n},hv=function(n){var f=g(n,"SegmentTemplate")[0],i=g(n,"SegmentList")[0],c=i&&g(i,"SegmentURL").map(function(n){return lt({tag:"SegmentURL"},ft(n))}),e=g(n,"SegmentBase")[0],o=i||f,s=o&&g(o,"SegmentTimeline")[0],h=i||e||f,r=h&&g(h,"Initialization")[0],t=f&&ft(f),u;return t&&r?t.initialization=r&&ft(r):t&&t.initialization&&(t.initialization={sourceURL:t.initialization}),u={template:t,timeline:s&&g(s,"S").map(function(n){return ft(n)}),list:i&&lt(ft(i),{segmentUrls:c,initialization:ft(r)}),base:e&&lt(ft(e),{initialization:ft(r)})},Object.keys(u).forEach(function(n){u[n]||delete u[n]}),u},rlt=function(n,t,i){return function(r){var u=g(r,"BaseURL"),f=th(t,u),e=lt(n,ft(r)),o=hv(r);return f.map(function(n){return{segmentInfo:lt(i,o),attributes:lt(e,{baseUrl:n})}})}},ult=function(n){return n.reduce(function(n,t){var f=ft(t),i=ilt[f.schemeIdUri],r,u,e;return i&&(n[i]={attributes:f},r=g(t,"cenc:pssh")[0],r&&(u=rn(r),e=u&&tlt(u),n[i].pssh=e)),n},{})},flt=function(n,t,i){return function(r){var e=ft(r),o=th(t,g(r,"BaseURL")),s=g(r,"Role")[0],h={role:ft(s)},u=lt(n,e,h),f=ult(g(r,"ContentProtection"));Object.keys(f).length&&(u=lt(u,{contentProtection:f}));var c=hv(r),l=g(r,"Representation"),a=lt(i,c);return nh(l.map(rlt(u,o,a)))}},elt=function(t,i){return function(r,u){var e=th(i,g(r,"BaseURL")),o=ft(r),f=parseInt(o.id,10),s=n.isNaN(f)?u:f,h=lt(t,{periodIndex:s}),c=g(r,"AdaptationSet"),l=hv(r);return nh(c.map(flt(h,e,l)))}},olt=function(n,t){var i,s;t===void 0&&(t={});var r=t,u=r.manifestUri,h=u===void 0?"":u,f=r.NOW,c=f===void 0?Date.now():f,e=r.clientOffset,l=e===void 0?0:e,o=g(n,"Period");if(!o.length)throw new Error(wu.INVALID_NUMBER_OF_PERIOD);return i=ft(n),s=th([h],g(n,"BaseURL")),i.sourceDuration=i.mediaPresentationDuration||0,i.NOW=c,i.clientOffset=l,nh(o.map(elt(i,s)))},fn=function(t){if(t==="")throw new Error(wu.DASH_EMPTY_MANIFEST);var u=new n.DOMParser,r=u.parseFromString(t,"application/xml"),i=r&&r.documentElement.tagName==="MPD"?r.documentElement:null;if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(wu.DASH_INVALID_XML);return i},slt=function(n){var i=g(n,"UTCTiming")[0],t;if(!i)return null;t=ft(i);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT";t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(wu.UNSUPPORTED_UTC_TIMING_SCHEME);}return t},hlt=function(n,t){return ect(gct(olt(fn(n),t)))},clt=function(n){return slt(fn(n))},llt=function(n){return n>>>0},alt={toUnsigned:llt},bu=alt.toUnsigned,dt,ih,en,on,sn;dt=function(n,t){var r=[],i,f,o,u,e;if(!t.length)return null;for(i=0;i<n.byteLength;)f=bu(n[i]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),o=ih(n.subarray(i+4,i+8)),u=f>1?i+f:n.byteLength,o===t[0]&&(t.length===1?r.push(n.subarray(i+8,u)):(e=dt(n.subarray(i+8,u),t.slice(1)),e.length&&(r=r.concat(e)))),i=u;return r};ih=function(n){var t="";return t+=String.fromCharCode(n[0]),t+=String.fromCharCode(n[1]),t+=String.fromCharCode(n[2]),t+String.fromCharCode(n[3])};en=function(n){var t=dt(n,["moov","trak"]);return t.reduce(function(n,t){var r,f,i,e,u;return(r=dt(t,["tkhd"])[0],!r)?null:(f=r[0],i=f===0?12:20,e=bu(r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]),u=dt(t,["mdia","mdhd"])[0],!u)?null:(f=u[0],i=f===0?12:20,n[e]=bu(u[i]<<24|u[i+1]<<16|u[i+2]<<8|u[i+3]),n)},{})};on=function(n,t){var r,u,i;return r=dt(t,["moof","traf"]),u=[].concat.apply([],r.map(function(t){return dt(t,["tfhd"]).map(function(i){var u,f,r;return u=bu(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),f=n[u]||9e4,r=dt(t,["tfdt"]).map(function(n){var i,t;return i=n[0],t=bu(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i===1&&(t*=Math.pow(2,32),t+=bu(n[8]<<24|n[9]<<16|n[10]<<8|n[11])),t})[0],r=r||Infinity,r/f})})),i=Math.min.apply(null,u),isFinite(i)?i:0};sn=function(n){var i=dt(n,["moov","trak"]),t=[];return i.forEach(function(n){var i=dt(n,["mdia","hdlr"]),r=dt(n,["tkhd"]);i.forEach(function(n,i){var s=ih(n.subarray(8,12)),f=r[i],u,e,o;s==="vide"&&(u=new DataView(f.buffer,f.byteOffset,f.byteLength),e=u.getUint8(0),o=e===0?u.getUint32(12):u.getUint32(20),t.push(o))})}),t};gt={findBox:dt,parseType:ih,timescale:en,startTime:on,videoTrackIds:sn};cv=Math.pow(2,32)-1,function(){var n;if(s={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(n in s)s.hasOwnProperty(n)&&(s[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]);yv=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);ott=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);ett=new Uint8Array([0,0,0,1]);stt=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);htt=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ctt={video:stt,audio:htt};vtt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);att=new Uint8Array([0,0,0,0,0,0,0,0]);rh=new Uint8Array([0,0,0,0,0,0,0,0]);ytt=rh;ptt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);wtt=rh;ltt=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}();h=function(n){for(var r=[],u=0,i,f,t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)u+=r[t].byteLength;for(i=new Uint8Array(u+8),f=new DataView(i.buffer,i.byteOffset,i.byteLength),f.setUint32(0,i.byteLength),i.set(n,4),t=0,u=8;t<r.length;t++)i.set(r[t],u),u+=r[t].byteLength;return i};hn=function(){return h(s.dinf,h(s.dref,vtt))};cn=function(n){return h(s.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,n.audioobjecttype<<3|n.samplingfrequencyindex>>>1,n.samplingfrequencyindex<<7|n.channelcount<<3,6,1,2]))};lv=function(){return h(s.ftyp,yv,ett,yv,ott)};ntt=function(n){return h(s.hdlr,ctt[n])};ln=function(n){return h(s.mdat,n)};gn=function(n){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,n.duration>>>24&255,n.duration>>>16&255,n.duration>>>8&255,n.duration&255,85,196,0,0]);return n.samplerate&&(t[12]=n.samplerate>>>24&255,t[13]=n.samplerate>>>16&255,t[14]=n.samplerate>>>8&255,t[15]=n.samplerate&255),h(s.mdhd,t)};dn=function(n){return h(s.mdia,gn(n),ntt(n.type),vn(n))};an=function(n){return h(s.mfhd,new Uint8Array([0,0,0,0,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255]))};vn=function(n){return h(s.minf,n.type==="video"?h(s.vmhd,ltt):h(s.smhd,att),hn(),itt(n))};yn=function(n,t){for(var r=[],i=t.length;i--;)r[i]=utt(t[i]);return h.apply(null,[s.moof,an(n)].concat(r))};av=function(n){for(var t=n.length,i=[];t--;)i[t]=bn(n[t]);return h.apply(null,[s.moov,wn(4294967295)].concat(i).concat(pn(n)))};pn=function(n){for(var t=n.length,i=[];t--;)i[t]=ftt(n[t]);return h.apply(null,[s.mvex].concat(i))};wn=function(n){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h(s.mvhd,t)};ttt=function(n){for(var r=n.samples||[],u=new Uint8Array(4+r.length),i,t=0;t<r.length;t++)i=r[t].flags,u[t+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return h(s.sdtp,u)};itt=function(n){return h(s.stbl,rtt(n),h(s.stts,wtt),h(s.stsc,ytt),h(s.stsz,ptt),h(s.stco,rh))},function(){var n,t;rtt=function(i){return h(s.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),i.type==="video"?n(i):t(i))};n=function(n){for(var i=n.sps||[],r=n.pps||[],u=[],f=[],t=0;t<i.length;t++)u.push((i[t].byteLength&65280)>>>8),u.push(i[t].byteLength&255),u=u.concat(Array.prototype.slice.call(i[t]));for(t=0;t<r.length;t++)f.push((r[t].byteLength&65280)>>>8),f.push(r[t].byteLength&255),f=f.concat(Array.prototype.slice.call(r[t]));return h(s.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(n.width&65280)>>8,n.width&255,(n.height&65280)>>8,n.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h(s.avcC,new Uint8Array([1,n.profileIdc,n.profileCompatibility,n.levelIdc,255].concat([i.length]).concat(u).concat([r.length]).concat(f))),h(s.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};t=function(n){return h(s.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(n.channelcount&65280)>>8,n.channelcount&255,(n.samplesize&65280)>>8,n.samplesize&255,0,0,0,0,(n.samplerate&65280)>>8,n.samplerate&255,0,0]),cn(n))}}();kn=function(n){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,0,(n.duration&4278190080)>>24,(n.duration&16711680)>>16,(n.duration&65280)>>8,n.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(n.width&65280)>>8,n.width&255,0,0,(n.height&65280)>>8,n.height&255,0,0]);return h(s.tkhd,t)};utt=function(n){var u,f,r,e,o,t,i;return(u=h(s.tfhd,new Uint8Array([0,0,0,58,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),t=Math.floor(n.baseMediaDecodeTime/(cv+1)),i=Math.floor(n.baseMediaDecodeTime%(cv+1)),f=h(s.tfdt,new Uint8Array([1,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255])),o=92,n.type==="audio")?(r=vv(n,o),h(s.traf,u,f,r)):(e=ttt(n),r=vv(n,e.length+o),h(s.traf,u,f,r,e))};bn=function(n){return n.duration=n.duration||4294967295,h(s.trak,kn(n),dn(n))};ftt=function(n){var t=new Uint8Array([0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return n.type!=="video"&&(t[t.length-1]=0),h(s.trex,t)},function(){var t,i,n;n=function(n,t){var i=0,r=0,u=0,f=0;return n.length&&(n[0].duration!==undefined&&(i=1),n[0].size!==undefined&&(r=2),n[0].flags!==undefined&&(u=4),n[0].compositionTimeOffset!==undefined&&(f=8)),[0,0,i|r|u|f,1,(n.length&4278190080)>>>24,(n.length&16711680)>>>16,(n.length&65280)>>>8,n.length&255,(t&4278190080)>>>24,(t&16711680)>>>16,(t&65280)>>>8,t&255]};i=function(t,i){var f,u,r,e;for(u=t.samples||[],i+=20+16*u.length,f=n(u,i),e=0;e<u.length;e++)r=u[e],f=f.concat([(r.duration&4278190080)>>>24,(r.duration&16711680)>>>16,(r.duration&65280)>>>8,r.duration&255,(r.size&4278190080)>>>24,(r.size&16711680)>>>16,(r.size&65280)>>>8,r.size&255,r.flags.isLeading<<2|r.flags.dependsOn,r.flags.isDependedOn<<6|r.flags.hasRedundancy<<4|r.flags.paddingValue<<1|r.flags.isNonSyncSample,r.flags.degradationPriority&61440,r.flags.degradationPriority&15,(r.compositionTimeOffset&4278190080)>>>24,(r.compositionTimeOffset&16711680)>>>16,(r.compositionTimeOffset&65280)>>>8,r.compositionTimeOffset&255]);return h(s.trun,new Uint8Array(f))};t=function(t,i){var f,u,r,e;for(u=t.samples||[],i+=20+8*u.length,f=n(u,i),e=0;e<u.length;e++)r=u[e],f=f.concat([(r.duration&4278190080)>>>24,(r.duration&16711680)>>>16,(r.duration&65280)>>>8,r.duration&255,(r.size&4278190080)>>>24,(r.size&16711680)>>>16,(r.size&65280)>>>8,r.size&255]);return h(s.trun,new Uint8Array(f))};vv=function(n,r){return n.type==="audio"?t(n,r):i(n,r)}}();wr={ftyp:lv,mdat:ln,moof:yn,moov:av,initSegment:function(n){var i=lv(),r=av(n),t;return t=new Uint8Array(i.byteLength+r.byteLength),t.set(i),t.set(r,i.byteLength),t}};le=function(){this.init=function(){var n={};this.on=function(t,i){n[t]||(n[t]=[]);n[t]=n[t].concat(i)};this.off=function(t,i){var r;return n[t]?(r=n[t].indexOf(i),n[t]=n[t].slice(),n[t].splice(r,1),r>-1):!1};this.trigger=function(t){var r,i,u,f;if(r=n[t],r)if(arguments.length===2)for(u=r.length,i=0;i<u;++i)r[i].call(this,arguments[1]);else{for(f=[],i=arguments.length,i=1;i<arguments.length;++i)f.push(arguments[i]);for(u=r.length,i=0;i<u;++i)r[i].apply(this,f)}};this.dispose=function(){n={}}}};le.prototype.pipe=function(n){this.on("data",function(t){n.push(t)});this.on("done",function(t){n.flush(t)});return n};le.prototype.push=function(n){this.trigger("data",n)};le.prototype.flush=function(n){this.trigger("done",n)};var et=le,vlt=function(n){var u,i,t=[],r=[];for(t.byteLength=0,u=0;u<n.length;u++)i=n[u],i.nalUnitType==="access_unit_delimiter_rbsp"?(t.length&&(t.duration=i.dts-t.dts,r.push(t)),t=[i],t.byteLength=i.data.byteLength,t.pts=i.pts,t.dts=i.dts):(i.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(t.keyFrame=!0),t.duration=i.dts-t.dts,t.byteLength+=i.data.byteLength,t.push(i));return r.length&&(!t.duration||t.duration<=0)&&(t.duration=r[r.length-1].duration),r.push(t),r},ylt=function(n){var u,r,t=[],i=[];for(t.byteLength=0,t.nalCount=0,t.duration=0,t.pts=n[0].pts,t.dts=n[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=n[0].pts,i.dts=n[0].dts,u=0;u<n.length;u++)r=n[u],r.keyFrame?(t.length&&(i.push(t),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration),t=[r],t.nalCount=r.length,t.byteLength=r.byteLength,t.pts=r.pts,t.dts=r.dts,t.duration=r.duration):(t.duration+=r.duration,t.nalCount+=r.length,t.byteLength+=r.byteLength,t.push(r));return i.length&&t.duration<=0&&(t.duration=i[i.length-1].duration),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration,i.push(t),i},plt=function(n){var t;return!n[0][0].keyFrame&&n.length>1&&(t=n.shift(),n.byteLength-=t.byteLength,n.nalCount-=t.nalCount,n[0][0].dts=t.dts,n[0][0].pts=t.pts,n[0][0].duration+=t.duration),n},wlt=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},blt=function(n,t){var i=wlt();return i.dataOffset=t,i.compositionTimeOffset=n.pts-n.dts,i.duration=n.duration,i.size=4*n.length,i.size+=n.byteLength,n.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},klt=function(n,t){for(var r,u,f,e,o=t||0,s=[],i=0;i<n.length;i++)for(f=n[i],r=0;r<f.length;r++)e=f[r],u=blt(e,o),o+=u.size,s.push(u);return s},dlt=function(n){for(var i,r,e,o,u,f=0,h=n.byteLength,c=n.nalCount,l=h+4*c,s=new Uint8Array(l),a=new DataView(s.buffer),t=0;t<n.length;t++)for(e=n[t],i=0;i<e.length;i++)for(o=e[i],r=0;r<o.length;r++)u=o[r],a.setUint32(f,u.data.byteLength),f+=4,s.set(u.data,f),f+=u.data.byteLength;return s},ae={groupNalsIntoFrames:vlt,groupFramesIntoGops:ylt,extendFirstKeyFrame:plt,generateSampleTable:klt,concatenateNalData:dlt},glt=9e4,nat=function(n,t){typeof t.pts=="number"&&(n.timelineStartInfo.pts===undefined&&(n.timelineStartInfo.pts=t.pts),n.minSegmentPts=n.minSegmentPts===undefined?t.pts:Math.min(n.minSegmentPts,t.pts),n.maxSegmentPts=n.maxSegmentPts===undefined?t.pts:Math.max(n.maxSegmentPts,t.pts));typeof t.dts=="number"&&(n.timelineStartInfo.dts===undefined&&(n.timelineStartInfo.dts=t.dts),n.minSegmentDts=n.minSegmentDts===undefined?t.dts:Math.min(n.minSegmentDts,t.dts),n.maxSegmentDts=n.maxSegmentDts===undefined?t.dts:Math.max(n.maxSegmentDts,t.dts))},tat=function(n){delete n.minSegmentDts;delete n.maxSegmentDts;delete n.minSegmentPts;delete n.maxSegmentPts},iat=function(n,t){var i,r,u=n.minSegmentDts;return t||(u-=n.timelineStartInfo.dts),i=n.timelineStartInfo.baseMediaDecodeTime,i+=u,i=Math.max(0,i),n.type==="audio"&&(r=n.samplerate/glt,i*=r,i=Math.floor(i)),i},hi={clearDtsInfo:tat,calculateTrackBaseMediaDecodeTime:iat,collectDtsInfo:nat},btt=4,rat=128,uat=function(n){for(var t=0,r={payloadType:-1,payloadSize:0},u=0,i=0;t<n.byteLength;){if(n[t]===rat)break;while(n[t]===255)u+=255,t++;for(u+=n[t++];n[t]===255;)i+=255,t++;if(i+=n[t++],!r.payload&&u===btt){r.payloadType=u;r.payloadSize=i;r.payload=n.subarray(t,t+i);break}t+=i;u=0;i=0}return r},fat=function(n){return n.payload[0]!==181?null:(n.payload[1]<<8|n.payload[2])!=49?null:String.fromCharCode(n.payload[3],n.payload[4],n.payload[5],n.payload[6])!=="GA94"?null:n.payload[7]!==3?null:n.payload.subarray(8,n.payload.length-1)},eat=function(n,t){var u=[],r,e,i,f;if(!(t[0]&64))return u;for(e=t[0]&31,r=0;r<e;r++)i=r*3,f={type:t[i+2]&3,pts:n},t[i+2]&4&&(f.ccData=t[i+3]<<8|t[i+4],u.push(f));return u},oat=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f},ve={parseSei:uat,parseUserData:fat,parseCaptionPackets:eat,discardEmulationPreventionBytes:oat,USER_DATA_REGISTERED_ITU_T_T35:btt},yi=function yi(){yi.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new w(0,0),new w(0,1),new w(1,0),new w(1,1)];this.reset();this.ccStreams_.forEach(function(n){n.on("data",this.trigger.bind(this,"data"));n.on("done",this.trigger.bind(this,"done"))},this)};yi.prototype=new et;yi.prototype.push=function(n){var t,i,r;if(n.nalUnitType==="sei_rbsp"&&(t=ve.parseSei(n.escapedRBSP),t.payloadType===ve.USER_DATA_REGISTERED_ITU_T_T35)&&(i=ve.parseUserData(t),i)){if(n.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}if(n.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}r=ve.parseCaptionPackets(n.pts,i);this.captionPackets_=this.captionPackets_.concat(r);this.latestDts_!==n.dts&&(this.numSameDts_=0);this.numSameDts_++;this.latestDts_=n.dts}};yi.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(n){n.flush()},this);return}this.captionPackets_.forEach(function(n,t){n.presortIndex=t});this.captionPackets_.sort(function(n,t){return n.pts===t.pts?n.presortIndex-t.presortIndex:n.pts-t.pts});this.captionPackets_.forEach(function(n){n.type<2&&this.dispatchCea608Packet(n)},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(n){n.flush()},this);return};yi.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(n){n.reset()})};yi.prototype.dispatchCea608Packet=function(n){(this.setsChannel1Active(n)?this.activeCea608Channel_[n.type]=0:this.setsChannel2Active(n)&&(this.activeCea608Channel_[n.type]=1),this.activeCea608Channel_[n.type]!==null)&&this.ccStreams_[(n.type<<1)+this.activeCea608Channel_[n.type]].push(n)};yi.prototype.setsChannel1Active=function(n){return(n.ccData&30720)==4096};yi.prototype.setsChannel2Active=function(n){return(n.ccData&30720)==6144};var sat={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},uh=function(n){return n===null?"":(n=sat[n]||n,String.fromCharCode(n))},fh=14,hat=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],br=function(){for(var n=[],t=fh+1;t--;)n.push("");return n},w=function w(n,t){w.prototype.init.call(this);this.field_=n||0;this.dataChannel_=t||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(n){var t,e,r,i,u,f;if(t=n.ccData&32639,t===this.lastControlCode_){this.lastControlCode_=null;return}((t&61440)==4096?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=t&255,t!==this.PADDING_)&&(t===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":t===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(n.pts),this.flushDisplayed(n.pts),e=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=e,this.startPts_=n.pts):t===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(n.pts)):t===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(n.pts)):t===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(n.pts)):t===this.CARRIAGE_RETURN_?(this.clearFormatting(n.pts),this.flushDisplayed(n.pts),this.shiftRowsUp_(),this.startPts_=n.pts):t===this.BACKSPACE_?this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):t===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(n.pts),this.displayed_=br()):t===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=br():t===this.RESUME_DIRECT_CAPTIONING_?(this.mode_!=="paintOn"&&(this.flushDisplayed(n.pts),this.displayed_=br()),this.mode_="paintOn",this.startPts_=n.pts):this.isSpecialCharacter(r,i)?(r=(r&3)<<8,u=uh(r|i),this[this.mode_](n.pts,u),this.column_++):this.isExtCharacter(r,i)?(this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),r=(r&3)<<8,u=uh(r|i),this[this.mode_](n.pts,u),this.column_++):this.isMidRowCode(r,i)?(this.clearFormatting(n.pts),this[this.mode_](n.pts," "),this.column_++,(i&14)==14&&this.addFormatting(n.pts,["i"]),(i&1)==1&&this.addFormatting(n.pts,["u"])):this.isOffsetControlCode(r,i)?this.column_+=i&3:this.isPAC(r,i)?(f=hat.indexOf(t&7968),this.mode_==="rollUp"&&this.setRollUp(n.pts,f),f!==this.row_&&(this.clearFormatting(n.pts),this.row_=f),i&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(n.pts,["u"]),(t&16)==16&&(this.column_=((t&14)>>1)*4),this.isColorPAC(i)&&(i&14)==14&&this.addFormatting(n.pts,["i"])):this.isNormalChar(r)&&(i===0&&(i=null),u=uh(r),u+=uh(i),this[this.mode_](n.pts,u),this.column_+=u.length))}};w.prototype=new et;w.prototype.flushDisplayed=function(n){var t=this.displayed_.map(function(n){return n.trim()}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:n,text:t,stream:this.name_})};w.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=br();this.nonDisplayed_=br();this.lastControlCode_=null;this.column_=0;this.row_=fh;this.rollUpRows_=2;this.formatting_=[]};w.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31);this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};w.prototype.isSpecialCharacter=function(n,t){return n===this.EXT_&&t>=48&&t<=63};w.prototype.isExtCharacter=function(n,t){return(n===this.EXT_+1||n===this.EXT_+2)&&t>=32&&t<=63};w.prototype.isMidRowCode=function(n,t){return n===this.EXT_&&t>=32&&t<=47};w.prototype.isOffsetControlCode=function(n,t){return n===this.OFFSET_&&t>=33&&t<=35};w.prototype.isPAC=function(n,t){return n>=this.BASE_&&n<this.BASE_+8&&t>=64&&t<=127};w.prototype.isColorPAC=function(n){return n>=64&&n<=79||n>=96&&n<=127};w.prototype.isNormalChar=function(n){return n>=32&&n<=127};w.prototype.setRollUp=function(n,t){if(this.mode_!=="rollUp"&&(this.row_=fh,this.mode_="rollUp",this.flushDisplayed(n),this.nonDisplayed_=br(),this.displayed_=br()),t!==undefined&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";t===undefined&&(t=this.row_);this.topRow_=t-this.rollUpRows_+1};w.prototype.addFormatting=function(n,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(n,t){return n+"<"+t+">"},"");this[this.mode_](n,i)};w.prototype.clearFormatting=function(n){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(n,t){return n+"<\/"+t+">"},"");this.formatting_=[];this[this.mode_](n,t)}};w.prototype.popOn=function(n,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};w.prototype.rollUp=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};w.prototype.shiftRowsUp_=function(){for(var n=0;n<this.topRow_;n++)this.displayed_[n]="";for(n=this.row_+1;n<fh+1;n++)this.displayed_[n]="";for(n=this.topRow_;n<this.row_;n++)this.displayed_[n]=this.displayed_[n+1];this.displayed_[this.row_]=""};w.prototype.paintOn=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var pv={CaptionStream:yi,Cea608Stream:w},nt={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},cat=8589934592,lat=4294967296,wv=function(n,t){var i=1;for(n>t&&(i=-1);Math.abs(t-n)>lat;)n+=i*cat;return n},bv=function bv(n){var i,t;bv.prototype.init.call(this);this.type_=n;this.push=function(n){n.type===this.type_&&(t===undefined&&(t=n.dts),n.dts=wv(n.dts,t),n.pts=wv(n.pts,t),i=n.dts,this.trigger("data",n))};this.flush=function(){t=i;this.trigger("done")};this.discontinuity=function(){t=void 0;i=void 0}};bv.prototype=new et;var ktt={TimestampRolloverStream:bv,handleRollover:wv},dtt=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},eh=function(n,t,i){return decodeURIComponent(dtt(n,t,i))},aat=function(n,t,i){return unescape(dtt(n,t,i))},oh=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},gtt={TXXX:function(n){var t;if(n.data[0]===3){for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=eh(n.data,1,t);n.value=eh(n.data,t+1,n.data.length).replace(/\0*$/,"");break}n.data=n.value}},WXXX:function(n){var t;if(n.data[0]===3)for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=eh(n.data,1,t);n.url=eh(n.data,t+1,n.data.length);break}},PRIV:function(n){for(var t=0;t<n.data.length;t++)if(n.data[t]===0){n.owner=aat(n.data,0,t);break}n.privateData=n.data.subarray(t+1);n.data=n.privateData}},sh;sh=function(n){var r={debug:!!(n&&n.debug),descriptor:n&&n.descriptor},i=0,t=[],u=0,f;if(sh.prototype.init.call(this),this.dispatchType=nt.METADATA_STREAM_TYPE.toString(16),r.descriptor)for(f=0;f<r.descriptor.length;f++)this.dispatchType+=("00"+r.descriptor[f].toString(16)).slice(-2);this.push=function(n){var f,e,c,o,h,a,s,l;if(n.type==="timed-metadata"){if(n.dataAlignmentIndicator&&(u=0,t.length=0),t.length===0&&(n.data.length<10||n.data[0]!=="I".charCodeAt(0)||n.data[1]!=="D".charCodeAt(0)||n.data[2]!=="3".charCodeAt(0))){r.debug&&console.log("Skipping unrecognized metadata packet");return}if(t.push(n),u+=n.data.byteLength,t.length===1&&(i=oh(n.data.subarray(6,10))+10),!(u<i)){for(f={data:new Uint8Array(i),frames:[],pts:t[0].pts,dts:t[0].dts},h=0;h<i;)f.data.set(t[0].data.subarray(0,i-h),h),h+=t[0].data.byteLength,u-=t[0].data.byteLength,t.shift();e=10;f.data[5]&64&&(e+=4,e+=oh(f.data.subarray(10,14)),i-=oh(f.data.subarray(16,20)));do{if(c=oh(f.data.subarray(e+4,e+8)),c<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");a=String.fromCharCode(f.data[e],f.data[e+1],f.data[e+2],f.data[e+3]);o={id:a,data:f.data.subarray(e+10,e+c+10)};o.key=o.id;gtt[o.id]&&(gtt[o.id](o),o.owner==="com.apple.streaming.transportStreamTimestamp"&&(s=o.data,l=(s[3]&1)<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2,l*=4,l+=s[7]&3,o.timeStamp=l,f.pts===undefined&&f.dts===undefined&&(f.pts=o.timeStamp,f.dts=o.timeStamp),this.trigger("timestamp",o)));f.frames.push(o);e+=10;e+=c}while(e<i);this.trigger("data",f)}}}};sh.prototype=new et;var vat=sh,yat=ktt.TimestampRolloverStream,hh,ye,ch,ku=188,kv=71;hh=function(){var t=new Uint8Array(ku),n=0;hh.prototype.init.call(this);this.push=function(i){var u=0,f=ku,r;for(n?(r=new Uint8Array(i.byteLength+n),r.set(t.subarray(0,n)),r.set(i,n),n=0):r=i;f<r.byteLength;){if(r[u]===kv&&r[f]===kv){this.trigger("data",r.subarray(u,f));u+=ku;f+=ku;continue}u++;f++}u<r.byteLength&&(t.set(r.subarray(u),0),n=r.byteLength-u)};this.flush=function(){n===ku&&t[0]===kv&&(this.trigger("data",t),n=0);this.trigger("done")}};hh.prototype=new et;ye=function(){var t,i,r,n;ye.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function(n,t){var u=0;t.payloadUnitStartIndicator&&(u+=n[u]+1);t.type==="pat"?i(n.subarray(u),t):r(n.subarray(u),t)};i=function(t,i){i.section_number=t[7];i.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];i.pmtPid=n.pmtPid};r=function(t,i){var e,o,s,r,u,f;if(t[5]&1){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},e=(t[1]&15)<<8|t[2],o=3+e-4,s=(t[10]&15)<<8|t[11],r=12+s;r<o;)u=t[r],f=(t[r+1]&31)<<8|t[r+2],u===nt.H264_STREAM_TYPE&&n.programMapTable.video===null?n.programMapTable.video=f:u===nt.ADTS_STREAM_TYPE&&n.programMapTable.audio===null?n.programMapTable.audio=f:u===nt.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][f]=u),r+=((t[r+3]&15)<<8|t[r+4])+5;i.programMapTable=n.programMapTable}};this.push=function(n){var i={},r=4;if(i.payloadUnitStartIndicator=!!(n[1]&64),i.pid=n[1]&31,i.pid<<=8,i.pid|=n[2],(n[3]&48)>>>4>1&&(r+=n[r]+1),i.pid===0)i.type="pat",t(n.subarray(r),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",t(n.subarray(r),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===undefined?this.packetsWaitingForPmt.push([n,r,i]):this.processPes_(n,r,i)};this.processPes_=function(n,t,i){i.streamType=i.pid===this.programMapTable.video?nt.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?nt.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid];i.type="pes";i.data=n.subarray(t);this.trigger("data",i)}};ye.prototype=new et;ye.STREAM_TYPES={h264:27,adts:15};ch=function(){var t=this,i={data:[],size:0},r={data:[],size:0},u={data:[],size:0},f=function(n,t){var i;t.packetLength=6+(n[4]<<8|n[5]);t.dataAlignmentIndicator=(n[6]&4)!=0;i=n[7];i&192&&(t.pts=(n[9]&14)<<27|(n[10]&255)<<20|(n[11]&254)<<12|(n[12]&255)<<5|(n[13]&254)>>>3,t.pts*=4,t.pts+=(n[13]&6)>>>1,t.dts=t.pts,i&64&&(t.dts=(n[14]&14)<<27|(n[15]&255)<<20|(n[16]&254)<<12|(n[17]&255)<<5|(n[18]&254)>>>3,t.dts*=4,t.dts+=(n[18]&6)>>>1));t.data=n.subarray(9+n[8])},n=function(n,i,r){var h=new Uint8Array(n.size),u={type:i},e=0,c=0,o=!1,s;if(n.data.length&&!(n.size<9)){for(u.trackId=n.data[0].pid,e=0;e<n.data.length;e++)s=n.data[e],h.set(s.data,c),c+=s.data.byteLength;f(h,u);o=i==="video"||u.packetLength<=n.size;(r||o)&&(n.size=0,n.data.length=0);o&&t.trigger("data",u)}};ch.prototype.init.call(this);this.push=function(f){({pat:function(){},pes:function(){var t,e;switch(f.streamType){case nt.H264_STREAM_TYPE:case nt.H264_STREAM_TYPE:t=i;e="video";break;case nt.ADTS_STREAM_TYPE:t=r;e="audio";break;case nt.METADATA_STREAM_TYPE:t=u;e="timed-metadata";break;default:return}f.payloadUnitStartIndicator&&n(t,e,!0);t.data.push(f);t.size+=f.data.byteLength},pmt:function(){var i={type:"metadata",tracks:[]},n=f.programMapTable;n.video!==null&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"});n.audio!==null&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"});t.trigger("data",i)}})[f.type]()};this.flush=function(){n(i,"video");n(r,"audio");n(u,"timed-metadata");this.trigger("done")}};ch.prototype=new et;dv={PAT_PID:0,MP2T_PACKET_LENGTH:ku,TransportPacketStream:hh,TransportParseStream:ye,ElementaryStream:ch,TimestampRolloverStream:yat,CaptionStream:pv.CaptionStream,Cea608Stream:pv.Cea608Stream,MetadataStream:vat};for(lh in nt)nt.hasOwnProperty(lh)&&(dv[lh]=nt[lh]);ni=dv;gv=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];ah=function(){var n;ah.prototype.init.call(this);this.push=function(t){var i=0,f=0,s,h,r,u,e,o;if(t.type==="audio")for(n?(u=n,n=new Uint8Array(u.byteLength+t.data.byteLength),n.set(u),n.set(t.data,u.byteLength)):n=t.data;i+5<n.length;){if(n[i]!==255||(n[i+1]&246)!=240){i++;continue}if(h=(~n[i+1]&1)*2,s=(n[i+3]&3)<<11|n[i+4]<<3|(n[i+5]&224)>>5,e=((n[i+6]&3)+1)*1024,o=e*9e4/gv[(n[i+2]&60)>>>2],r=i+s,n.byteLength<r)return;if(this.trigger("data",{pts:t.pts+f*o,dts:t.dts+f*o,sampleCount:e,audioobjecttype:(n[i+2]>>>6&3)+1,channelcount:(n[i+2]&1)<<2|(n[i+3]&192)>>>6,samplerate:gv[(n[i+2]&60)>>>2],samplingfrequencyindex:(n[i+2]&60)>>>2,samplesize:16,data:n.subarray(i+7+h,r)}),n.byteLength===r){n=undefined;return}f++;n=n.subarray(r)}};this.flush=function(){this.trigger("done")}};ah.prototype=new et;ny=ah;nit=function(n){var i=n.byteLength,r=0,t=0;this.length=function(){return 8*i};this.bitsAvailable=function(){return 8*i+t};this.loadWord=function(){var f=n.byteLength-i,e=new Uint8Array(4),u=Math.min(4,i);if(u===0)throw new Error("no bytes available");e.set(n.subarray(f,f+u));r=new DataView(e.buffer).getUint32(0);t=u*8;i-=u};this.skipBits=function(n){var u;t>n?(r<<=n,t-=n):(n-=t,u=Math.floor(n/8),n-=u*8,i-=u,this.loadWord(),r<<=n,t-=n)};this.readBits=function(n){var u=Math.min(t,n),f=r>>>32-u;return(t-=u,t>0?r<<=u:i>0&&this.loadWord(),u=n-u,u>0)?f<<u|this.readBits(u):f};this.skipLeadingZeros=function(){for(var n=0;n<t;++n)if((r&2147483648>>>n)!=0)return r<<=n,t-=n,n;return this.loadWord(),n+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var n=this.skipLeadingZeros();return this.readBits(n+1)-1};this.readExpGolomb=function(){var n=this.readUnsignedExpGolomb();return 1&n?1+n>>>1:-1*(n>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};tit=nit;pe=function(){var i=0,t,n;pe.prototype.init.call(this);this.push=function(r){var u;for(n?(u=new Uint8Array(n.byteLength+r.data.byteLength),u.set(n),u.set(r.data,n.byteLength),n=u):n=r.data;i<n.byteLength-3;i++)if(n[i+2]===1){t=i+5;break}while(t<n.byteLength)switch(n[t]){case 0:if(n[t-1]!==0){t+=2;break}else if(n[t-2]!==0){t++;break}i+3!==t-2&&this.trigger("data",n.subarray(i+3,t-2));do t++;while(n[t]!==1&&t<n.length);i=t-2;t+=3;break;case 1:if(n[t-1]!==0||n[t-2]!==0){t+=3;break}this.trigger("data",n.subarray(i+3,t-2));i=t-2;t+=3;break;default:t+=3}n=n.subarray(i);t-=i;i=0};this.flush=function(){n&&n.byteLength>3&&this.trigger("data",n.subarray(i+3));n=null;i=0;this.trigger("done")}};pe.prototype=new et;iit={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};vh=function(){var n=new pe,t,u,f,e,i,o,r;vh.prototype.init.call(this);t=this;this.push=function(t){t.type==="video"&&(u=t.trackId,f=t.pts,e=t.dts,n.push(t))};n.on("data",function(n){var r={trackId:u,pts:f,dts:e,data:n};switch(n[0]&31){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp";r.escapedRBSP=i(n.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp";r.escapedRBSP=i(n.subarray(1));r.config=o(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",r)});n.on("done",function(){t.trigger("done")});this.flush=function(){n.flush()};r=function(n,t){for(var r=8,i=8,f,u=0;u<n;u++)i!==0&&(f=t.readExpGolomb(),i=(r+f+256)%256),r=i===0?r:i};i=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f};o=function(n){var h=0,c=0,l=0,a=0,v=1,t,f,y,p,e,o,w,b,k,s,d,i,g,u;if(t=new tit(n),f=t.readUnsignedByte(),p=t.readUnsignedByte(),y=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),iit[f]&&(e=t.readUnsignedExpGolomb(),e===3&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=e!==3?8:12,u=0;u<d;u++)t.readBoolean()&&(u<6?r(16,t):r(64,t));if(t.skipUnsignedExpGolomb(),o=t.readUnsignedExpGolomb(),o===0)t.readUnsignedExpGolomb();else if(o===1)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),w=t.readUnsignedExpGolomb(),u=0;u<w;u++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),b=t.readUnsignedExpGolomb(),k=t.readUnsignedExpGolomb(),s=t.readBits(1),s===0&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(h=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),l=t.readUnsignedExpGolomb(),a=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){g=t.readUnsignedByte();switch(g){case 1:i=[1,1];break;case 2:i=[12,11];break;case 3:i=[10,11];break;case 4:i=[16,11];break;case 5:i=[40,33];break;case 6:i=[24,11];break;case 7:i=[20,11];break;case 8:i=[32,11];break;case 9:i=[80,33];break;case 10:i=[18,11];break;case 11:i=[15,11];break;case 12:i=[64,33];break;case 13:i=[160,99];break;case 14:i=[4,3];break;case 15:i=[3,2];break;case 16:i=[2,1];break;case 255:i=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}i&&(v=i[0]/i[1])}return{profileIdc:f,levelIdc:y,profileCompatibility:p,width:Math.ceil(((b+1)*16-h*2-c*2)*v),height:(2-s)*(k+1)*16-l*2-a*2}}};vh.prototype=new et;rit={H264Stream:vh,NalByteStream:pe};yh=function(){var n=new Uint8Array,t=0;yh.prototype.init.call(this);this.setTimestamp=function(n){t=n};this.parseId3TagSize=function(n,t){var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],r=n[t+5],u=(r&16)>>4;return u?i+20:i+10};this.parseAdtsSize=function(n,t){var i=(n[t+5]&224)>>5,r=n[t+4]<<3,u=n[t+3]&6144;return u|r|i};this.push=function(i){var u=0,r=0,e,o,s,f;for(n.length?(f=n.length,n=new Uint8Array(i.byteLength+f),n.set(n.subarray(0,f)),n.set(i,f)):n=i;n.length-r>=3;){if(n[r]==="I".charCodeAt(0)&&n[r+1]==="D".charCodeAt(0)&&n[r+2]==="3".charCodeAt(0)){if(n.length-r<10)break;if(u=this.parseId3TagSize(n,r),u>n.length)break;o={type:"timed-metadata",data:n.subarray(r,r+u)};this.trigger("data",o);r+=u;continue}else if(n[r]&!0&&(n[r+1]&240)==240){if(n.length-r<7)break;if(u=this.parseAdtsSize(n,r),u>n.length)break;s={type:"audio",data:n.subarray(r,r+u),pts:t,dts:t};this.trigger("data",s);r+=u;continue}r++}e=n.length-r;n=e>0?n.subarray(r):new Uint8Array}};yh.prototype=new et;var pat=yh,tr=[33,16,5,32,164,27],ty=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],l=function(n){for(var t=[];n--;)t.push(0);return t},wat=function(n){return Object.keys(n).reduce(function(t,i){return t[i]=new Uint8Array(n[i].reduce(function(n,t){return n.concat(t)},[])),t},{})},bat={96e3:[tr,[227,64],l(154),[56]],88200:[tr,[231],l(170),[56]],64e3:[tr,[248,192],l(240),[56]],48e3:[tr,[255,192],l(268),[55,148,128],l(54),[112]],44100:[tr,[255,192],l(268),[55,163,128],l(84),[112]],32e3:[tr,[255,192],l(268),[55,234],l(226),[112]],24e3:[tr,[255,192],l(268),[55,255,128],l(268),[111,112],l(126),[224]],16e3:[tr,[255,192],l(268),[55,255,128],l(268),[111,255],l(269),[223,108],l(195),[1,192]],12e3:[ty,l(268),[3,127,248],l(268),[6,255,240],l(268),[13,255,224],l(268),[27,253,128],l(259),[56]],11025:[ty,l(268),[3,127,248],l(268),[6,255,240],l(268),[13,255,224],l(268),[27,255,192],l(268),[55,175,128],l(108),[112]],8e3:[ty,l(268),[3,121,16],l(47),[7]]},kat=wat(bat),uit=9e4,iy,ry,uy,fy,fit,eit;iy=function(n){return n*uit};ry=function(n,t){return n*t};uy=function(n){return n/uit};fy=function(n,t){return n/t};fit=function(n,t){return iy(fy(n,t))};eit=function(n,t){return ry(uy(n),t)};var oit={secondsToVideoTs:iy,secondsToAudioTs:ry,videoTsToSeconds:uy,audioTsToSeconds:fy,audioTsToVideoTs:fit,videoTsToAudioTs:eit},dat=rit.H264Stream,ey=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],oy=["width","height","profileIdc","levelIdc","profileCompatibility"],sit=9e4,we,du,ph,gu,hit,sy,cit;hit=function(n){return n[0]==="I".charCodeAt(0)&&n[1]==="D".charCodeAt(0)&&n[2]==="3".charCodeAt(0)?!0:!1};sy=function(n,t){var i;if(n.length!==t.length)return!1;for(i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0};cit=function(n){for(var i,r=0,t=0;t<n.length;t++)i=n[t],r+=i.data.byteLength;return r};du=function(n,t){var i=[],e=0,r=0,u=0,f=Infinity;t=t||{};du.prototype.init.call(this);this.push=function(t){hi.collectDtsInfo(n,t);n&&ey.forEach(function(i){n[i]=t[i]});i.push(t)};this.setEarliestDts=function(t){r=t-n.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(n){f=n};this.setAudioAppendStart=function(n){u=n};this.flush=function(){var r,u,o,f;if(i.length===0){this.trigger("done","AudioSegmentStream");return}r=this.trimAdtsFramesByEarliestDts_(i);n.baseMediaDecodeTime=hi.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);this.prefixWithSilence_(n,r);n.samples=this.generateSampleTable_(r);o=wr.mdat(this.concatenateFrameData_(r));i=[];u=wr.moof(e,[n]);f=new Uint8Array(u.byteLength+o.byteLength);e++;f.set(u);f.set(o,u.byteLength);hi.clearDtsInfo(n);this.trigger("data",{track:n,boxes:f});this.trigger("done","AudioSegmentStream")};this.prefixWithSilence_=function(n,t){var h,o=0,c=0,i=0,s=0,r,e;if(t.length&&(h=oit.audioTsToVideoTs(n.baseMediaDecodeTime,n.samplerate),o=Math.ceil(sit/(n.samplerate/1024)),u&&f&&(c=h-Math.max(u,f),i=Math.floor(c/o),s=i*o),!(i<1)&&!(s>sit/2))){for(r=kat[n.samplerate],r||(r=t[0].data),e=0;e<i;e++)t.splice(e,0,{data:r});n.baseMediaDecodeTime-=Math.floor(oit.videoTsToAudioTs(s,n.samplerate))}};this.trimAdtsFramesByEarliestDts_=function(t){return n.minSegmentDts>=r?t:(n.minSegmentDts=Infinity,t.filter(function(t){return t.dts>=r?(n.minSegmentDts=Math.min(n.minSegmentDts,t.dts),n.minSegmentPts=n.minSegmentDts,!0):!1}))};this.generateSampleTable_=function(n){for(var i,r=[],t=0;t<n.length;t++)i=n[t],r.push({size:i.data.byteLength,duration:1024});return r};this.concatenateFrameData_=function(n){for(var i,r=0,u=new Uint8Array(cit(n)),t=0;t<n.length;t++)i=n[t],u.set(i.data,r),r+=i.data.byteLength;return u}};du.prototype=new et;we=function(n,t){var e=0,i=[],r=[],u,f;t=t||{};we.prototype.init.call(this);delete n.minPTS;this.gopCache_=[];this.push=function(t){hi.collectDtsInfo(n,t);t.nalUnitType!=="seq_parameter_set_rbsp"||u||(u=t.config,n.sps=[t.data],oy.forEach(function(t){n[t]=u[t]},this));t.nalUnitType!=="pic_parameter_set_rbsp"||f||(f=t.data,n.pps=[t.data]);i.push(t)};this.flush=function(){for(var l,f,u,o,h,s,c;i.length;){if(i[0].nalUnitType==="access_unit_delimiter_rbsp")break;i.shift()}if(i.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}if(l=ae.groupNalsIntoFrames(i),u=ae.groupFramesIntoGops(l),u[0][0].keyFrame||(f=this.getGopForFusion_(i[0],n),f?(u.unshift(f),u.byteLength+=f.byteLength,u.nalCount+=f.nalCount,u.pts=f.pts,u.dts=f.dts,u.duration+=f.duration):u=ae.extendFirstKeyFrame(u)),r.length){if(c=t.alignGopsAtEnd?this.alignGopsAtEnd_(u):this.alignGopsAtStart_(u),!c){this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}hi.clearDtsInfo(n);u=c}hi.collectDtsInfo(n,u);n.samples=ae.generateSampleTable(u);h=wr.mdat(ae.concatenateNalData(u));n.baseMediaDecodeTime=hi.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",u.map(function(n){return{pts:n.pts,dts:n.dts,byteLength:n.byteLength}}));this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.trigger("baseMediaDecodeTime",n.baseMediaDecodeTime);this.trigger("timelineStartInfo",n.timelineStartInfo);o=wr.moof(e,[n]);s=new Uint8Array(o.byteLength+h.byteLength);e++;s.set(o);s.set(h,o.byteLength);this.trigger("data",{track:n,boxes:s});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){hi.clearDtsInfo(n);u=undefined;f=undefined};this.getGopForFusion_=function(t){for(var o=Infinity,i,u,f,r,e=0;e<this.gopCache_.length;e++)(r=this.gopCache_[e],f=r.gop,n.pps&&sy(n.pps[0],r.pps[0])&&n.sps&&sy(n.sps[0],r.sps[0]))&&(f.dts<n.timelineStartInfo.dts||(i=t.dts-f.dts-f.duration,i>=-1e4&&i<=45e3&&(!u||o>i)&&(u=r,o=i)));return u?u.gop:null};this.alignGopsAtStart_=function(n){var f,i,e,u,o,s,h,t;for(o=n.byteLength,s=n.nalCount,h=n.duration,f=i=0;f<r.length&&i<n.length;){if(e=r[f],u=n[i],e.pts===u.pts)break;if(u.pts>e.pts){f++;continue}i++;o-=u.byteLength;s-=u.nalCount;h-=u.duration}return i===0?n:i===n.length?null:(t=n.slice(i),t.byteLength=o,t.duration=h,t.nalCount=s,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsAtEnd_=function(n){var u,i,s,h,f,e,c,t,o;for(u=r.length-1,i=n.length-1,f=null,e=!1;u>=0&&i>=0;){if(s=r[u],h=n[i],s.pts===h.pts){e=!0;break}if(s.pts>h.pts){u--;continue}u===r.length-1&&(f=i);i--}return!e&&f===null?null:(c=e?i:f,c===0)?n:(t=n.slice(c),o=t.reduce(function(n,t){return n.byteLength+=t.byteLength,n.duration+=t.duration,n.nalCount+=t.nalCount,n},{byteLength:0,duration:0,nalCount:0}),t.byteLength=o.byteLength,t.duration=o.duration,t.nalCount=o.nalCount,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsWith=function(n){r=n}};we.prototype=new et;gu=function(n,t){this.numberOfTracks=0;this.metadataStream=t;this.remuxTracks=typeof n.remux!="undefined"?!!n.remux:!0;this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;gu.prototype.init.call(this);this.push=function(n){if(n.text)return this.pendingCaptions.push(n);if(n.frames)return this.pendingMetadata.push(n);this.pendingTracks.push(n.track);this.pendingBoxes.push(n.boxes);this.pendingBytes+=n.boxes.byteLength;n.track.type==="video"&&(this.videoTrack=n.track);n.track.type==="audio"&&(this.audioTrack=n.track)}};gu.prototype=new et;gu.prototype.flush=function(n){var o=0,i={captions:[],captionStreams:{},metadata:[],info:{}},r,u,e,f=0,t;if(this.pendingTracks.length<this.numberOfTracks){if(n!=="VideoSegmentStream"&&n!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++;this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}for(this.videoTrack?(f=this.videoTrack.timelineStartInfo.pts,oy.forEach(function(n){i.info[n]=this.videoTrack[n]},this)):this.audioTrack&&(f=this.audioTrack.timelineStartInfo.pts,ey.forEach(function(n){i.info[n]=this.audioTrack[n]},this)),i.type=this.pendingTracks.length===1?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,e=wr.initSegment(this.pendingTracks),i.initSegment=new Uint8Array(e.byteLength),i.initSegment.set(e),i.data=new Uint8Array(this.pendingBytes),t=0;t<this.pendingBoxes.length;t++)i.data.set(this.pendingBoxes[t],o),o+=this.pendingBoxes[t].byteLength;for(t=0;t<this.pendingCaptions.length;t++)r=this.pendingCaptions[t],r.startTime=r.startPts-f,r.startTime/=9e4,r.endTime=r.endPts-f,r.endTime/=9e4,i.captionStreams[r.stream]=!0,i.captions.push(r);for(t=0;t<this.pendingMetadata.length;t++)u=this.pendingMetadata[t],u.cueTime=u.pts-f,u.cueTime/=9e4,i.metadata.push(u);i.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",i);this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)};ph=function(n){var r=this,u=!0,i,t;ph.prototype.init.call(this);n=n||{};this.baseMediaDecodeTime=n.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i;i.type="aac";i.metadataStream=new ni.MetadataStream;i.aacStream=new pat;i.audioTimestampRolloverStream=new ni.TimestampRolloverStream("audio");i.timedMetadataTimestampRolloverStream=new ni.TimestampRolloverStream("timed-metadata");i.adtsStream=new ny;i.coalesceStream=new gu(n,i.metadataStream);i.headOfPipeline=i.aacStream;i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream);i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream);i.metadataStream.on("timestamp",function(n){i.aacStream.setTimestamp(n.timeStamp)});i.aacStream.on("data",function(u){u.type!=="timed-metadata"||i.audioSegmentStream||(t=t||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new du(t,n),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream))});i.coalesceStream.on("data",this.trigger.bind(this,"data"));i.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var u={};this.transmuxPipeline_=u;u.type="ts";u.metadataStream=new ni.MetadataStream;u.packetStream=new ni.TransportPacketStream;u.parseStream=new ni.TransportParseStream;u.elementaryStream=new ni.ElementaryStream;u.videoTimestampRolloverStream=new ni.TimestampRolloverStream("video");u.audioTimestampRolloverStream=new ni.TimestampRolloverStream("audio");u.timedMetadataTimestampRolloverStream=new ni.TimestampRolloverStream("timed-metadata");u.adtsStream=new ny;u.h264Stream=new dat;u.captionStream=new ni.CaptionStream;u.coalesceStream=new gu(n,u.metadataStream);u.headOfPipeline=u.packetStream;u.packetStream.pipe(u.parseStream).pipe(u.elementaryStream);u.elementaryStream.pipe(u.videoTimestampRolloverStream).pipe(u.h264Stream);u.elementaryStream.pipe(u.audioTimestampRolloverStream).pipe(u.adtsStream);u.elementaryStream.pipe(u.timedMetadataTimestampRolloverStream).pipe(u.metadataStream).pipe(u.coalesceStream);u.h264Stream.pipe(u.captionStream).pipe(u.coalesceStream);u.elementaryStream.on("data",function(f){var e;if(f.type==="metadata"){for(e=f.tracks.length;e--;)i||f.tracks[e].type!=="video"?t||f.tracks[e].type!=="audio"||(t=f.tracks[e],t.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(i=f.tracks[e],i.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime);if(i&&!u.videoSegmentStream){u.coalesceStream.numberOfTracks++;u.videoSegmentStream=new we(i,n);u.videoSegmentStream.on("timelineStartInfo",function(n){t&&(t.timelineStartInfo=n,u.audioSegmentStream.setEarliestDts(n.dts))});u.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));u.videoSegmentStream.on("baseMediaDecodeTime",function(n){t&&u.audioSegmentStream.setVideoBaseMediaDecodeTime(n)});u.h264Stream.pipe(u.videoSegmentStream).pipe(u.coalesceStream)}t&&!u.audioSegmentStream&&(u.coalesceStream.numberOfTracks++,u.audioSegmentStream=new du(t,n),u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream))}});u.coalesceStream.on("data",this.trigger.bind(this,"data"));u.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;this.baseMediaDecodeTime=n;t&&(t.timelineStartInfo.dts=undefined,t.timelineStartInfo.pts=undefined,hi.clearDtsInfo(t),t.timelineStartInfo.baseMediaDecodeTime=n,r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity());i&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),i.timelineStartInfo.dts=undefined,i.timelineStartInfo.pts=undefined,hi.clearDtsInfo(i),r.captionStream.reset(),i.timelineStartInfo.baseMediaDecodeTime=n);r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()};this.setAudioAppendStart=function(n){t&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(n)};this.alignGopsWith=function(n){i&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(n)};this.push=function(n){if(u){var t=hit(n);t&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():t||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline();u=!1}this.transmuxPipeline_.headOfPipeline.push(n)};this.flush=function(){u=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}};ph.prototype=new et;var hy={Transmuxer:ph,VideoSegmentStream:we,AudioSegmentStream:du,AUDIO_PROPERTIES:ey,VIDEO_PROPERTIES:oy},ot,cy,wh=gt.parseType,ti=function(n){return new Date(n*1e3-20828448e5)},lit=function(n){return{isLeading:(n[0]&12)>>>2,dependsOn:n[0]&3,isDependedOn:(n[1]&192)>>>6,hasRedundancy:(n[1]&48)>>>4,paddingValue:(n[1]&14)>>>1,isNonSyncSample:n[1]&1,degradationPriority:n[2]<<8|n[3]}},gat=function(n){for(var u=new DataView(n.buffer,n.byteOffset,n.byteLength),t=[],r,i=0;i+4<n.length;i+=r){if(r=u.getUint32(i),i+=4,r<=0){t.push("<span style='color:red;'>MALFORMED DATA<\/span>");continue}switch(n[i]&31){case 1:t.push("slice_layer_without_partitioning_rbsp");break;case 5:t.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:t.push("sei_rbsp");break;case 7:t.push("seq_parameter_set_rbsp");break;case 8:t.push("pic_parameter_set_rbsp");break;case 9:t.push("access_unit_delimiter_rbsp");break;default:t.push("UNKNOWN NAL - "+n[i]&31)}}return t},nf={avc1:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:ot(n.subarray(78,n.byteLength))}},avcC:function(n){for(var f=new DataView(n.buffer,n.byteOffset,n.byteLength),u={configurationVersion:n[0],avcProfileIndication:n[1],profileCompatibility:n[2],avcLevelIndication:n[3],lengthSizeMinusOne:n[4]&3,sps:[],pps:[]},o=n[5]&31,e,i,t=6,r=0;r<o;r++)i=f.getUint16(t),t+=2,u.sps.push(new Uint8Array(n.subarray(t,t+i))),t+=i;for(e=n[t],t++,r=0;r<e;r++)i=f.getUint16(t),t+=2,u.pps.push(new Uint8Array(n.subarray(t,t+i))),t+=i;return u},btrt:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),esId:n[6]<<8|n[7],streamPriority:n[8]&31,decoderConfig:{objectProfileIndication:n[11],streamType:n[12]>>>2&63,bufferSize:n[13]<<16|n[14]<<8|n[15],maxBitrate:n[16]<<24|n[17]<<16|n[18]<<8|n[19],avgBitrate:n[20]<<24|n[21]<<16|n[22]<<8|n[23],decoderConfigDescriptor:{tag:n[24],length:n[25],audioObjectType:n[26]>>>3&31,samplingFrequencyIndex:(n[26]&7)<<1|n[27]>>>7&1,channelConfiguration:n[27]>>>3&15}}}},ftyp:function(n){for(var r=new DataView(n.buffer,n.byteOffset,n.byteLength),i={majorBrand:wh(n.subarray(0,4)),minorVersion:r.getUint32(4),compatibleBrands:[]},t=8;t<n.byteLength;)i.compatibleBrands.push(wh(n.subarray(t,t+4))),t+=4;return i},dinf:function(n){return{boxes:ot(n)}},dref:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),dataReferences:ot(n.subarray(8))}},hdlr:function(n){for(var r=new DataView(n.buffer,n.byteOffset,n.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),handlerType:wh(n.subarray(8,12)),name:""},t=8,t=24;t<n.byteLength;t++){if(n[t]===0){t++;break}i.name+=String.fromCharCode(n[t])}return i.name=decodeURIComponent(escape(i.name)),i},mdat:function(n){return{byteLength:n.byteLength,nals:gat(n)}},mdhd:function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,u,i={version:r.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),language:""};return i.version===1?(t+=4,i.creationTime=ti(r.getUint32(t)),t+=8,i.modificationTime=ti(r.getUint32(t)),t+=4,i.timescale=r.getUint32(t),t+=8,i.duration=r.getUint32(t)):(i.creationTime=ti(r.getUint32(t)),t+=4,i.modificationTime=ti(r.getUint32(t)),t+=4,i.timescale=r.getUint32(t),t+=4,i.duration=r.getUint32(t)),t+=4,u=r.getUint16(t),i.language+=String.fromCharCode((u>>10)+96),i.language+=String.fromCharCode(((u&992)>>5)+96),i.language+=String.fromCharCode((u&31)+96),i},mdia:function(n){return{boxes:ot(n)}},mfhd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),sequenceNumber:n[4]<<24|n[5]<<16|n[6]<<8|n[7]}},minf:function(n){return{boxes:ot(n)}},mp4a:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return n.byteLength>28&&(i.streamDescriptor=ot(n.subarray(28))[0]),i},moof:function(n){return{boxes:ot(n)}},moov:function(n){return{boxes:ot(n)}},mvex:function(n){return{boxes:ot(n)}},mvhd:function(n){var i=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,r={version:i.getUint8(0),flags:new Uint8Array(n.subarray(1,4))};return r.version===1?(t+=4,r.creationTime=ti(i.getUint32(t)),t+=8,r.modificationTime=ti(i.getUint32(t)),t+=4,r.timescale=i.getUint32(t),t+=8,r.duration=i.getUint32(t)):(r.creationTime=ti(i.getUint32(t)),t+=4,r.modificationTime=ti(i.getUint32(t)),t+=4,r.timescale=i.getUint32(t),t+=4,r.duration=i.getUint32(t)),t+=4,r.rate=i.getUint16(t)+i.getUint16(t+2)/16,t+=4,r.volume=i.getUint8(t)+i.getUint8(t+1)/8,t+=2,t+=2,t+=8,r.matrix=new Uint32Array(n.subarray(t,t+36)),t+=36,t+=24,r.nextTrackId=i.getUint32(t),r},pdin:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(n){for(var i={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},t=4;t<n.byteLength;t++)i.samples.push({dependsOn:(n[t]&48)>>4,isDependedOn:(n[t]&12)>>2,hasRedundancy:n[t]&3});return i},sidx:function(n){for(var t=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},u=t.getUint16(22),i=24;u;i+=12,u--)r.references.push({referenceType:(n[i]&128)>>>7,referencedSize:t.getUint32(i)&2147483647,subsegmentDuration:t.getUint32(i+4),startsWithSap:!!(n[i+8]&128),sapType:(n[i+8]&112)>>>4,sapDeltaTime:t.getUint32(i+8)&268435455});return r},smhd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),balance:n[4]+n[5]/256}},stbl:function(n){return{boxes:ot(n)}},stco:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),chunkOffsets:[]},u=i.getUint32(4),t=8;u;t+=4,u--)r.chunkOffsets.push(i.getUint32(t));return r},stsc:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r=i.getUint32(4),u={version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleToChunks:[]},t=8;r;t+=12,r--)u.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return u},stsd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleDescriptions:ot(n.subarray(8))}},stsz:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]},t=12;t<n.byteLength;t+=4)r.entries.push(i.getUint32(t));return r},stts:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),timeToSamples:[]},u=i.getUint32(4),t=8;u;t+=8,u--)r.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return r},styp:function(n){return nf.ftyp(n)},tfdt:function(n){var t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),baseMediaDecodeTime:n[4]<<24|n[5]<<16|n[6]<<8|n[7]};return t.version===1&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=n[8]<<24|n[9]<<16|n[10]<<8|n[11]),t},tfhd:function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:r.getUint32(4)},u=t.flags[2]&1,f=t.flags[2]&2,e=t.flags[2]&8,o=t.flags[2]&16,s=t.flags[2]&32,h=t.flags[0]&65536,c=t.flags[0]&131072,i;return i=8,u&&(i+=4,t.baseDataOffset=r.getUint32(12),i+=4),f&&(t.sampleDescriptionIndex=r.getUint32(i),i+=4),e&&(t.defaultSampleDuration=r.getUint32(i),i+=4),o&&(t.defaultSampleSize=r.getUint32(i),i+=4),s&&(t.defaultSampleFlags=r.getUint32(i)),h&&(t.durationIsEmpty=!0),!u&&c&&(t.baseDataOffsetIsMoof=!0),t},tkhd:function(n){var i=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,r={version:i.getUint8(0),flags:new Uint8Array(n.subarray(1,4))};return r.version===1?(t+=4,r.creationTime=ti(i.getUint32(t)),t+=8,r.modificationTime=ti(i.getUint32(t)),t+=4,r.trackId=i.getUint32(t),t+=4,t+=8,r.duration=i.getUint32(t)):(r.creationTime=ti(i.getUint32(t)),t+=4,r.modificationTime=ti(i.getUint32(t)),t+=4,r.trackId=i.getUint32(t),t+=4,t+=4,r.duration=i.getUint32(t)),t+=4,t+=8,r.layer=i.getUint16(t),t+=2,r.alternateGroup=i.getUint16(t),t+=2,r.volume=i.getUint8(t)+i.getUint8(t+1)/8,t+=2,t+=2,r.matrix=new Uint32Array(n.subarray(t,t+36)),t+=36,r.width=i.getUint16(t)+i.getUint16(t+2)/16,t+=4,r.height=i.getUint16(t)+i.getUint16(t+2)/16,r},traf:function(n){return{boxes:ot(n)}},trak:function(n){return{boxes:ot(n)}},trex:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:n[20]&3,sampleIsDependedOn:(n[21]&192)>>6,sampleHasRedundancy:(n[21]&48)>>4,samplePaddingValue:(n[21]&14)>>1,sampleIsDifferenceSample:!!(n[21]&1),sampleDegradationPriority:t.getUint16(22)}},trun:function(n){var r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},u=new DataView(n.buffer,n.byteOffset,n.byteLength),h=r.flags[2]&1,c=r.flags[2]&4,e=r.flags[1]&1,o=r.flags[1]&2,l=r.flags[1]&4,s=r.flags[1]&8,f=u.getUint32(4),t=8,i;for(h&&(r.dataOffset=u.getInt32(t),t+=4),c&&f&&(i={flags:lit(n.subarray(t,t+4))},t+=4,e&&(i.duration=u.getUint32(t),t+=4),o&&(i.size=u.getUint32(t),t+=4),s&&(i.compositionTimeOffset=u.getUint32(t),t+=4),r.samples.push(i),f--);f--;)i={},e&&(i.duration=u.getUint32(t),t+=4),o&&(i.size=u.getUint32(t),t+=4),l&&(i.flags=lit(n.subarray(t,t+4)),t+=4),s&&(i.compositionTimeOffset=u.getUint32(t),t+=4),r.samples.push(i);return r},"url ":function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4))}},vmhd:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};ot=function(n){for(var t=0,o=[],s,i,f,e,r,h=new ArrayBuffer(n.length),c=new Uint8Array(h),u=0;u<n.length;++u)c[u]=n[u];for(s=new DataView(h);t<n.byteLength;)i=s.getUint32(t),f=wh(n.subarray(t+4,t+8)),e=i>1?t+i:n.byteLength,r=(nf[f]||function(n){return{data:n}})(n.subarray(t+8,e)),r.size=i,r.type=f,o.push(r),t=e;return o};cy=function(n,t){var i;return t=t||0,i=new Array(t*2+1).join(" "),n.map(function(n){return i+n.type+"\n"+Object.keys(n).filter(function(n){return n!=="type"&&n!=="boxes"}).map(function(t){var f=i+"  "+t+": ",r=n[t],u;return r instanceof Uint8Array||r instanceof Uint32Array?(u=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(n){return" "+("00"+n.toString(16)).slice(-2)}).join("").match(/.{1,24}/g),!u)?f+"<>":u.length===1?f+"<"+u.join("").slice(1)+">":f+"<\n"+u.map(function(n){return i+"  "+n}).join("\n")+"\n"+i+"  >":f+JSON.stringify(r,null,2).split("\n").map(function(n,t){return t===0?n:i+"  "+n}).join("\n")}).join("\n")+(n.boxes?"\n"+cy(n.boxes,t+1):"")}).join("\n")};var ly={inspect:ot,textify:cy,parseTfdt:nf.tfdt,parseHdlr:nf.hdlr,parseTfhd:nf.tfhd,parseTrun:nf.trun},nvt=ve.discardEmulationPreventionBytes,tvt=pv.CaptionStream,ivt=function(n,t){for(var i,u=n,r=0;r<t.length;r++){if(i=t[r],u<i.size)return i;u-=i.size}return null},rvt=function(n,t,i){for(var c=new DataView(n.buffer,n.byteOffset,n.byteLength),h=[],u,f,o,s,e,r=0;r+4<n.length;r+=f)if(f=c.getUint32(r),r+=4,!(f<=0))switch(n[r]&31){case 6:s=n.subarray(r+1,r+1+f);e=ivt(r,t);u={nalUnitType:"sei_rbsp",size:f,data:s,escapedRBSP:nvt(s),trackId:i};e?(u.pts=e.pts,u.dts=e.dts,o=e):(u.pts=o.pts,u.dts=o.dts);h.push(u)}return h},uvt=function(n,t,i){var r=t,f=i.defaultSampleDuration||0,e=i.defaultSampleSize||0,o=i.trackId,u=[];return n.forEach(function(n){var i=ly.parseTrun(n),t=i.samples;t.forEach(function(n){n.duration===undefined&&(n.duration=f);n.size===undefined&&(n.size=e);n.trackId=o;n.dts=r;n.compositionTimeOffset===undefined&&(n.compositionTimeOffset=0);n.pts=r+n.compositionTimeOffset;r+=n.duration});u=u.concat(t)}),u},fvt=function(n,t){var u=gt.findBox(n,["moof","traf"]),f=gt.findBox(n,["mdat"]),i={},r=[];return f.forEach(function(n,t){var i=u[t];r.push({mdat:n,traf:i})}),r.forEach(function(n){var c=n.mdat,u=n.traf,l=gt.findBox(u,["tfhd"]),f=ly.parseTfhd(l[0]),r=f.trackId,e=gt.findBox(u,["tfdt"]),a=e.length>0?ly.parseTfdt(e[0]).baseMediaDecodeTime:0,o=gt.findBox(u,["trun"]),s,h;t===r&&o.length>0&&(s=uvt(o,a,f),h=rvt(c,s,r),i[r]||(i[r]=[]),i[r]=i[r].concat(h))}),i},evt=function(n,t,i){var r;return t?(r=fvt(n,t),{seiNals:r[t],timescale:i}):null},ovt=function(){var f=!1,r,u,n,t,i;this.isInitialized=function(){return f};this.init=function(){r=new tvt;f=!0;r.on("data",function(n){n.startTime=n.startPts/t;n.endTime=n.endPts/t;i.captions.push(n);i.captionStreams[n.stream]=!0})};this.isNewInit=function(i,r){return i&&i.length===0||r&&typeof r=="object"&&Object.keys(r).length===0?!1:n!==i[0]||t!==r[n]};this.parse=function(r,f,e){var o,s;if(this.isInitialized())if(f&&e){if(this.isNewInit(f,e))n=f[0],t=e[n];else if(!n||!t)return u.push(r),null}else return null;else return null;while(u.length>0)s=u.shift(),this.parse(s,f,e);return(o=evt(r,n,t),o===null||!o.seiNals)?null:(this.pushNals(o.seiNals),this.flushStream(),i)};this.pushNals=function(n){if(!this.isInitialized()||!n||n.length===0)return null;n.forEach(function(n){r.push(n)})};this.flushStream=function(){if(!this.isInitialized())return null;r.flush()};this.clearParsedCaptions=function(){i.captions=[];i.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized())return null;r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){u=[];n=null;t=null;i?this.clearParsedCaptions():i={captions:[],captionStreams:{}};this.resetCaptionStream()};this.reset()},svt=ovt,hvt={generator:wr,probe:gt,Transmuxer:hy.Transmuxer,AudioSegmentStream:hy.AudioSegmentStream,VideoSegmentStream:hy.VideoSegmentStream,CaptionParser:svt},cvt=hvt.CaptionParser,ait=function(n){var t=n[1]&31;return t<<=8,t|n[2]},bh=function(n){return!!(n[1]&64)},kh=function(n){var t=0;return(n[3]&48)>>>4>1&&(t+=n[4]+1),t},lvt=function(n,t){var i=ait(n);return i===0?"pat":i===t?"pmt":t?"pes":null},avt=function(n){var i=bh(n),t=4+kh(n);return i&&(t+=n[t]+1),(n[t+10]&31)<<8|n[t+11]},vvt=function(n){var u={},s=bh(n),t=4+kh(n),f,e,o,r,i;if(s&&(t+=n[t]+1),n[t+5]&1){for(f=(n[t+1]&15)<<8|n[t+2],e=3+f-4,o=(n[t+10]&15)<<8|n[t+11],r=12+o;r<e;)i=t+r,u[(n[i+1]&31)<<8|n[i+2]]=n[i],r+=((n[i+3]&15)<<8|n[i+4])+5;return u}},yvt=function(n,t){var i=ait(n),r=t[i];switch(r){case nt.H264_STREAM_TYPE:return"video";case nt.ADTS_STREAM_TYPE:return"audio";case nt.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},pvt=function(n){var u=bh(n),t,i,r;return u?(t=4+kh(n),t>=n.byteLength)?null:(i=null,r=n[t+7],r&192&&(i={},i.pts=(n[t+9]&14)<<27|(n[t+10]&255)<<20|(n[t+11]&254)<<12|(n[t+12]&255)<<5|(n[t+13]&254)>>>3,i.pts*=4,i.pts+=(n[t+13]&6)>>>1,i.dts=i.pts,r&64&&(i.dts=(n[t+14]&14)<<27|(n[t+15]&255)<<20|(n[t+16]&254)<<12|(n[t+17]&255)<<5|(n[t+18]&254)>>>3,i.dts*=4,i.dts+=(n[t+18]&6)>>>1)),i):null},ay=function(n){switch(n){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},wvt=function(n){for(var e=4+kh(n),i=n.subarray(e),t=0,r=0,f=!1,u;r<i.byteLength-3;r++)if(i[r+2]===1){t=r+5;break}while(t<i.byteLength)switch(i[t]){case 0:if(i[t-1]!==0){t+=2;break}else if(i[t-2]!==0){t++;break}r+3!==t-2&&(u=ay(i[r+3]&31),u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0));do t++;while(i[t]!==1&&t<i.length);r=t-2;t+=3;break;case 1:if(i[t-1]!==0||i[t-2]!==0){t+=3;break}u=ay(i[r+3]&31);u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0);r=t-2;t+=3;break;default:t+=3}return i=i.subarray(r),t-=r,r=0,i&&i.byteLength>3&&(u=ay(i[r+3]&31),u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0)),f},bvt={parseType:lvt,parsePat:avt,parsePmt:vvt,parsePayloadUnitStartIndicator:bh,parsePesType:yvt,parsePesTime:pvt,videoPacketContainsKeyFrame:wvt},kvt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],vit=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},dvt=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},gvt=function(n,t,i){return unescape(dvt(n,t,i))},nyt=function(n,t){var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],r=n[t+5],u=(r&16)>>4;return u?i+20:i+10},tyt=function(n,t){var i=(n[t+5]&224)>>5,r=n[t+4]<<3,u=n[t+3]&6144;return u|r|i},iyt=function(n,t){return n[t]==="I".charCodeAt(0)&&n[t+1]==="D".charCodeAt(0)&&n[t+2]==="3".charCodeAt(0)?"timed-metadata":n[t]&!0&&(n[t+1]&240)==240?"audio":null},ryt=function(n){for(var t=0;t+5<n.length;){if(n[t]!==255||(n[t+1]&246)!=240){t++;continue}return kvt[(n[t+2]&60)>>>2]}return null},uyt=function(n){var t,f,u,o,r,s,i,e;t=10;n[5]&64&&(t+=4,t+=vit(n.subarray(10,14)));do{if(f=vit(n.subarray(t+4,t+8)),f<1)return null;if(o=String.fromCharCode(n[t],n[t+1],n[t+2],n[t+3]),o==="PRIV")for(u=n.subarray(t+10,t+f+10),r=0;r<u.byteLength;r++)if(u[r]===0){if(s=gvt(u,0,r),s==="com.apple.streaming.transportStreamTimestamp")return i=u.subarray(r+1),e=(i[3]&1)<<30|i[4]<<22|i[5]<<14|i[6]<<6|i[7]>>>2,e*=4,e+(i[7]&3);break}t+=10;t+=f}while(t<n.byteLength);return null},fyt={parseId3TagSize:nyt,parseAdtsSize:tyt,parseType:iyt,parseSampleRate:ryt,parseAacTimestamp:uyt},tf=ktt.handleRollover,a={};a.ts=bvt;a.aac=fyt;var kr=9e4,st=188,ci=71,eyt=function(n){return n[0]==="I".charCodeAt(0)&&n[1]==="D".charCodeAt(0)&&n[2]==="3".charCodeAt(0)?!0:!1},oyt=function(n,t){for(var r=0,i=st,u,f;i<n.byteLength;){if(n[r]===ci&&n[i]===ci){u=n.subarray(r,i);f=a.ts.parseType(u,t.pid);switch(f){case"pat":t.pid||(t.pid=a.ts.parsePat(u));break;case"pmt":t.table||(t.table=a.ts.parsePmt(u))}if(t.pid&&t.table)return;r+=st;i+=st;continue}r++;i++}},syt=function(n,t,i){for(var u=0,r=st,f,s,h,c,e,o=!1;r<n.byteLength;){if(n[u]===ci&&n[r]===ci){f=n.subarray(u,r);s=a.ts.parseType(f,t.pid);switch(s){case"pes":h=a.ts.parsePesType(f,t.table);c=a.ts.parsePayloadUnitStartIndicator(f);h==="audio"&&c&&(e=a.ts.parsePesTime(f),e&&(e.type="audio",i.audio.push(e),o=!0))}if(o)break;u+=st;r+=st;continue}u++;r++}for(r=n.byteLength,u=r-st,o=!1;u>=0;){if(n[u]===ci&&n[r]===ci){f=n.subarray(u,r);s=a.ts.parseType(f,t.pid);switch(s){case"pes":h=a.ts.parsePesType(f,t.table);c=a.ts.parsePayloadUnitStartIndicator(f);h==="audio"&&c&&(e=a.ts.parsePesTime(f),e&&(e.type="audio",i.audio.push(e),o=!0))}if(o)break;u-=st;r-=st;continue}u--;r--}},hyt=function(n,t,i){for(var f=0,u=st,r,c,l,h,e,v,y,p,s=!1,o={data:[],size:0};u<n.byteLength;){if(n[f]===ci&&n[u]===ci){r=n.subarray(f,u);c=a.ts.parseType(r,t.pid);switch(c){case"pes":if(l=a.ts.parsePesType(r,t.table),h=a.ts.parsePayloadUnitStartIndicator(r),l==="video"&&(h&&!s&&(e=a.ts.parsePesTime(r),e&&(e.type="video",i.video.push(e),s=!0)),!i.firstKeyFrame)){if(h&&o.size!==0){for(v=new Uint8Array(o.size),y=0;o.data.length;)p=o.data.shift(),v.set(p,y),y+=p.byteLength;a.ts.videoPacketContainsKeyFrame(v)&&(i.firstKeyFrame=a.ts.parsePesTime(v),i.firstKeyFrame.type="video");o.size=0}o.data.push(r);o.size+=r.byteLength}}if(s&&i.firstKeyFrame)break;f+=st;u+=st;continue}f++;u++}for(u=n.byteLength,f=u-st,s=!1;f>=0;){if(n[f]===ci&&n[u]===ci){r=n.subarray(f,u);c=a.ts.parseType(r,t.pid);switch(c){case"pes":l=a.ts.parsePesType(r,t.table);h=a.ts.parsePayloadUnitStartIndicator(r);l==="video"&&h&&(e=a.ts.parsePesTime(r),e&&(e.type="video",i.video.push(e),s=!0))}if(s)break;f-=st;u-=st;continue}f--;u--}},cyt=function(n,t){var u,r,i;n.audio&&n.audio.length&&(u=t,typeof u=="undefined"&&(u=n.audio[0].dts),n.audio.forEach(function(n){n.dts=tf(n.dts,u);n.pts=tf(n.pts,u);n.dtsTime=n.dts/kr;n.ptsTime=n.pts/kr}));n.video&&n.video.length&&(r=t,typeof r=="undefined"&&(r=n.video[0].dts),n.video.forEach(function(n){n.dts=tf(n.dts,r);n.pts=tf(n.pts,r);n.dtsTime=n.dts/kr;n.ptsTime=n.pts/kr}),n.firstKeyFrame&&(i=n.firstKeyFrame,i.dts=tf(i.dts,r),i.pts=tf(i.pts,r),i.dtsTime=i.dts/kr,i.ptsTime=i.dts/kr))},lyt=function(n){for(var u=!1,o=0,f=null,r=null,i=0,t=0,e,h,s,c;n.length-t>=3;){h=a.aac.parseType(n,t);switch(h){case"timed-metadata":if(n.length-t<10){u=!0;break}if(i=a.aac.parseId3TagSize(n,t),i>n.length){u=!0;break}r===null&&(e=n.subarray(t,t+i),r=a.aac.parseAacTimestamp(e));t+=i;break;case"audio":if(n.length-t<7){u=!0;break}if(i=a.aac.parseAdtsSize(n,t),i>n.length){u=!0;break}f===null&&(e=n.subarray(t,t+i),f=a.aac.parseSampleRate(e));o++;t+=i;break;default:t++}if(u)return null}return f===null||r===null?null:(s=kr/f,c={audio:[{type:"audio",dts:r,pts:r},{type:"audio",dts:r+o*1024*s,pts:r+o*1024*s}]},c)},ayt=function(n){var i={pid:null,table:null},t={},r,u;oyt(n,i);for(r in i.table)if(i.table.hasOwnProperty(r)){u=i.table[r];switch(u){case nt.H264_STREAM_TYPE:t.video=[];hyt(n,i,t);t.video.length===0&&delete t.video;break;case nt.ADTS_STREAM_TYPE:t.audio=[];syt(n,i,t);t.audio.length===0&&delete t.audio}}return t},vyt=function(n,t){var r=eyt(n),i;return(i=r?lyt(n):ayt(n),!i||!i.audio&&!i.video)?null:(cyt(i,t),i)},yyt={inspect:vyt};var dh=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},wyt=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),byt=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)},kyt=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n},dyt=function(){for(var h=[[[],[],[],[],[]],[[],[],[],[],[]]],f=h[0],e=h[1],l=f[4],p=e[4],n=void 0,i=void 0,r=void 0,u=[],a=[],c=void 0,v=void 0,y=void 0,t=void 0,o=void 0,s=void 0,n=0;n<256;n++)a[(u[n]=n<<1^(n>>7)*283)^n]=n;for(i=r=0;!l[i];i^=c||1,r=a[r]||1)for(t=r^r<<1^r<<2^r<<3^r<<4,t=t>>8^t&255^99,l[i]=t,p[t]=i,y=u[v=u[c=u[i]]],s=y*16843009^v*65537^c*257^i*16843008,o=u[t]*257^t*16843008,n=0;n<4;n++)f[n][i]=o=o<<24^o>>>8,e[n][t]=s=s<<24^s>>>8;for(n=0;n<5;n++)f[n]=f[n].slice(0),e[n]=e[n].slice(0);return h},ii=null,gyt=function(){function n(t){dh(this,n);ii||(ii=dyt());this._tables=[[ii[0][0].slice(),ii[0][1].slice(),ii[0][2].slice(),ii[0][3].slice(),ii[0][4].slice()],[ii[1][0].slice(),ii[1][1].slice(),ii[1][2].slice(),ii[1][3].slice(),ii[1][4].slice()]];var r=void 0,o=void 0,i=void 0,e=void 0,c=void 0,f=this._tables[0][4],s=this._tables[1],u=t.length,h=1;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size");for(e=t.slice(0),c=[],this._key=[e,c],r=u;r<4*u+28;r++)i=e[r-1],(r%u==0||u===8&&r%u==4)&&(i=f[i>>>24]<<24^f[i>>16&255]<<16^f[i>>8&255]<<8^f[i&255],r%u==0&&(i=i<<8^i>>>24^h<<24,h=h<<1^(h>>7)*283)),e[r]=e[r-u]^i;for(o=0;r;o++,r--)i=e[o&3?r:r-4],c[o]=r<=4||o<4?i:s[0][f[i>>>24]]^s[1][f[i>>16&255]]^s[2][f[i>>8&255]]^s[3][f[i&255]]}return n.prototype.decrypt=function(n,t,i,r,u,f){for(var e=this._key[1],o=n^e[0],s=r^e[1],h=i^e[2],c=t^e[3],y=void 0,g=void 0,nt=void 0,tt=e.length/4-2,l=void 0,a=4,v=this._tables[1],p=v[0],w=v[1],b=v[2],k=v[3],d=v[4],l=0;l<tt;l++)y=p[o>>>24]^w[s>>16&255]^b[h>>8&255]^k[c&255]^e[a],g=p[s>>>24]^w[h>>16&255]^b[c>>8&255]^k[o&255]^e[a+1],nt=p[h>>>24]^w[c>>16&255]^b[o>>8&255]^k[s&255]^e[a+2],c=p[c>>>24]^w[o>>16&255]^b[s>>8&255]^k[h&255]^e[a+3],a+=4,o=y,s=g,h=nt;for(l=0;l<4;l++)u[(3&-l)+f]=d[o>>>24]<<24^d[s>>16&255]<<16^d[h>>8&255]<<8^d[c&255]^e[a++],y=o,o=s,s=h,h=c,c=y},n}(),yit=function(){function n(){dh(this,n);this.listeners={}}return n.prototype.on=function(n,t){this.listeners[n]||(this.listeners[n]=[]);this.listeners[n].push(t)},n.prototype.off=function(n,t){if(!this.listeners[n])return!1;var i=this.listeners[n].indexOf(t);return this.listeners[n].splice(i,1),i>-1},n.prototype.trigger=function(n){var t=this.listeners[n],u,i,f,e,r;if(t)if(arguments.length===2)for(u=t.length,i=0;i<u;++i)t[i].call(this,arguments[1]);else for(f=Array.prototype.slice.call(arguments,1),e=t.length,r=0;r<e;++r)t[r].apply(this,f)},n.prototype.dispose=function(){this.listeners={}},n.prototype.pipe=function(n){this.on("data",function(t){n.push(t)})},n}(),pit=function(n){function t(){dh(this,t);var i=kyt(this,n.call(this,yit));return i.jobs=[],i.delay=1,i.timeout_=null,i}return byt(t,n),t.prototype.processJob_=function(){this.jobs.shift()();this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},t.prototype.push=function(n){this.jobs.push(n);this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(yit),ri=function(n){return n<<24|(n&65280)<<8|(n&16711680)>>8|n>>>24},wit=function(n,t,i){var f=new Int32Array(n.buffer,n.byteOffset,n.byteLength>>2),p=new gyt(Array.prototype.slice.call(t)),y=new Uint8Array(n.byteLength),u=new Int32Array(y.buffer),e=void 0,o=void 0,s=void 0,h=void 0,c=void 0,l=void 0,a=void 0,v=void 0,r=void 0;for(e=i[0],o=i[1],s=i[2],h=i[3],r=0;r<f.length;r+=4)c=ri(f[r]),l=ri(f[r+1]),a=ri(f[r+2]),v=ri(f[r+3]),p.decrypt(c,l,a,v,u,r),u[r]=ri(u[r]^e),u[r+1]=ri(u[r+1]^o),u[r+2]=ri(u[r+2]^s),u[r+3]=ri(u[r+3]^h),e=c,o=l,s=a,h=v;return y},npt=function(){function n(t,i,r,u){dh(this,n);var o=n.STEP,e=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),f=0;for(this.asyncStream_=new pit,this.asyncStream_.push(this.decryptChunk_(e.subarray(f,f+o),i,r,s)),f=o;f<e.length;f+=o)r=new Uint32Array([ri(e[f-4]),ri(e[f-3]),ri(e[f-2]),ri(e[f-1])]),this.asyncStream_.push(this.decryptChunk_(e.subarray(f,f+o),i,r,s));this.asyncStream_.push(function(){u(null,pyt(s))})}return n.prototype.decryptChunk_=function(n,t,i,r){return function(){var u=wit(n,t,i);r.set(u,n.byteOffset)}},wyt(n,null,[{key:"STEP",get:function(){return 32e3}}]),n}();
/**
   * @videojs/http-streaming
   * @version 1.4.1
   * @copyright 2018 Brightcove, Inc
   * @license Apache-2.0
   */
var pi=function(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=pg.buildAbsoluteURL(n.location.href,t)),pg.buildAbsoluteURL(t,i))},ui=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},ei=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),tpt=function vk(n,t,i){var r,u,f;return n===null&&(n=Function.prototype),r=Object.getOwnPropertyDescriptor(n,t),r===undefined?(u=Object.getPrototypeOf(n),u===null?undefined:vk(u,t,i)):"value"in r?r.value:(f=r.get,f===undefined)?undefined:f.call(i)},wi=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)},li=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n},ipt=function(){function n(n,t){var r=[],u=!0,f=!1,e=undefined,i,o;try{for(i=n[Symbol.iterator]();!(u=(o=i.next()).done);u=!0)if(r.push(o.value),t&&r.length===t)break}catch(s){f=!0;e=s}finally{try{!u&&i["return"]&&i["return"]()}finally{if(f)throw e;}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),vy=i.mergeOptions,rpt=i.EventTarget,upt=i.log,yy=function(n,t){["AUDIO","SUBTITLES"].forEach(function(i){var r,u,f;for(r in n.mediaGroups[i])for(u in n.mediaGroups[i][r])f=n.mediaGroups[i][r][u],t(f,i,r,u)})},fpt=function(n,t,i){var u=t.slice(),f,r;for(i=i||0,f=Math.min(n.length,t.length+i),r=i;r<f;r++)u[r-i]=vy(n[r],u[r-i]);return u},ept=function(n,t){n.resolvedUri||(n.resolvedUri=pi(t,n.uri));n.key&&!n.key.resolvedUri&&(n.key.resolvedUri=pi(t,n.key.uri));n.map&&!n.map.resolvedUri&&(n.map.resolvedUri=pi(t,n.map.uri))},py=function(n,t){var r=vy(n,{}),i=r.playlists[t.uri],u,f;if(!i||i.segments&&t.segments&&i.segments.length===t.segments.length&&i.mediaSequence===t.mediaSequence)return null;for(u=vy(i,t),i.segments&&(u.segments=fpt(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),u.segments.forEach(function(n){ept(n,u.resolvedUri)}),f=0;f<r.playlists.length;f++)r.playlists[f].uri===t.uri&&(r.playlists[f]=u);return r.playlists[t.uri]=u,r},bit=function(n){for(var i=n.playlists.length,t;i--;)t=n.playlists[i],n.playlists[t.uri]=t,t.resolvedUri=pi(n.uri,t.uri),t.id=i,t.attributes||(t.attributes={},upt.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))},kit=function(n){yy(n,function(t){t.uri&&(t.resolvedUri=pi(n.uri,t.uri))})},dit=function(n,t){var i=n.segments[n.segments.length-1];return t&&i&&i.duration?i.duration*1e3:(n.targetDuration||10)*500},gh=function(t){function i(n,t,r){ui(this,i);var u=li(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));if(u.srcUrl=n,u.hls_=t,u.withCredentials=r,!u.srcUrl)throw new Error("A non-empty playlist URL is required");u.state="HAVE_NOTHING";u.on("mediaupdatetimeout",function(){u.state==="HAVE_METADATA"&&(u.state="HAVE_CURRENT_METADATA",u.request=u.hls_.xhr({uri:pi(u.master.uri,u.media().uri),withCredentials:u.withCredentials},function(n){if(u.request){if(n)return u.playlistRequestError(u.request,u.media().uri,"HAVE_METADATA");u.haveMetadata(u.request,u.media().uri)}}))});return u}return wi(i,t),ei(i,[{key:"playlistRequestError",value:function(n,t,i){this.request=null;i&&(this.state=i);this.error={playlist:this.master.playlists[t],status:n.status,message:"HLS playlist request error at URL: "+t,responseText:n.responseText,code:n.status>=500?4:2};this.trigger("error")}},{key:"haveMetadata",value:function(t,i){var f=this,r,u;this.request=null;this.state="HAVE_METADATA";r=new wg;r.push(t.responseText);r.end();r.manifest.uri=i;r.manifest.attributes=r.manifest.attributes||{};u=py(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration;u?(this.master=u,this.media_=this.master.playlists[r.manifest.uri]):this.trigger("playlistunchanged");this.media().endList||(n.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=n.setTimeout(function(){f.trigger("mediaupdatetimeout")},dit(this.media(),!!u)));this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest();n.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var n=this.request;this.request=null;n.onreadystatechange=null;n.abort()}}},{key:"media",value:function(n){var t=this,i,r;if(!n)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(i=this.state,typeof n=="string"){if(!this.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.master.playlists[n]}if(r=!this.media_||n.uri!==this.media_.uri,this.master.playlists[n.uri].endList){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null);this.state="HAVE_METADATA";this.media_=n;r&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}if(r){if(this.state="SWITCHING_MEDIA",this.request){if(pi(this.master.uri,n.uri)===this.request.url)return;this.request.onreadystatechange=null;this.request.abort();this.request=null}this.media_&&this.trigger("mediachanging");this.request=this.hls_.xhr({uri:pi(this.master.uri,n.uri),withCredentials:this.withCredentials},function(r,u){if(t.request){if(r)return t.playlistRequestError(t.request,n.uri,i);t.haveMetadata(u,n.uri);i==="HAVE_MASTER"?t.trigger("loadedmetadata"):t.trigger("mediachange")}})}}},{key:"pause",value:function(){this.stopRequest();n.clearTimeout(this.mediaUpdateTimeout);this.state==="HAVE_NOTHING"&&(this.started=!1);this.state==="SWITCHING_MEDIA"?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}},{key:"load",value:function(t){var u=this,i,r;if(n.clearTimeout(this.mediaUpdateTimeout),i=this.media(),t){r=i?i.targetDuration*500:5e3;this.mediaUpdateTimeout=n.setTimeout(function(){return u.load()},r);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}},{key:"start",value:function(){var t=this;this.started=!0;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(i,r){if(t.request){if(t.request=null,i)return t.error={status:r.status,message:"HLS playlist request error at URL: "+t.srcUrl,responseText:r.responseText,code:2},t.state==="HAVE_NOTHING"&&(t.started=!1),t.trigger("error");var u=new wg;if(u.push(r.responseText),u.end(),t.state="HAVE_MASTER",u.manifest.uri=t.srcUrl,u.manifest.playlists){t.master=u.manifest;bit(t.master);kit(t.master);t.trigger("loadedplaylist");t.request||t.media(u.manifest.playlists[0]);return}return t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:n.location.href,playlists:[{uri:t.srcUrl,id:0}]},t.master.playlists[t.srcUrl]=t.master.playlists[0],t.master.playlists[0].resolvedUri=t.srcUrl,t.master.playlists[0].attributes=t.master.playlists[0].attributes||{},t.haveMetadata(r,t.srcUrl),t.trigger("loadedmetadata")}})}}]),i}(rpt),git=i.createTimeRange,opt=function(n,t){var r=0,u=t-n.mediaSequence,i=n.segments[u];if(i){if(typeof i.start!="undefined")return{result:i.start,precise:!0};if(typeof i.end!="undefined")return{result:i.end-i.duration,precise:!0}}while(u--){if(i=n.segments[u],typeof i.end!="undefined")return{result:r+i.end,precise:!0};if(r+=i.duration,typeof i.start!="undefined")return{result:r+i.start,precise:!0}}return{result:r,precise:!1}},spt=function(n,t){for(var r=0,i=void 0,u=t-n.mediaSequence;u<n.segments.length;u++){if(i=n.segments[u],typeof i.start!="undefined")return{result:i.start-r,precise:!0};if(r+=i.duration,typeof i.end!="undefined")return{result:i.end-r,precise:!0}}return{result:-1,precise:!1}},nrt=function(n,t,i){var r=void 0,u=void 0;return(typeof t=="undefined"&&(t=n.mediaSequence+n.segments.length),t<n.mediaSequence)?0:(r=opt(n,t),r.precise)?r.result:(u=spt(n,t),u.precise)?u.result:r.result+i},trt=function(t,i,r){if(!t)return 0;if(typeof r!="number"&&(r=0),typeof i=="undefined"){if(t.totalDuration)return t.totalDuration;if(!t.endList)return n.Infinity}return nrt(t,i,r)},be=function(n,t,i){var u=0,f,e,r;if(t>i&&(f=[i,t],t=f[0],i=f[1]),t<0){for(e=t;e<Math.min(0,i);e++)u+=n.targetDuration;t=0}for(r=t;r<i;r++)u+=n.segments[r].duration;return u},irt=function(n){if(!n.segments.length)return 0;for(var t=n.segments.length-1,i=n.segments[t].duration||n.targetDuration,r=i+n.targetDuration*2;t--;)if(i+=n.segments[t].duration,i>=r)break;return Math.max(0,t)},rrt=function(n,t,i){if(!n||!n.segments)return null;if(n.endList)return trt(n);if(t===null)return null;t=t||0;var r=i?irt(n):n.segments.length;return nrt(n,n.mediaSequence+r,t)},hpt=function(n,t){var r=t||0,i=rrt(n,t,!0);return i===null?git():git(r,i)},urt=function(n){return n-Math.floor(n)==0},frt=function(n,t){var r,i,u,f;if(urt(t))return t+n*.1;for(r=t.toString().split(".")[1].length,i=1;i<=r;i++)if(u=Math.pow(10,i),f=t*u,urt(f)||i===r)return(f+n)/u},cpt=frt.bind(null,1),lpt=frt.bind(null,-1),apt=function(n,t,i,r){var u=void 0,e=void 0,o=n.segments.length,f=t-r;if(f<0){if(i>0)for(u=i-1;u>=0;u--)if(e=n.segments[u],f+=lpt(e.duration),f>0)return{mediaIndex:u,startTime:r-be(n,i,u)};return{mediaIndex:0,startTime:t}}if(i<0){for(u=i;u<0;u++)if(f-=n.targetDuration,f<0)return{mediaIndex:0,startTime:t};i=0}for(u=i;u<o;u++)if(e=n.segments[u],f-=cpt(e.duration),f<0)return{mediaIndex:u,startTime:r+be(n,i,u)};return{mediaIndex:o-1,startTime:t}},ert=function(n){return n.excludeUntil&&n.excludeUntil>Date.now()},wy=function(n){return n.excludeUntil&&n.excludeUntil===Infinity},nc=function(n){var t=ert(n);return!n.disabled&&!t},vpt=function(n){return n.disabled},ypt=function(n){for(var t=0;t<n.segments.length;t++)if(n.segments[t].key)return!0;return!1},ppt=function(n){for(var t=0;t<n.segments.length;t++)if(n.segments[t].map)return!0;return!1},ort=function(n,t){return t.attributes&&t.attributes[n]},wpt=function(n,t,i){var u=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0,r;return ort("BANDWIDTH",i)?(r=n*i.attributes.BANDWIDTH,(r-u*8)/t):NaN},by=function(n,t){if(n.playlists.length===1)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return n.playlists.filter(function(n){return nc(n)?(n.attributes.BANDWIDTH||0)<i:!1}).length===0},wt={duration:trt,seekable:hpt,safeLiveIndex:irt,getMediaInfoForTime:apt,isEnabled:nc,isDisabled:vpt,isBlacklisted:ert,isIncompatible:wy,playlistEnd:rrt,isAes:ypt,isFmp4:ppt,hasAttribute:ort,estimateSegmentRequestTime:wpt,isLowestEnabledRendition:by},bpt=i.xhr,kpt=i.mergeOptions,srt=function(){return function n(t,r){var f,e,u,o;return t=kpt({timeout:45e3},t),f=n.beforeRequest||i.Hls.xhr.beforeRequest,f&&typeof f=="function"&&(e=f(t),e&&(t=e)),u=bpt(t,function(n,t){var i=u.response;!n&&i&&(u.responseTime=Date.now(),u.roundTripTime=u.responseTime-u.requestTime,u.bytesReceived=i.byteLength||i.length,u.bandwidth||(u.bandwidth=Math.floor(u.bytesReceived/u.roundTripTime*8e3)));t.headers&&(u.responseHeaders=t.headers);n&&n.code==="ETIMEDOUT"&&(u.timedout=!0);n||u.aborted||t.statusCode===200||t.statusCode===206||t.statusCode===0||(n=new Error("XHR Failed with a response of: "+(u&&(i||u.responseText))));r(n,u)}),o=u.abort,u.abort=function(){return u.aborted=!0,o.apply(u,arguments)},u.uri=t.uri,u.requestTime=Date.now(),u}},dpt=function(n,t){return n.start(t)+"-"+n.end(t)},gpt=function(n,t){var i=n.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")},nwt=function(n){return n>=32&&n<126?String.fromCharCode(n):"."},hrt=function(n){var t={};return Object.keys(n).forEach(function(i){var r=n[i];t[i]=ArrayBuffer.isView(r)?{bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:r}),t},tc=function(n){var t=n.byterange||{length:Infinity,offset:0};return[t.length,t.offset,n.resolvedUri].join(",")},crt=function(n){for(var r=Array.prototype.slice.call(n),t=16,u="",f=void 0,e=void 0,i=0;i<r.length/t;i++)f=r.slice(i*t,i*t+t).map(gpt).join(""),e=r.slice(i*t,i*t+t).map(nwt).join(""),u+=f+" "+e+"\n";return u},twt=function(n){var t=n.bytes;return crt(t)},iwt=function(n){for(var i="",t=void 0,t=0;t<n.length;t++)i+=dpt(n,t)+" ";return i},rwt=Object.freeze({createTransferableMessage:hrt,initSegmentId:tc,hexDump:crt,tagDump:twt,textRanges:iwt}),rf=1/30,dr=rf*3,lrt=function(n,t){var u=[],r=void 0;if(n&&n.length)for(r=0;r<n.length;r++)t(n.start(r),n.end(r))&&u.push([n.start(r),n.end(r)]);return i.createTimeRanges(u)},art=function(n,t){return lrt(n,function(n,i){return n-rf<=t&&i+rf>=t})},vrt=function(n,t){return lrt(n,function(n){return n-rf>=t})},uwt=function(n){var r,t,u,f;if(n.length<2)return i.createTimeRanges();for(r=[],t=1;t<n.length;t++)u=n.end(t-1),f=n.start(t),r.push([u,f]);return i.createTimeRanges(r)},ky=function(n){var i=[],t;if(!n||!n.length)return"";for(t=0;t<n.length;t++)i.push(n.start(t)+" => "+n.end(t));return i.join(", ")},fwt=function(n,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1,r=n.length?n.end(n.length-1):0;return(r-t)/i},yrt=function(n){for(var i=[],t=0;t<n.length;t++)i.push({start:n.start(t),end:n.end(t)});return i},ewt=function(n,t,i){var u=t.player_,r,f;if(i.captions&&i.captions.length){n.inbandTextTracks_||(n.inbandTextTracks_={});for(r in i.captionStreams)n.inbandTextTracks_[r]||(u.tech_.trigger({type:"usage",name:"hls-608"}),f=u.textTracks().getTrackById(r),n.inbandTextTracks_[r]=f?f:u.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track)}i.metadata&&i.metadata.length&&!n.metadataTrack_&&(n.metadataTrack_=u.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,n.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType)},uf=function(n,t,i){var u=void 0,r=void 0;if(i&&i.cues)for(u=i.cues.length;u--;)r=i.cues[u],r.startTime<=t&&r.endTime>=n&&i.removeCue(r)},owt=function(n){Object.defineProperties(n.frame,{id:{get:function(){return i.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),n.value.key}},value:{get:function(){return i.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),n.value.data}},privateData:{get:function(){return i.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),n.value.data}}})},prt=function(n){return isNaN(n)||Math.abs(n)===Infinity?Number.MAX_VALUE:n},swt=function(t,i,r){var h=n.WebKitDataCue||n.VTTCue,c,f,e,u,o,s;if(i&&i.forEach(function(n){var t=n.stream;this.inbandTextTracks_[t].addCue(new h(n.startTime+this.timestampOffset,n.endTime+this.timestampOffset,n.text))},t),r&&(c=prt(t.mediaSource_.duration),r.forEach(function(n){var t=n.cueTime+this.timestampOffset;n.frames.forEach(function(n){var i=new h(t,t,n.value||n.url||n.data||"");i.frame=n;i.value=n;owt(i);this.metadataTrack_.addCue(i)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length)){for(f=t.metadataTrack_.cues,e=[],u=0;u<f.length;u++)f[u]&&e.push(f[u]);o=e.reduce(function(n,t){var i=n[t.startTime]||[];return i.push(t),n[t.startTime]=i,n},{});s=Object.keys(o).sort(function(n,t){return Number(n)-Number(t)});s.forEach(function(n,t){var i=o[n],r=Number(s[t+1])||c;i.forEach(function(n){n.endTime=r})})}},gr=typeof window!="undefined"?window:{},dy=typeof Symbol=="undefined"?"__target":Symbol(),hwt="application/javascript",cwt=gr.BlobBuilder||gr.WebKitBlobBuilder||gr.MozBlobBuilder||gr.MSBlobBuilder,ff=gr.URL||gr.webkitURL||ff&&ff.msURL,ef=gr.Worker;if(ef){gy=brt("self.onmessage = function () {}");np=new Uint8Array(1);try{ic=new ef(gy);ic.postMessage(np,[np.buffer])}catch(gti){ef=null}finally{ff.revokeObjectURL(gy);ic&&ic.terminate()}}var awt=new wrt("./transmuxer-worker.worker.js",function(){var n=this,t=function(){var ir=Math.pow(2,32)-1,i,rr,ur,ti,fr,er,or,sr,ii,hr,cr,lr,ar,vr,yr,pr,wr,br,kr,dr,gr,ri,t,ui,nu,tu,iu,ru,uu,fu,eu,ou,ot,su,hu,cu,v,tt,hi,wt,h,bt,ci,li,bu,ku,kt,ft,du,gu,dt;(function(){var n;if(t={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(n in t)t.hasOwnProperty(n)&&(t[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]);ui=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);tu=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);nu=new Uint8Array([0,0,0,1]);iu=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);ru=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);uu={video:iu,audio:ru};ou=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);eu=new Uint8Array([0,0,0,0,0,0,0,0]);ot=new Uint8Array([0,0,0,0,0,0,0,0]);su=ot;hu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);cu=ot;fu=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})();i=function(n){for(var r=[],u=0,i,f,t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)u+=r[t].byteLength;for(i=new Uint8Array(u+8),f=new DataView(i.buffer,i.byteOffset,i.byteLength),f.setUint32(0,i.byteLength),i.set(n,4),t=0,u=8;t<r.length;t++)i.set(r[t],u),u+=r[t].byteLength;return i};rr=function(){return i(t.dinf,i(t.dref,ou))};ur=function(n){return i(t.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,n.audioobjecttype<<3|n.samplingfrequencyindex>>>1,n.samplingfrequencyindex<<7|n.channelcount<<3,6,1,2]))};ti=function(){return i(t.ftyp,ui,nu,ui,tu)};pr=function(n){return i(t.hdlr,uu[n])};fr=function(n){return i(t.mdat,n)};yr=function(n){var r=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,n.duration>>>24&255,n.duration>>>16&255,n.duration>>>8&255,n.duration&255,85,196,0,0]);return n.samplerate&&(r[12]=n.samplerate>>>24&255,r[13]=n.samplerate>>>16&255,r[14]=n.samplerate>>>8&255,r[15]=n.samplerate&255),i(t.mdhd,r)};vr=function(n){return i(t.mdia,yr(n),pr(n.type),or(n))};er=function(n){return i(t.mfhd,new Uint8Array([0,0,0,0,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255]))};or=function(n){return i(t.minf,n.type==="video"?i(t.vmhd,fu):i(t.smhd,eu),rr(),br(n))};sr=function(n,r){for(var f=[],u=r.length;u--;)f[u]=dr(r[u]);return i.apply(null,[t.moof,er(n)].concat(f))};ii=function(n){for(var r=n.length,u=[];r--;)u[r]=lr(n[r]);return i.apply(null,[t.moov,cr(4294967295)].concat(u).concat(hr(n)))};hr=function(n){for(var r=n.length,u=[];r--;)u[r]=gr(n[r]);return i.apply(null,[t.mvex].concat(u))};cr=function(n){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i(t.mvhd,r)};wr=function(n){for(var f=n.samples||[],e=new Uint8Array(4+f.length),u,r=0;r<f.length;r++)u=f[r].flags,e[r+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return i(t.sdtp,e)};br=function(n){return i(t.stbl,kr(n),i(t.stts,cu),i(t.stsc,su),i(t.stsz,hu),i(t.stco,ot))},function(){var n,r;kr=function(u){return i(t.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),u.type==="video"?n(u):r(u))};n=function(n){for(var u=n.sps||[],f=n.pps||[],e=[],o=[],r=0;r<u.length;r++)e.push((u[r].byteLength&65280)>>>8),e.push(u[r].byteLength&255),e=e.concat(Array.prototype.slice.call(u[r]));for(r=0;r<f.length;r++)o.push((f[r].byteLength&65280)>>>8),o.push(f[r].byteLength&255),o=o.concat(Array.prototype.slice.call(f[r]));return i(t.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(n.width&65280)>>8,n.width&255,(n.height&65280)>>8,n.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),i(t.avcC,new Uint8Array([1,n.profileIdc,n.profileCompatibility,n.levelIdc,255].concat([u.length]).concat(e).concat([f.length]).concat(o))),i(t.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))};r=function(n){return i(t.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(n.channelcount&65280)>>8,n.channelcount&255,(n.samplesize&65280)>>8,n.samplesize&255,0,0,0,0,(n.samplerate&65280)>>8,n.samplerate&255,0,0]),ur(n))}}();ar=function(n){var r=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,0,(n.duration&4278190080)>>24,(n.duration&16711680)>>16,(n.duration&65280)>>8,n.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(n.width&65280)>>8,n.width&255,0,0,(n.height&65280)>>8,n.height&255,0,0]);return i(t.tkhd,r)};dr=function(n){var e,o,f,s,h,r,u;return(e=i(t.tfhd,new Uint8Array([0,0,0,58,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),r=Math.floor(n.baseMediaDecodeTime/(ir+1)),u=Math.floor(n.baseMediaDecodeTime%(ir+1)),o=i(t.tfdt,new Uint8Array([1,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255])),h=92,n.type==="audio")?(f=ri(n,h),i(t.traf,e,o,f)):(s=wr(n),f=ri(n,s.length+h),i(t.traf,e,o,f,s))};lr=function(n){return n.duration=n.duration||4294967295,i(t.trak,ar(n),vr(n))};gr=function(n){var r=new Uint8Array([0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return n.type!=="video"&&(r[r.length-1]=0),i(t.trex,r)},function(){var r,u,n;n=function(n,t){var i=0,r=0,u=0,f=0;return n.length&&(n[0].duration!==undefined&&(i=1),n[0].size!==undefined&&(r=2),n[0].flags!==undefined&&(u=4),n[0].compositionTimeOffset!==undefined&&(f=8)),[0,0,i|r|u|f,1,(n.length&4278190080)>>>24,(n.length&16711680)>>>16,(n.length&65280)>>>8,n.length&255,(t&4278190080)>>>24,(t&16711680)>>>16,(t&65280)>>>8,t&255]};u=function(r,u){var o,e,f,s;for(e=r.samples||[],u+=20+16*e.length,o=n(e,u),s=0;s<e.length;s++)f=e[s],o=o.concat([(f.duration&4278190080)>>>24,(f.duration&16711680)>>>16,(f.duration&65280)>>>8,f.duration&255,(f.size&4278190080)>>>24,(f.size&16711680)>>>16,(f.size&65280)>>>8,f.size&255,f.flags.isLeading<<2|f.flags.dependsOn,f.flags.isDependedOn<<6|f.flags.hasRedundancy<<4|f.flags.paddingValue<<1|f.flags.isNonSyncSample,f.flags.degradationPriority&61440,f.flags.degradationPriority&15,(f.compositionTimeOffset&4278190080)>>>24,(f.compositionTimeOffset&16711680)>>>16,(f.compositionTimeOffset&65280)>>>8,f.compositionTimeOffset&255]);return i(t.trun,new Uint8Array(o))};r=function(r,u){var o,e,f,s;for(e=r.samples||[],u+=20+8*e.length,o=n(e,u),s=0;s<e.length;s++)f=e[s],o=o.concat([(f.duration&4278190080)>>>24,(f.duration&16711680)>>>16,(f.duration&65280)>>>8,f.duration&255,(f.size&4278190080)>>>24,(f.size&16711680)>>>16,(f.size&65280)>>>8,f.size&255]);return i(t.trun,new Uint8Array(o))};ri=function(n,t){return n.type==="audio"?r(n,t):u(n,t)}}();var w={ftyp:ti,mdat:fr,moof:sr,moov:ii,initSegment:function(n){var i=ti(),r=ii(n),t;return t=new Uint8Array(i.byteLength+r.byteLength),t.set(i),t.set(r,i.byteLength),t}},cf=function(n){return n>>>0},lf={toUnsigned:cf},b=lf.toUnsigned,s,st,lu,au,vu;s=function(n,t){var r=[],i,f,o,u,e;if(!t.length)return null;for(i=0;i<n.byteLength;)f=b(n[i]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),o=st(n.subarray(i+4,i+8)),u=f>1?i+f:n.byteLength,o===t[0]&&(t.length===1?r.push(n.subarray(i+8,u)):(e=s(n.subarray(i+8,u),t.slice(1)),e.length&&(r=r.concat(e)))),i=u;return r};st=function(n){var t="";return t+=String.fromCharCode(n[0]),t+=String.fromCharCode(n[1]),t+=String.fromCharCode(n[2]),t+String.fromCharCode(n[3])};lu=function(n){var t=s(n,["moov","trak"]);return t.reduce(function(n,t){var r,f,i,e,u;return(r=s(t,["tkhd"])[0],!r)?null:(f=r[0],i=f===0?12:20,e=b(r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]),u=s(t,["mdia","mdhd"])[0],!u)?null:(f=u[0],i=f===0?12:20,n[e]=b(u[i]<<24|u[i+1]<<16|u[i+2]<<8|u[i+3]),n)},{})};au=function(n,t){var r,u,i;return r=s(t,["moof","traf"]),u=[].concat.apply([],r.map(function(t){return s(t,["tfhd"]).map(function(i){var u,f,r;return u=b(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),f=n[u]||9e4,r=s(t,["tfdt"]).map(function(n){var i,t;return i=n[0],t=b(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i===1&&(t*=Math.pow(2,32),t+=b(n[8]<<24|n[9]<<16|n[10]<<8|n[11])),t})[0],r=r||Infinity,r/f})})),i=Math.min.apply(null,u),isFinite(i)?i:0};vu=function(n){var i=s(n,["moov","trak"]),t=[];return i.forEach(function(n){var i=s(n,["mdia","hdlr"]),r=s(n,["tkhd"]);i.forEach(function(n,i){var s=st(n.subarray(8,12)),f=r[i],u,e,o;s==="vide"&&(u=new DataView(f.buffer,f.byteOffset,f.byteLength),e=u.getUint8(0),o=e===0?u.getUint32(12):u.getUint32(20),t.push(o))})}),t};v={findBox:s,parseType:st,timescale:lu,startTime:au,videoTrackIds:vu};tt=function(){this.init=function(){var n={};this.on=function(t,i){n[t]||(n[t]=[]);n[t]=n[t].concat(i)};this.off=function(t,i){var r;return n[t]?(r=n[t].indexOf(i),n[t]=n[t].slice(),n[t].splice(r,1),r>-1):!1};this.trigger=function(t){var r,i,u,f;if(r=n[t],r)if(arguments.length===2)for(u=r.length,i=0;i<u;++i)r[i].call(this,arguments[1]);else{for(f=[],i=arguments.length,i=1;i<arguments.length;++i)f.push(arguments[i]);for(u=r.length,i=0;i<u;++i)r[i].apply(this,f)}};this.dispose=function(){n={}}}};tt.prototype.pipe=function(n){this.on("data",function(t){n.push(t)});this.on("done",function(t){n.flush(t)});return n};tt.prototype.push=function(n){this.trigger("data",n)};tt.prototype.flush=function(n){this.trigger("done",n)};var f=tt,af=function(n){var u,i,t=[],r=[];for(t.byteLength=0,u=0;u<n.length;u++)i=n[u],i.nalUnitType==="access_unit_delimiter_rbsp"?(t.length&&(t.duration=i.dts-t.dts,r.push(t)),t=[i],t.byteLength=i.data.byteLength,t.pts=i.pts,t.dts=i.dts):(i.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(t.keyFrame=!0),t.duration=i.dts-t.dts,t.byteLength+=i.data.byteLength,t.push(i));return r.length&&(!t.duration||t.duration<=0)&&(t.duration=r[r.length-1].duration),r.push(t),r},vf=function(n){var u,r,t=[],i=[];for(t.byteLength=0,t.nalCount=0,t.duration=0,t.pts=n[0].pts,t.dts=n[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=n[0].pts,i.dts=n[0].dts,u=0;u<n.length;u++)r=n[u],r.keyFrame?(t.length&&(i.push(t),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration),t=[r],t.nalCount=r.length,t.byteLength=r.byteLength,t.pts=r.pts,t.dts=r.dts,t.duration=r.duration):(t.duration+=r.duration,t.nalCount+=r.length,t.byteLength+=r.byteLength,t.push(r));return i.length&&t.duration<=0&&(t.duration=i[i.length-1].duration),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration,i.push(t),i},yf=function(n){var t;return!n[0][0].keyFrame&&n.length>1&&(t=n.shift(),n.byteLength-=t.byteLength,n.nalCount-=t.nalCount,n[0][0].dts=t.dts,n[0][0].pts=t.pts,n[0][0].duration+=t.duration),n},pf=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},wf=function(n,t){var i=pf();return i.dataOffset=t,i.compositionTimeOffset=n.pts-n.dts,i.duration=n.duration,i.size=4*n.length,i.size+=n.byteLength,n.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},bf=function(n,t){for(var r,u,f,e,o=t||0,s=[],i=0;i<n.length;i++)for(f=n[i],r=0;r<f.length;r++)e=f[r],u=wf(e,o),o+=u.size,s.push(u);return s},kf=function(n){for(var i,r,e,o,u,f=0,h=n.byteLength,c=n.nalCount,l=h+4*c,s=new Uint8Array(l),a=new DataView(s.buffer),t=0;t<n.length;t++)for(e=n[t],i=0;i<e.length;i++)for(o=e[i],r=0;r<o.length;r++)u=o[r],a.setUint32(f,u.data.byteLength),f+=4,s.set(u.data,f),f+=u.data.byteLength;return s},it={groupNalsIntoFrames:af,groupFramesIntoGops:vf,extendFirstKeyFrame:yf,generateSampleTable:bf,concatenateNalData:kf},df=9e4,gf=function(n,t){typeof t.pts=="number"&&(n.timelineStartInfo.pts===undefined&&(n.timelineStartInfo.pts=t.pts),n.minSegmentPts=n.minSegmentPts===undefined?t.pts:Math.min(n.minSegmentPts,t.pts),n.maxSegmentPts=n.maxSegmentPts===undefined?t.pts:Math.max(n.maxSegmentPts,t.pts));typeof t.dts=="number"&&(n.timelineStartInfo.dts===undefined&&(n.timelineStartInfo.dts=t.dts),n.minSegmentDts=n.minSegmentDts===undefined?t.dts:Math.min(n.minSegmentDts,t.dts),n.maxSegmentDts=n.maxSegmentDts===undefined?t.dts:Math.max(n.maxSegmentDts,t.dts))},ne=function(n){delete n.minSegmentDts;delete n.maxSegmentDts;delete n.minSegmentPts;delete n.maxSegmentPts},te=function(n,t){var i,r,u=n.minSegmentDts;return t||(u-=n.timelineStartInfo.dts),i=n.timelineStartInfo.baseMediaDecodeTime,i+=u,i=Math.max(0,i),n.type==="audio"&&(r=n.samplerate/df,i*=r,i=Math.floor(i)),i},l={clearDtsInfo:ne,calculateTrackBaseMediaDecodeTime:te,collectDtsInfo:gf},yu=4,ie=128,re=function(n){for(var t=0,r={payloadType:-1,payloadSize:0},u=0,i=0;t<n.byteLength;){if(n[t]===ie)break;while(n[t]===255)u+=255,t++;for(u+=n[t++];n[t]===255;)i+=255,t++;if(i+=n[t++],!r.payload&&u===yu){r.payloadType=u;r.payloadSize=i;r.payload=n.subarray(t,t+i);break}t+=i;u=0;i=0}return r},ue=function(n){return n.payload[0]!==181?null:(n.payload[1]<<8|n.payload[2])!=49?null:String.fromCharCode(n.payload[3],n.payload[4],n.payload[5],n.payload[6])!=="GA94"?null:n.payload[7]!==3?null:n.payload.subarray(8,n.payload.length-1)},fe=function(n,t){var u=[],r,e,i,f;if(!(t[0]&64))return u;for(e=t[0]&31,r=0;r<e;r++)i=r*3,f={type:t[i+2]&3,pts:n},t[i+2]&4&&(f.ccData=t[i+3]<<8|t[i+4],u.push(f));return u},ee=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f},rt={parseSei:re,parseUserData:ue,parseCaptionPackets:fe,discardEmulationPreventionBytes:ee,USER_DATA_REGISTERED_ITU_T_T35:yu},a=function a(){a.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new u(0,0),new u(0,1),new u(1,0),new u(1,1)];this.reset();this.ccStreams_.forEach(function(n){n.on("data",this.trigger.bind(this,"data"));n.on("done",this.trigger.bind(this,"done"))},this)};a.prototype=new f;a.prototype.push=function(n){var t,i,r;if(n.nalUnitType==="sei_rbsp"&&(t=rt.parseSei(n.escapedRBSP),t.payloadType===rt.USER_DATA_REGISTERED_ITU_T_T35)&&(i=rt.parseUserData(t),i)){if(n.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}if(n.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}r=rt.parseCaptionPackets(n.pts,i);this.captionPackets_=this.captionPackets_.concat(r);this.latestDts_!==n.dts&&(this.numSameDts_=0);this.numSameDts_++;this.latestDts_=n.dts}};a.prototype.flush=function(){if(!this.captionPackets_.length){this.ccStreams_.forEach(function(n){n.flush()},this);return}this.captionPackets_.forEach(function(n,t){n.presortIndex=t});this.captionPackets_.sort(function(n,t){return n.pts===t.pts?n.presortIndex-t.presortIndex:n.pts-t.pts});this.captionPackets_.forEach(function(n){n.type<2&&this.dispatchCea608Packet(n)},this);this.captionPackets_.length=0;this.ccStreams_.forEach(function(n){n.flush()},this);return};a.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(n){n.reset()})};a.prototype.dispatchCea608Packet=function(n){(this.setsChannel1Active(n)?this.activeCea608Channel_[n.type]=0:this.setsChannel2Active(n)&&(this.activeCea608Channel_[n.type]=1),this.activeCea608Channel_[n.type]!==null)&&this.ccStreams_[(n.type<<1)+this.activeCea608Channel_[n.type]].push(n)};a.prototype.setsChannel1Active=function(n){return(n.ccData&30720)==4096};a.prototype.setsChannel2Active=function(n){return(n.ccData&30720)==6144};var oe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ht=function(n){return n===null?"":(n=oe[n]||n,String.fromCharCode(n))},ct=14,se=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],p=function(){for(var n=[],t=ct+1;t--;)n.push("");return n},u=function u(n,t){u.prototype.init.call(this);this.field_=n||0;this.dataChannel_=t||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(n){var t,e,r,i,u,f;if(t=n.ccData&32639,t===this.lastControlCode_){this.lastControlCode_=null;return}((t&61440)==4096?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=t&255,t!==this.PADDING_)&&(t===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":t===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(n.pts),this.flushDisplayed(n.pts),e=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=e,this.startPts_=n.pts):t===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(n.pts)):t===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(n.pts)):t===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(n.pts)):t===this.CARRIAGE_RETURN_?(this.clearFormatting(n.pts),this.flushDisplayed(n.pts),this.shiftRowsUp_(),this.startPts_=n.pts):t===this.BACKSPACE_?this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):t===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(n.pts),this.displayed_=p()):t===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=p():t===this.RESUME_DIRECT_CAPTIONING_?(this.mode_!=="paintOn"&&(this.flushDisplayed(n.pts),this.displayed_=p()),this.mode_="paintOn",this.startPts_=n.pts):this.isSpecialCharacter(r,i)?(r=(r&3)<<8,u=ht(r|i),this[this.mode_](n.pts,u),this.column_++):this.isExtCharacter(r,i)?(this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),r=(r&3)<<8,u=ht(r|i),this[this.mode_](n.pts,u),this.column_++):this.isMidRowCode(r,i)?(this.clearFormatting(n.pts),this[this.mode_](n.pts," "),this.column_++,(i&14)==14&&this.addFormatting(n.pts,["i"]),(i&1)==1&&this.addFormatting(n.pts,["u"])):this.isOffsetControlCode(r,i)?this.column_+=i&3:this.isPAC(r,i)?(f=se.indexOf(t&7968),this.mode_==="rollUp"&&this.setRollUp(n.pts,f),f!==this.row_&&(this.clearFormatting(n.pts),this.row_=f),i&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(n.pts,["u"]),(t&16)==16&&(this.column_=((t&14)>>1)*4),this.isColorPAC(i)&&(i&14)==14&&this.addFormatting(n.pts,["i"])):this.isNormalChar(r)&&(i===0&&(i=null),u=ht(r),u+=ht(i),this[this.mode_](n.pts,u),this.column_+=u.length))}};u.prototype=new f;u.prototype.flushDisplayed=function(n){var t=this.displayed_.map(function(n){return n.trim()}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:n,text:t,stream:this.name_})};u.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=p();this.nonDisplayed_=p();this.lastControlCode_=null;this.column_=0;this.row_=ct;this.rollUpRows_=2;this.formatting_=[]};u.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31);this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};u.prototype.isSpecialCharacter=function(n,t){return n===this.EXT_&&t>=48&&t<=63};u.prototype.isExtCharacter=function(n,t){return(n===this.EXT_+1||n===this.EXT_+2)&&t>=32&&t<=63};u.prototype.isMidRowCode=function(n,t){return n===this.EXT_&&t>=32&&t<=47};u.prototype.isOffsetControlCode=function(n,t){return n===this.OFFSET_&&t>=33&&t<=35};u.prototype.isPAC=function(n,t){return n>=this.BASE_&&n<this.BASE_+8&&t>=64&&t<=127};u.prototype.isColorPAC=function(n){return n>=64&&n<=79||n>=96&&n<=127};u.prototype.isNormalChar=function(n){return n>=32&&n<=127};u.prototype.setRollUp=function(n,t){if(this.mode_!=="rollUp"&&(this.row_=ct,this.mode_="rollUp",this.flushDisplayed(n),this.nonDisplayed_=p(),this.displayed_=p()),t!==undefined&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";t===undefined&&(t=this.row_);this.topRow_=t-this.rollUpRows_+1};u.prototype.addFormatting=function(n,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(n,t){return n+"<"+t+">"},"");this[this.mode_](n,i)};u.prototype.clearFormatting=function(n){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(n,t){return n+"<\/"+t+">"},"");this.formatting_=[];this[this.mode_](n,t)}};u.prototype.popOn=function(n,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};u.prototype.rollUp=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};u.prototype.shiftRowsUp_=function(){for(var n=0;n<this.topRow_;n++)this.displayed_[n]="";for(n=this.row_+1;n<ct+1;n++)this.displayed_[n]="";for(n=this.topRow_;n<this.row_;n++)this.displayed_[n]=this.displayed_[n+1];this.displayed_[this.row_]=""};u.prototype.paintOn=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var fi={CaptionStream:a,Cea608Stream:u},o={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},he=8589934592,ce=4294967296,ei=function(n,t){var i=1;for(n>t&&(i=-1);Math.abs(t-n)>ce;)n+=i*he;return n},oi=function oi(n){var i,t;oi.prototype.init.call(this);this.type_=n;this.push=function(n){n.type===this.type_&&(t===undefined&&(t=n.dts),n.dts=ei(n.dts,t),n.pts=ei(n.pts,t),i=n.dts,this.trigger("data",n))};this.flush=function(){t=i;this.trigger("done")};this.discontinuity=function(){t=void 0;i=void 0}};oi.prototype=new f;var le={TimestampRolloverStream:oi,handleRollover:ei},pu=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},lt=function(n,t,i){return decodeURIComponent(pu(n,t,i))},ae=function(n,t,i){return unescape(pu(n,t,i))},at=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},wu={TXXX:function(n){var t;if(n.data[0]===3){for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=lt(n.data,1,t);n.value=lt(n.data,t+1,n.data.length).replace(/\0*$/,"");break}n.data=n.value}},WXXX:function(n){var t;if(n.data[0]===3)for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=lt(n.data,1,t);n.url=lt(n.data,t+1,n.data.length);break}},PRIV:function(n){for(var t=0;t<n.data.length;t++)if(n.data[t]===0){n.owner=ae(n.data,0,t);break}n.privateData=n.data.subarray(t+1);n.data=n.privateData}},vt;vt=function(n){var r={debug:!!(n&&n.debug),descriptor:n&&n.descriptor},i=0,t=[],u=0,f;if(vt.prototype.init.call(this),this.dispatchType=o.METADATA_STREAM_TYPE.toString(16),r.descriptor)for(f=0;f<r.descriptor.length;f++)this.dispatchType+=("00"+r.descriptor[f].toString(16)).slice(-2);this.push=function(n){var f,e,c,o,h,a,s,l;if(n.type==="timed-metadata"){if(n.dataAlignmentIndicator&&(u=0,t.length=0),t.length===0&&(n.data.length<10||n.data[0]!=="I".charCodeAt(0)||n.data[1]!=="D".charCodeAt(0)||n.data[2]!=="3".charCodeAt(0))){r.debug&&console.log("Skipping unrecognized metadata packet");return}if(t.push(n),u+=n.data.byteLength,t.length===1&&(i=at(n.data.subarray(6,10))+10),!(u<i)){for(f={data:new Uint8Array(i),frames:[],pts:t[0].pts,dts:t[0].dts},h=0;h<i;)f.data.set(t[0].data.subarray(0,i-h),h),h+=t[0].data.byteLength,u-=t[0].data.byteLength,t.shift();e=10;f.data[5]&64&&(e+=4,e+=at(f.data.subarray(10,14)),i-=at(f.data.subarray(16,20)));do{if(c=at(f.data.subarray(e+4,e+8)),c<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");a=String.fromCharCode(f.data[e],f.data[e+1],f.data[e+2],f.data[e+3]);o={id:a,data:f.data.subarray(e+10,e+c+10)};o.key=o.id;wu[o.id]&&(wu[o.id](o),o.owner==="com.apple.streaming.transportStreamTimestamp"&&(s=o.data,l=(s[3]&1)<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2,l*=4,l+=s[7]&3,o.timeStamp=l,f.pts===undefined&&f.dts===undefined&&(f.pts=o.timeStamp,f.dts=o.timeStamp),this.trigger("timestamp",o)));f.frames.push(o);e+=10;e+=c}while(e<i);this.trigger("data",f)}}}};vt.prototype=new f;var ve=vt,ye=le.TimestampRolloverStream,yt,ut,pt,k=188,si=71;yt=function(){var t=new Uint8Array(k),n=0;yt.prototype.init.call(this);this.push=function(i){var u=0,f=k,r;for(n?(r=new Uint8Array(i.byteLength+n),r.set(t.subarray(0,n)),r.set(i,n),n=0):r=i;f<r.byteLength;){if(r[u]===si&&r[f]===si){this.trigger("data",r.subarray(u,f));u+=k;f+=k;continue}u++;f++}u<r.byteLength&&(t.set(r.subarray(u),0),n=r.byteLength-u)};this.flush=function(){n===k&&t[0]===si&&(this.trigger("data",t),n=0);this.trigger("done")}};yt.prototype=new f;ut=function(){var t,i,r,n;ut.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function(n,t){var u=0;t.payloadUnitStartIndicator&&(u+=n[u]+1);t.type==="pat"?i(n.subarray(u),t):r(n.subarray(u),t)};i=function(t,i){i.section_number=t[7];i.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];i.pmtPid=n.pmtPid};r=function(t,i){var e,s,h,r,u,f;if(t[5]&1){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},e=(t[1]&15)<<8|t[2],s=3+e-4,h=(t[10]&15)<<8|t[11],r=12+h;r<s;)u=t[r],f=(t[r+1]&31)<<8|t[r+2],u===o.H264_STREAM_TYPE&&n.programMapTable.video===null?n.programMapTable.video=f:u===o.ADTS_STREAM_TYPE&&n.programMapTable.audio===null?n.programMapTable.audio=f:u===o.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][f]=u),r+=((t[r+3]&15)<<8|t[r+4])+5;i.programMapTable=n.programMapTable}};this.push=function(n){var i={},r=4;if(i.payloadUnitStartIndicator=!!(n[1]&64),i.pid=n[1]&31,i.pid<<=8,i.pid|=n[2],(n[3]&48)>>>4>1&&(r+=n[r]+1),i.pid===0)i.type="pat",t(n.subarray(r),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",t(n.subarray(r),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===undefined?this.packetsWaitingForPmt.push([n,r,i]):this.processPes_(n,r,i)};this.processPes_=function(n,t,i){i.streamType=i.pid===this.programMapTable.video?o.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?o.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid];i.type="pes";i.data=n.subarray(t);this.trigger("data",i)}};ut.prototype=new f;ut.STREAM_TYPES={h264:27,adts:15};pt=function(){var t=this,i={data:[],size:0},r={data:[],size:0},u={data:[],size:0},f=function(n,t){var i;t.packetLength=6+(n[4]<<8|n[5]);t.dataAlignmentIndicator=(n[6]&4)!=0;i=n[7];i&192&&(t.pts=(n[9]&14)<<27|(n[10]&255)<<20|(n[11]&254)<<12|(n[12]&255)<<5|(n[13]&254)>>>3,t.pts*=4,t.pts+=(n[13]&6)>>>1,t.dts=t.pts,i&64&&(t.dts=(n[14]&14)<<27|(n[15]&255)<<20|(n[16]&254)<<12|(n[17]&255)<<5|(n[18]&254)>>>3,t.dts*=4,t.dts+=(n[18]&6)>>>1));t.data=n.subarray(9+n[8])},n=function(n,i,r){var h=new Uint8Array(n.size),u={type:i},e=0,c=0,o=!1,s;if(n.data.length&&!(n.size<9)){for(u.trackId=n.data[0].pid,e=0;e<n.data.length;e++)s=n.data[e],h.set(s.data,c),c+=s.data.byteLength;f(h,u);o=i==="video"||u.packetLength<=n.size;(r||o)&&(n.size=0,n.data.length=0);o&&t.trigger("data",u)}};pt.prototype.init.call(this);this.push=function(f){({pat:function(){},pes:function(){var t,e;switch(f.streamType){case o.H264_STREAM_TYPE:case o.H264_STREAM_TYPE:t=i;e="video";break;case o.ADTS_STREAM_TYPE:t=r;e="audio";break;case o.METADATA_STREAM_TYPE:t=u;e="timed-metadata";break;default:return}f.payloadUnitStartIndicator&&n(t,e,!0);t.data.push(f);t.size+=f.data.byteLength},pmt:function(){var i={type:"metadata",tracks:[]},n=f.programMapTable;n.video!==null&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"});n.audio!==null&&i.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"});t.trigger("data",i)}})[f.type]()};this.flush=function(){n(i,"video");n(r,"audio");n(u,"timed-metadata");this.trigger("done")}};pt.prototype=new f;hi={PAT_PID:0,MP2T_PACKET_LENGTH:k,TransportPacketStream:yt,TransportParseStream:ut,ElementaryStream:pt,TimestampRolloverStream:ye,CaptionStream:fi.CaptionStream,Cea608Stream:fi.Cea608Stream,MetadataStream:ve};for(wt in o)o.hasOwnProperty(wt)&&(hi[wt]=o[wt]);h=hi;ci=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];bt=function(){var n;bt.prototype.init.call(this);this.push=function(t){var i=0,f=0,s,h,r,u,e,o;if(t.type==="audio")for(n?(u=n,n=new Uint8Array(u.byteLength+t.data.byteLength),n.set(u),n.set(t.data,u.byteLength)):n=t.data;i+5<n.length;){if(n[i]!==255||(n[i+1]&246)!=240){i++;continue}if(h=(~n[i+1]&1)*2,s=(n[i+3]&3)<<11|n[i+4]<<3|(n[i+5]&224)>>5,e=((n[i+6]&3)+1)*1024,o=e*9e4/ci[(n[i+2]&60)>>>2],r=i+s,n.byteLength<r)return;if(this.trigger("data",{pts:t.pts+f*o,dts:t.dts+f*o,sampleCount:e,audioobjecttype:(n[i+2]>>>6&3)+1,channelcount:(n[i+2]&1)<<2|(n[i+3]&192)>>>6,samplerate:ci[(n[i+2]&60)>>>2],samplingfrequencyindex:(n[i+2]&60)>>>2,samplesize:16,data:n.subarray(i+7+h,r)}),n.byteLength===r){n=undefined;return}f++;n=n.subarray(r)}};this.flush=function(){this.trigger("done")}};bt.prototype=new f;li=bt;bu=function(n){var i=n.byteLength,r=0,t=0;this.length=function(){return 8*i};this.bitsAvailable=function(){return 8*i+t};this.loadWord=function(){var f=n.byteLength-i,e=new Uint8Array(4),u=Math.min(4,i);if(u===0)throw new Error("no bytes available");e.set(n.subarray(f,f+u));r=new DataView(e.buffer).getUint32(0);t=u*8;i-=u};this.skipBits=function(n){var u;t>n?(r<<=n,t-=n):(n-=t,u=Math.floor(n/8),n-=u*8,i-=u,this.loadWord(),r<<=n,t-=n)};this.readBits=function(n){var u=Math.min(t,n),f=r>>>32-u;return(t-=u,t>0?r<<=u:i>0&&this.loadWord(),u=n-u,u>0)?f<<u|this.readBits(u):f};this.skipLeadingZeros=function(){for(var n=0;n<t;++n)if((r&2147483648>>>n)!=0)return r<<=n,t-=n,n;return this.loadWord(),n+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var n=this.skipLeadingZeros();return this.readBits(n+1)-1};this.readExpGolomb=function(){var n=this.readUnsignedExpGolomb();return 1&n?1+n>>>1:-1*(n>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};ku=bu;ft=function(){var i=0,t,n;ft.prototype.init.call(this);this.push=function(r){var u;for(n?(u=new Uint8Array(n.byteLength+r.data.byteLength),u.set(n),u.set(r.data,n.byteLength),n=u):n=r.data;i<n.byteLength-3;i++)if(n[i+2]===1){t=i+5;break}while(t<n.byteLength)switch(n[t]){case 0:if(n[t-1]!==0){t+=2;break}else if(n[t-2]!==0){t++;break}i+3!==t-2&&this.trigger("data",n.subarray(i+3,t-2));do t++;while(n[t]!==1&&t<n.length);i=t-2;t+=3;break;case 1:if(n[t-1]!==0||n[t-2]!==0){t+=3;break}this.trigger("data",n.subarray(i+3,t-2));i=t-2;t+=3;break;default:t+=3}n=n.subarray(i);t-=i;i=0};this.flush=function(){n&&n.byteLength>3&&this.trigger("data",n.subarray(i+3));n=null;i=0;this.trigger("done")}};ft.prototype=new f;du={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};kt=function(){var n=new ft,t,u,f,e,i,o,r;kt.prototype.init.call(this);t=this;this.push=function(t){t.type==="video"&&(u=t.trackId,f=t.pts,e=t.dts,n.push(t))};n.on("data",function(n){var r={trackId:u,pts:f,dts:e,data:n};switch(n[0]&31){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp";r.escapedRBSP=i(n.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp";r.escapedRBSP=i(n.subarray(1));r.config=o(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",r)});n.on("done",function(){t.trigger("done")});this.flush=function(){n.flush()};r=function(n,t){for(var r=8,i=8,f,u=0;u<n;u++)i!==0&&(f=t.readExpGolomb(),i=(r+f+256)%256),r=i===0?r:i};i=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f};o=function(n){var h=0,c=0,l=0,a=0,v=1,t,f,y,p,e,o,w,b,k,s,d,i,g,u;if(t=new ku(n),f=t.readUnsignedByte(),p=t.readUnsignedByte(),y=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),du[f]&&(e=t.readUnsignedExpGolomb(),e===3&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=e!==3?8:12,u=0;u<d;u++)t.readBoolean()&&(u<6?r(16,t):r(64,t));if(t.skipUnsignedExpGolomb(),o=t.readUnsignedExpGolomb(),o===0)t.readUnsignedExpGolomb();else if(o===1)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),w=t.readUnsignedExpGolomb(),u=0;u<w;u++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),b=t.readUnsignedExpGolomb(),k=t.readUnsignedExpGolomb(),s=t.readBits(1),s===0&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(h=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),l=t.readUnsignedExpGolomb(),a=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){g=t.readUnsignedByte();switch(g){case 1:i=[1,1];break;case 2:i=[12,11];break;case 3:i=[10,11];break;case 4:i=[16,11];break;case 5:i=[40,33];break;case 6:i=[24,11];break;case 7:i=[20,11];break;case 8:i=[32,11];break;case 9:i=[80,33];break;case 10:i=[18,11];break;case 11:i=[15,11];break;case 12:i=[64,33];break;case 13:i=[160,99];break;case 14:i=[4,3];break;case 15:i=[3,2];break;case 16:i=[2,1];break;case 255:i=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}i&&(v=i[0]/i[1])}return{profileIdc:f,levelIdc:y,profileCompatibility:p,width:Math.ceil(((b+1)*16-h*2-c*2)*v),height:(2-s)*(k+1)*16-l*2-a*2}}};kt.prototype=new f;gu={H264Stream:kt,NalByteStream:ft};dt=function(){var n=new Uint8Array,t=0;dt.prototype.init.call(this);this.setTimestamp=function(n){t=n};this.parseId3TagSize=function(n,t){var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],r=n[t+5],u=(r&16)>>4;return u?i+20:i+10};this.parseAdtsSize=function(n,t){var i=(n[t+5]&224)>>5,r=n[t+4]<<3,u=n[t+3]&6144;return u|r|i};this.push=function(i){var u=0,r=0,e,o,s,f;for(n.length?(f=n.length,n=new Uint8Array(i.byteLength+f),n.set(n.subarray(0,f)),n.set(i,f)):n=i;n.length-r>=3;){if(n[r]==="I".charCodeAt(0)&&n[r+1]==="D".charCodeAt(0)&&n[r+2]==="3".charCodeAt(0)){if(n.length-r<10)break;if(u=this.parseId3TagSize(n,r),u>n.length)break;o={type:"timed-metadata",data:n.subarray(r,r+u)};this.trigger("data",o);r+=u;continue}else if(n[r]&!0&&(n[r+1]&240)==240){if(n.length-r<7)break;if(u=this.parseAdtsSize(n,r),u>n.length)break;s={type:"audio",data:n.subarray(r,r+u),pts:t,dts:t};this.trigger("data",s);r+=u;continue}r++}e=n.length-r;n=e>0?n.subarray(r):new Uint8Array}};dt.prototype=new f;var pe=dt,y=[33,16,5,32,164,27],ai=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],r=function(n){for(var t=[];n--;)t.push(0);return t},we=function(n){return Object.keys(n).reduce(function(t,i){return t[i]=new Uint8Array(n[i].reduce(function(n,t){return n.concat(t)},[])),t},{})},be={96e3:[y,[227,64],r(154),[56]],88200:[y,[231],r(170),[56]],64e3:[y,[248,192],r(240),[56]],48e3:[y,[255,192],r(268),[55,148,128],r(54),[112]],44100:[y,[255,192],r(268),[55,163,128],r(84),[112]],32e3:[y,[255,192],r(268),[55,234],r(226),[112]],24e3:[y,[255,192],r(268),[55,255,128],r(268),[111,112],r(126),[224]],16e3:[y,[255,192],r(268),[55,255,128],r(268),[111,255],r(269),[223,108],r(195),[1,192]],12e3:[ai,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,253,128],r(259),[56]],11025:[ai,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,255,192],r(268),[55,175,128],r(108),[112]],8e3:[ai,r(268),[3,121,16],r(47),[7]]},ke=we(be),nf=9e4,vi,yi,pi,wi,tf,rf;vi=function(n){return n*nf};yi=function(n,t){return n*t};pi=function(n){return n/nf};wi=function(n,t){return n/t};tf=function(n,t){return vi(wi(n,t))};rf=function(n,t){return yi(pi(n),t)};var uf={secondsToVideoTs:vi,secondsToAudioTs:yi,videoTsToSeconds:pi,audioTsToSeconds:wi,audioTsToVideoTs:tf,videoTsToAudioTs:rf},de=gu.H264Stream,bi=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ki=["width","height","profileIdc","levelIdc","profileCompatibility"],ff=9e4,et,d,gt,g,ef,di,of;ef=function(n){return n[0]==="I".charCodeAt(0)&&n[1]==="D".charCodeAt(0)&&n[2]==="3".charCodeAt(0)?!0:!1};di=function(n,t){var i;if(n.length!==t.length)return!1;for(i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0};of=function(n){for(var i,r=0,t=0;t<n.length;t++)i=n[t],r+=i.data.byteLength;return r};d=function(n,t){var i=[],e=0,r=0,u=0,f=Infinity;t=t||{};d.prototype.init.call(this);this.push=function(t){l.collectDtsInfo(n,t);n&&bi.forEach(function(i){n[i]=t[i]});i.push(t)};this.setEarliestDts=function(t){r=t-n.timelineStartInfo.baseMediaDecodeTime};this.setVideoBaseMediaDecodeTime=function(n){f=n};this.setAudioAppendStart=function(n){u=n};this.flush=function(){var r,u,o,f;if(i.length===0){this.trigger("done","AudioSegmentStream");return}r=this.trimAdtsFramesByEarliestDts_(i);n.baseMediaDecodeTime=l.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);this.prefixWithSilence_(n,r);n.samples=this.generateSampleTable_(r);o=w.mdat(this.concatenateFrameData_(r));i=[];u=w.moof(e,[n]);f=new Uint8Array(u.byteLength+o.byteLength);e++;f.set(u);f.set(o,u.byteLength);l.clearDtsInfo(n);this.trigger("data",{track:n,boxes:f});this.trigger("done","AudioSegmentStream")};this.prefixWithSilence_=function(n,t){var h,o=0,c=0,i=0,s=0,r,e;if(t.length&&(h=uf.audioTsToVideoTs(n.baseMediaDecodeTime,n.samplerate),o=Math.ceil(ff/(n.samplerate/1024)),u&&f&&(c=h-Math.max(u,f),i=Math.floor(c/o),s=i*o),!(i<1)&&!(s>ff/2))){for(r=ke[n.samplerate],r||(r=t[0].data),e=0;e<i;e++)t.splice(e,0,{data:r});n.baseMediaDecodeTime-=Math.floor(uf.videoTsToAudioTs(s,n.samplerate))}};this.trimAdtsFramesByEarliestDts_=function(t){return n.minSegmentDts>=r?t:(n.minSegmentDts=Infinity,t.filter(function(t){return t.dts>=r?(n.minSegmentDts=Math.min(n.minSegmentDts,t.dts),n.minSegmentPts=n.minSegmentDts,!0):!1}))};this.generateSampleTable_=function(n){for(var i,r=[],t=0;t<n.length;t++)i=n[t],r.push({size:i.data.byteLength,duration:1024});return r};this.concatenateFrameData_=function(n){for(var i,r=0,u=new Uint8Array(of(n)),t=0;t<n.length;t++)i=n[t],u.set(i.data,r),r+=i.data.byteLength;return u}};d.prototype=new f;et=function(n,t){var e=0,i=[],r=[],u,f;t=t||{};et.prototype.init.call(this);delete n.minPTS;this.gopCache_=[];this.push=function(t){l.collectDtsInfo(n,t);t.nalUnitType!=="seq_parameter_set_rbsp"||u||(u=t.config,n.sps=[t.data],ki.forEach(function(t){n[t]=u[t]},this));t.nalUnitType!=="pic_parameter_set_rbsp"||f||(f=t.data,n.pps=[t.data]);i.push(t)};this.flush=function(){for(var a,f,u,o,h,s,c;i.length;){if(i[0].nalUnitType==="access_unit_delimiter_rbsp")break;i.shift()}if(i.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}if(a=it.groupNalsIntoFrames(i),u=it.groupFramesIntoGops(a),u[0][0].keyFrame||(f=this.getGopForFusion_(i[0],n),f?(u.unshift(f),u.byteLength+=f.byteLength,u.nalCount+=f.nalCount,u.pts=f.pts,u.dts=f.dts,u.duration+=f.duration):u=it.extendFirstKeyFrame(u)),r.length){if(c=t.alignGopsAtEnd?this.alignGopsAtEnd_(u):this.alignGopsAtStart_(u),!c){this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}l.clearDtsInfo(n);u=c}l.collectDtsInfo(n,u);n.samples=it.generateSampleTable(u);h=w.mdat(it.concatenateNalData(u));n.baseMediaDecodeTime=l.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",u.map(function(n){return{pts:n.pts,dts:n.dts,byteLength:n.byteLength}}));this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.trigger("baseMediaDecodeTime",n.baseMediaDecodeTime);this.trigger("timelineStartInfo",n.timelineStartInfo);o=w.moof(e,[n]);s=new Uint8Array(o.byteLength+h.byteLength);e++;s.set(o);s.set(h,o.byteLength);this.trigger("data",{track:n,boxes:s});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.resetStream_=function(){l.clearDtsInfo(n);u=undefined;f=undefined};this.getGopForFusion_=function(t){for(var o=Infinity,i,u,f,r,e=0;e<this.gopCache_.length;e++)(r=this.gopCache_[e],f=r.gop,n.pps&&di(n.pps[0],r.pps[0])&&n.sps&&di(n.sps[0],r.sps[0]))&&(f.dts<n.timelineStartInfo.dts||(i=t.dts-f.dts-f.duration,i>=-1e4&&i<=45e3&&(!u||o>i)&&(u=r,o=i)));return u?u.gop:null};this.alignGopsAtStart_=function(n){var f,i,e,u,o,s,h,t;for(o=n.byteLength,s=n.nalCount,h=n.duration,f=i=0;f<r.length&&i<n.length;){if(e=r[f],u=n[i],e.pts===u.pts)break;if(u.pts>e.pts){f++;continue}i++;o-=u.byteLength;s-=u.nalCount;h-=u.duration}return i===0?n:i===n.length?null:(t=n.slice(i),t.byteLength=o,t.duration=h,t.nalCount=s,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsAtEnd_=function(n){var u,i,s,h,f,e,c,t,o;for(u=r.length-1,i=n.length-1,f=null,e=!1;u>=0&&i>=0;){if(s=r[u],h=n[i],s.pts===h.pts){e=!0;break}if(s.pts>h.pts){u--;continue}u===r.length-1&&(f=i);i--}return!e&&f===null?null:(c=e?i:f,c===0)?n:(t=n.slice(c),o=t.reduce(function(n,t){return n.byteLength+=t.byteLength,n.duration+=t.duration,n.nalCount+=t.nalCount,n},{byteLength:0,duration:0,nalCount:0}),t.byteLength=o.byteLength,t.duration=o.duration,t.nalCount=o.nalCount,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsWith=function(n){r=n}};et.prototype=new f;g=function(n,t){this.numberOfTracks=0;this.metadataStream=t;this.remuxTracks=typeof n.remux!="undefined"?!!n.remux:!0;this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;g.prototype.init.call(this);this.push=function(n){if(n.text)return this.pendingCaptions.push(n);if(n.frames)return this.pendingMetadata.push(n);this.pendingTracks.push(n.track);this.pendingBoxes.push(n.boxes);this.pendingBytes+=n.boxes.byteLength;n.track.type==="video"&&(this.videoTrack=n.track);n.track.type==="audio"&&(this.audioTrack=n.track)}};g.prototype=new f;g.prototype.flush=function(n){var o=0,i={captions:[],captionStreams:{},metadata:[],info:{}},r,u,e,f=0,t;if(this.pendingTracks.length<this.numberOfTracks){if(n!=="VideoSegmentStream"&&n!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++;this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}for(this.videoTrack?(f=this.videoTrack.timelineStartInfo.pts,ki.forEach(function(n){i.info[n]=this.videoTrack[n]},this)):this.audioTrack&&(f=this.audioTrack.timelineStartInfo.pts,bi.forEach(function(n){i.info[n]=this.audioTrack[n]},this)),i.type=this.pendingTracks.length===1?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,e=w.initSegment(this.pendingTracks),i.initSegment=new Uint8Array(e.byteLength),i.initSegment.set(e),i.data=new Uint8Array(this.pendingBytes),t=0;t<this.pendingBoxes.length;t++)i.data.set(this.pendingBoxes[t],o),o+=this.pendingBoxes[t].byteLength;for(t=0;t<this.pendingCaptions.length;t++)r=this.pendingCaptions[t],r.startTime=r.startPts-f,r.startTime/=9e4,r.endTime=r.endPts-f,r.endTime/=9e4,i.captionStreams[r.stream]=!0,i.captions.push(r);for(t=0;t<this.pendingMetadata.length;t++)u=this.pendingMetadata[t],u.cueTime=u.pts-f,u.cueTime/=9e4,i.metadata.push(u);i.metadata.dispatchType=this.metadataStream.dispatchType;this.pendingTracks.length=0;this.videoTrack=null;this.pendingBoxes.length=0;this.pendingCaptions.length=0;this.pendingBytes=0;this.pendingMetadata.length=0;this.trigger("data",i);this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)};gt=function(n){var r=this,u=!0,i,t;gt.prototype.init.call(this);n=n||{};this.baseMediaDecodeTime=n.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i;i.type="aac";i.metadataStream=new h.MetadataStream;i.aacStream=new pe;i.audioTimestampRolloverStream=new h.TimestampRolloverStream("audio");i.timedMetadataTimestampRolloverStream=new h.TimestampRolloverStream("timed-metadata");i.adtsStream=new li;i.coalesceStream=new g(n,i.metadataStream);i.headOfPipeline=i.aacStream;i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream);i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream);i.metadataStream.on("timestamp",function(n){i.aacStream.setTimestamp(n.timeStamp)});i.aacStream.on("data",function(u){u.type!=="timed-metadata"||i.audioSegmentStream||(t=t||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new d(t,n),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream))});i.coalesceStream.on("data",this.trigger.bind(this,"data"));i.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var u={};this.transmuxPipeline_=u;u.type="ts";u.metadataStream=new h.MetadataStream;u.packetStream=new h.TransportPacketStream;u.parseStream=new h.TransportParseStream;u.elementaryStream=new h.ElementaryStream;u.videoTimestampRolloverStream=new h.TimestampRolloverStream("video");u.audioTimestampRolloverStream=new h.TimestampRolloverStream("audio");u.timedMetadataTimestampRolloverStream=new h.TimestampRolloverStream("timed-metadata");u.adtsStream=new li;u.h264Stream=new de;u.captionStream=new h.CaptionStream;u.coalesceStream=new g(n,u.metadataStream);u.headOfPipeline=u.packetStream;u.packetStream.pipe(u.parseStream).pipe(u.elementaryStream);u.elementaryStream.pipe(u.videoTimestampRolloverStream).pipe(u.h264Stream);u.elementaryStream.pipe(u.audioTimestampRolloverStream).pipe(u.adtsStream);u.elementaryStream.pipe(u.timedMetadataTimestampRolloverStream).pipe(u.metadataStream).pipe(u.coalesceStream);u.h264Stream.pipe(u.captionStream).pipe(u.coalesceStream);u.elementaryStream.on("data",function(f){var e;if(f.type==="metadata"){for(e=f.tracks.length;e--;)i||f.tracks[e].type!=="video"?t||f.tracks[e].type!=="audio"||(t=f.tracks[e],t.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(i=f.tracks[e],i.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime);if(i&&!u.videoSegmentStream){u.coalesceStream.numberOfTracks++;u.videoSegmentStream=new et(i,n);u.videoSegmentStream.on("timelineStartInfo",function(n){t&&(t.timelineStartInfo=n,u.audioSegmentStream.setEarliestDts(n.dts))});u.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo"));u.videoSegmentStream.on("baseMediaDecodeTime",function(n){t&&u.audioSegmentStream.setVideoBaseMediaDecodeTime(n)});u.h264Stream.pipe(u.videoSegmentStream).pipe(u.coalesceStream)}t&&!u.audioSegmentStream&&(u.coalesceStream.numberOfTracks++,u.audioSegmentStream=new d(t,n),u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream))}});u.coalesceStream.on("data",this.trigger.bind(this,"data"));u.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;this.baseMediaDecodeTime=n;t&&(t.timelineStartInfo.dts=undefined,t.timelineStartInfo.pts=undefined,l.clearDtsInfo(t),t.timelineStartInfo.baseMediaDecodeTime=n,r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity());i&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),i.timelineStartInfo.dts=undefined,i.timelineStartInfo.pts=undefined,l.clearDtsInfo(i),r.captionStream.reset(),i.timelineStartInfo.baseMediaDecodeTime=n);r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()};this.setAudioAppendStart=function(n){t&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(n)};this.alignGopsWith=function(n){i&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(n)};this.push=function(n){if(u){var t=ef(n);t&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():t||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline();u=!1}this.transmuxPipeline_.headOfPipeline.push(n)};this.flush=function(){u=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}};gt.prototype=new f;var gi={Transmuxer:gt,VideoSegmentStream:et,AudioSegmentStream:d,AUDIO_PROPERTIES:bi,VIDEO_PROPERTIES:ki},e,nr,ni=v.parseType,c=function(n){return new Date(n*1e3-20828448e5)},sf=function(n){return{isLeading:(n[0]&12)>>>2,dependsOn:n[0]&3,isDependedOn:(n[1]&192)>>>6,hasRedundancy:(n[1]&48)>>>4,paddingValue:(n[1]&14)>>>1,isNonSyncSample:n[1]&1,degradationPriority:n[2]<<8|n[3]}},ge=function(n){for(var u=new DataView(n.buffer,n.byteOffset,n.byteLength),t=[],r,i=0;i+4<n.length;i+=r){if(r=u.getUint32(i),i+=4,r<=0){t.push("<span style='color:red;'>MALFORMED DATA<\/span>");continue}switch(n[i]&31){case 1:t.push("slice_layer_without_partitioning_rbsp");break;case 5:t.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:t.push("sei_rbsp");break;case 7:t.push("seq_parameter_set_rbsp");break;case 8:t.push("pic_parameter_set_rbsp");break;case 9:t.push("access_unit_delimiter_rbsp");break;default:t.push("UNKNOWN NAL - "+n[i]&31)}}return t},nt={avc1:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:e(n.subarray(78,n.byteLength))}},avcC:function(n){for(var f=new DataView(n.buffer,n.byteOffset,n.byteLength),u={configurationVersion:n[0],avcProfileIndication:n[1],profileCompatibility:n[2],avcLevelIndication:n[3],lengthSizeMinusOne:n[4]&3,sps:[],pps:[]},o=n[5]&31,e,i,t=6,r=0;r<o;r++)i=f.getUint16(t),t+=2,u.sps.push(new Uint8Array(n.subarray(t,t+i))),t+=i;for(e=n[t],t++,r=0;r<e;r++)i=f.getUint16(t),t+=2,u.pps.push(new Uint8Array(n.subarray(t,t+i))),t+=i;return u},btrt:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),esId:n[6]<<8|n[7],streamPriority:n[8]&31,decoderConfig:{objectProfileIndication:n[11],streamType:n[12]>>>2&63,bufferSize:n[13]<<16|n[14]<<8|n[15],maxBitrate:n[16]<<24|n[17]<<16|n[18]<<8|n[19],avgBitrate:n[20]<<24|n[21]<<16|n[22]<<8|n[23],decoderConfigDescriptor:{tag:n[24],length:n[25],audioObjectType:n[26]>>>3&31,samplingFrequencyIndex:(n[26]&7)<<1|n[27]>>>7&1,channelConfiguration:n[27]>>>3&15}}}},ftyp:function(n){for(var r=new DataView(n.buffer,n.byteOffset,n.byteLength),i={majorBrand:ni(n.subarray(0,4)),minorVersion:r.getUint32(4),compatibleBrands:[]},t=8;t<n.byteLength;)i.compatibleBrands.push(ni(n.subarray(t,t+4))),t+=4;return i},dinf:function(n){return{boxes:e(n)}},dref:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),dataReferences:e(n.subarray(8))}},hdlr:function(n){for(var r=new DataView(n.buffer,n.byteOffset,n.byteLength),i={version:r.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),handlerType:ni(n.subarray(8,12)),name:""},t=8,t=24;t<n.byteLength;t++){if(n[t]===0){t++;break}i.name+=String.fromCharCode(n[t])}return i.name=decodeURIComponent(escape(i.name)),i},mdat:function(n){return{byteLength:n.byteLength,nals:ge(n)}},mdhd:function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,u,i={version:r.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),language:""};return i.version===1?(t+=4,i.creationTime=c(r.getUint32(t)),t+=8,i.modificationTime=c(r.getUint32(t)),t+=4,i.timescale=r.getUint32(t),t+=8,i.duration=r.getUint32(t)):(i.creationTime=c(r.getUint32(t)),t+=4,i.modificationTime=c(r.getUint32(t)),t+=4,i.timescale=r.getUint32(t),t+=4,i.duration=r.getUint32(t)),t+=4,u=r.getUint16(t),i.language+=String.fromCharCode((u>>10)+96),i.language+=String.fromCharCode(((u&992)>>5)+96),i.language+=String.fromCharCode((u&31)+96),i},mdia:function(n){return{boxes:e(n)}},mfhd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),sequenceNumber:n[4]<<24|n[5]<<16|n[6]<<8|n[7]}},minf:function(n){return{boxes:e(n)}},mp4a:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return n.byteLength>28&&(i.streamDescriptor=e(n.subarray(28))[0]),i},moof:function(n){return{boxes:e(n)}},moov:function(n){return{boxes:e(n)}},mvex:function(n){return{boxes:e(n)}},mvhd:function(n){var i=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,r={version:i.getUint8(0),flags:new Uint8Array(n.subarray(1,4))};return r.version===1?(t+=4,r.creationTime=c(i.getUint32(t)),t+=8,r.modificationTime=c(i.getUint32(t)),t+=4,r.timescale=i.getUint32(t),t+=8,r.duration=i.getUint32(t)):(r.creationTime=c(i.getUint32(t)),t+=4,r.modificationTime=c(i.getUint32(t)),t+=4,r.timescale=i.getUint32(t),t+=4,r.duration=i.getUint32(t)),t+=4,r.rate=i.getUint16(t)+i.getUint16(t+2)/16,t+=4,r.volume=i.getUint8(t)+i.getUint8(t+1)/8,t+=2,t+=2,t+=8,r.matrix=new Uint32Array(n.subarray(t,t+36)),t+=36,t+=24,r.nextTrackId=i.getUint32(t),r},pdin:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(n.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(n){for(var i={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},t=4;t<n.byteLength;t++)i.samples.push({dependsOn:(n[t]&48)>>4,isDependedOn:(n[t]&12)>>2,hasRedundancy:n[t]&3});return i},sidx:function(n){for(var t=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8),earliestPresentationTime:t.getUint32(12),firstOffset:t.getUint32(16)},u=t.getUint16(22),i=24;u;i+=12,u--)r.references.push({referenceType:(n[i]&128)>>>7,referencedSize:t.getUint32(i)&2147483647,subsegmentDuration:t.getUint32(i+4),startsWithSap:!!(n[i+8]&128),sapType:(n[i+8]&112)>>>4,sapDeltaTime:t.getUint32(i+8)&268435455});return r},smhd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),balance:n[4]+n[5]/256}},stbl:function(n){return{boxes:e(n)}},stco:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),chunkOffsets:[]},u=i.getUint32(4),t=8;u;t+=4,u--)r.chunkOffsets.push(i.getUint32(t));return r},stsc:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r=i.getUint32(4),u={version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleToChunks:[]},t=8;r;t+=12,r--)u.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return u},stsd:function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleDescriptions:e(n.subarray(8))}},stsz:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]},t=12;t<n.byteLength;t+=4)r.entries.push(i.getUint32(t));return r},stts:function(n){for(var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),timeToSamples:[]},u=i.getUint32(4),t=8;u;t+=8,u--)r.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return r},styp:function(n){return nt.ftyp(n)},tfdt:function(n){var t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),baseMediaDecodeTime:n[4]<<24|n[5]<<16|n[6]<<8|n[7]};return t.version===1&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=n[8]<<24|n[9]<<16|n[10]<<8|n[11]),t},tfhd:function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:r.getUint32(4)},u=t.flags[2]&1,f=t.flags[2]&2,e=t.flags[2]&8,o=t.flags[2]&16,s=t.flags[2]&32,h=t.flags[0]&65536,c=t.flags[0]&131072,i;return i=8,u&&(i+=4,t.baseDataOffset=r.getUint32(12),i+=4),f&&(t.sampleDescriptionIndex=r.getUint32(i),i+=4),e&&(t.defaultSampleDuration=r.getUint32(i),i+=4),o&&(t.defaultSampleSize=r.getUint32(i),i+=4),s&&(t.defaultSampleFlags=r.getUint32(i)),h&&(t.durationIsEmpty=!0),!u&&c&&(t.baseDataOffsetIsMoof=!0),t},tkhd:function(n){var i=new DataView(n.buffer,n.byteOffset,n.byteLength),t=4,r={version:i.getUint8(0),flags:new Uint8Array(n.subarray(1,4))};return r.version===1?(t+=4,r.creationTime=c(i.getUint32(t)),t+=8,r.modificationTime=c(i.getUint32(t)),t+=4,r.trackId=i.getUint32(t),t+=4,t+=8,r.duration=i.getUint32(t)):(r.creationTime=c(i.getUint32(t)),t+=4,r.modificationTime=c(i.getUint32(t)),t+=4,r.trackId=i.getUint32(t),t+=4,t+=4,r.duration=i.getUint32(t)),t+=4,t+=8,r.layer=i.getUint16(t),t+=2,r.alternateGroup=i.getUint16(t),t+=2,r.volume=i.getUint8(t)+i.getUint8(t+1)/8,t+=2,t+=2,r.matrix=new Uint32Array(n.subarray(t,t+36)),t+=36,r.width=i.getUint16(t)+i.getUint16(t+2)/16,t+=4,r.height=i.getUint16(t)+i.getUint16(t+2)/16,r},traf:function(n){return{boxes:e(n)}},trak:function(n){return{boxes:e(n)}},trex:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:n[20]&3,sampleIsDependedOn:(n[21]&192)>>6,sampleHasRedundancy:(n[21]&48)>>4,samplePaddingValue:(n[21]&14)>>1,sampleIsDifferenceSample:!!(n[21]&1),sampleDegradationPriority:t.getUint16(22)}},trun:function(n){var r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},u=new DataView(n.buffer,n.byteOffset,n.byteLength),h=r.flags[2]&1,c=r.flags[2]&4,e=r.flags[1]&1,o=r.flags[1]&2,l=r.flags[1]&4,s=r.flags[1]&8,f=u.getUint32(4),t=8,i;for(h&&(r.dataOffset=u.getInt32(t),t+=4),c&&f&&(i={flags:sf(n.subarray(t,t+4))},t+=4,e&&(i.duration=u.getUint32(t),t+=4),o&&(i.size=u.getUint32(t),t+=4),s&&(i.compositionTimeOffset=u.getUint32(t),t+=4),r.samples.push(i),f--);f--;)i={},e&&(i.duration=u.getUint32(t),t+=4),o&&(i.size=u.getUint32(t),t+=4),l&&(i.flags=sf(n.subarray(t,t+4)),t+=4),s&&(i.compositionTimeOffset=u.getUint32(t),t+=4),r.samples.push(i);return r},"url ":function(n){return{version:n[0],flags:new Uint8Array(n.subarray(1,4))}},vmhd:function(n){var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return{version:n[0],flags:new Uint8Array(n.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};e=function(n){for(var t=0,o=[],s,i,f,e,r,h=new ArrayBuffer(n.length),c=new Uint8Array(h),u=0;u<n.length;++u)c[u]=n[u];for(s=new DataView(h);t<n.byteLength;)i=s.getUint32(t),f=ni(n.subarray(t+4,t+8)),e=i>1?t+i:n.byteLength,r=(nt[f]||function(n){return{data:n}})(n.subarray(t+8,e)),r.size=i,r.type=f,o.push(r),t=e;return o};nr=function(n,t){var i;return t=t||0,i=new Array(t*2+1).join(" "),n.map(function(n){return i+n.type+"\n"+Object.keys(n).filter(function(n){return n!=="type"&&n!=="boxes"}).map(function(t){var f=i+"  "+t+": ",r=n[t],u;return r instanceof Uint8Array||r instanceof Uint32Array?(u=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(n){return" "+("00"+n.toString(16)).slice(-2)}).join("").match(/.{1,24}/g),!u)?f+"<>":u.length===1?f+"<"+u.join("").slice(1)+">":f+"<\n"+u.map(function(n){return i+"  "+n}).join("\n")+"\n"+i+"  >":f+JSON.stringify(r,null,2).split("\n").map(function(n,t){return t===0?n:i+"  "+n}).join("\n")}).join("\n")+(n.boxes?"\n"+nr(n.boxes,t+1):"")}).join("\n")};var tr={inspect:e,textify:nr,parseTfdt:nt.tfdt,parseHdlr:nt.hdlr,parseTfhd:nt.tfhd,parseTrun:nt.trun},no=rt.discardEmulationPreventionBytes,to=fi.CaptionStream,io=function(n,t){for(var i,u=n,r=0;r<t.length;r++){if(i=t[r],u<i.size)return i;u-=i.size}return null},ro=function(n,t,i){for(var c=new DataView(n.buffer,n.byteOffset,n.byteLength),h=[],u,f,o,s,e,r=0;r+4<n.length;r+=f)if(f=c.getUint32(r),r+=4,!(f<=0))switch(n[r]&31){case 6:s=n.subarray(r+1,r+1+f);e=io(r,t);u={nalUnitType:"sei_rbsp",size:f,data:s,escapedRBSP:no(s),trackId:i};e?(u.pts=e.pts,u.dts=e.dts,o=e):(u.pts=o.pts,u.dts=o.dts);h.push(u)}return h},uo=function(n,t,i){var r=t,f=i.defaultSampleDuration||0,e=i.defaultSampleSize||0,o=i.trackId,u=[];return n.forEach(function(n){var i=tr.parseTrun(n),t=i.samples;t.forEach(function(n){n.duration===undefined&&(n.duration=f);n.size===undefined&&(n.size=e);n.trackId=o;n.dts=r;n.compositionTimeOffset===undefined&&(n.compositionTimeOffset=0);n.pts=r+n.compositionTimeOffset;r+=n.duration});u=u.concat(t)}),u},fo=function(n,t){var u=v.findBox(n,["moof","traf"]),f=v.findBox(n,["mdat"]),i={},r=[];return f.forEach(function(n,t){var i=u[t];r.push({mdat:n,traf:i})}),r.forEach(function(n){var c=n.mdat,u=n.traf,l=v.findBox(u,["tfhd"]),f=tr.parseTfhd(l[0]),r=f.trackId,e=v.findBox(u,["tfdt"]),a=e.length>0?tr.parseTfdt(e[0]).baseMediaDecodeTime:0,o=v.findBox(u,["trun"]),s,h;t===r&&o.length>0&&(s=uo(o,a,f),h=ro(c,s,r),i[r]||(i[r]=[]),i[r]=i[r].concat(h))}),i},eo=function(n,t,i){var r;return t?(r=fo(n,t),{seiNals:r[t],timescale:i}):null},oo=function(){var f=!1,r,u,n,t,i;this.isInitialized=function(){return f};this.init=function(){r=new to;f=!0;r.on("data",function(n){n.startTime=n.startPts/t;n.endTime=n.endPts/t;i.captions.push(n);i.captionStreams[n.stream]=!0})};this.isNewInit=function(i,r){return i&&i.length===0||r&&typeof r=="object"&&Object.keys(r).length===0?!1:n!==i[0]||t!==r[n]};this.parse=function(r,f,e){var o,s;if(this.isInitialized())if(f&&e){if(this.isNewInit(f,e))n=f[0],t=e[n];else if(!n||!t)return u.push(r),null}else return null;else return null;while(u.length>0)s=u.shift(),this.parse(s,f,e);return(o=eo(r,n,t),o===null||!o.seiNals)?null:(this.pushNals(o.seiNals),this.flushStream(),i)};this.pushNals=function(n){if(!this.isInitialized()||!n||n.length===0)return null;n.forEach(function(n){r.push(n)})};this.flushStream=function(){if(!this.isInitialized())return null;r.flush()};this.clearParsedCaptions=function(){i.captions=[];i.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized())return null;r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){u=[];n=null;t=null;i?this.clearParsedCaptions():i={captions:[],captionStreams:{}};this.resetCaptionStream()};this.reset()},so=oo,ho={generator:w,probe:v,Transmuxer:gi.Transmuxer,AudioSegmentStream:gi.AudioSegmentStream,VideoSegmentStream:gi.VideoSegmentStream,CaptionParser:so},co=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},lo=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),ao=function(n,t){t.on("data",function(t){var r=t.initSegment,i;t.initSegment={data:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};i=t.data;t.data=i.buffer;n.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])});if(t.captionStream)t.captionStream.on("data",function(t){n.postMessage({action:"caption",data:t})});t.on("done",function(){n.postMessage({action:"done"})});t.on("gopInfo",function(t){n.postMessage({action:"gopInfo",gopInfo:t})})},hf=function(){function n(t,i){co(this,n);this.options=i||{};this.self=t;this.init()}return lo(n,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose();this.transmuxer=new ho.Transmuxer(this.options);ao(this.self,this.transmuxer)}},{key:"push",value:function(n){var t=new Uint8Array(n.data,n.byteOffset,n.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(n){var t=n.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(t*9e4))}},{key:"setAudioAppendStart",value:function(n){this.transmuxer.setAudioAppendStart(Math.ceil(n.appendStart*9e4))}},{key:"flush",value:function(){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(n){this.transmuxer.alignGopsWith(n.gopsToAlignWith.slice())}}]),n}(),vo=function(n){n.onmessage=function(t){if(t.data.action==="init"&&t.data.options){this.messageHandlers=new hf(n,t.data.options);return}this.messageHandlers||(this.messageHandlers=new hf(n));t.data&&t.data.action&&t.data.action!=="init"&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data)}};return new vo(n)}()}),krt={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},drt=function(n){return n.map(function(n){return n.replace(/avc1\.(\d+)\.(\d+)/i,function(n,t,i){var r=("00"+Number(t).toString(16)).slice(-2),u=("00"+Number(i).toString(16)).slice(-2);return"avc1."+r+"00"+u})})},ke=function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",n={codecCount:0},t=void 0;return n.codecCount=i.split(",").length,n.codecCount=n.codecCount||2,t=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(i),t&&(n.videoCodec=t[2],n.videoObjectTypeIndicator=t[3]),n.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(i),n.audioProfile=n.audioProfile&&n.audioProfile[2],n},vwt=function(n){return n.replace(/avc1\.(\d+)\.(\d+)/i,function(n){return drt([n])[0]})},tp=function(n,t,i){return n+"/"+t+'; codecs="'+i.filter(function(n){return!!n}).join(", ")+'"'},ywt=function(n){return n.segments&&n.segments.length&&n.segments[0].map?"mp4":"mp2t"},pwt=function(n){var t=n.attributes||{};return t.CODECS?ke(t.CODECS):krt},wwt=function(n,t){var i,u,r;if(!n.mediaGroups.AUDIO||!t||(i=n.mediaGroups.AUDIO[t],!i))return null;for(u in i)if(r=i[u],r.default&&r.playlists)return ke(r.playlists[0].attributes.CODECS).audioProfile;return null},bwt=function(n,t){var s=ywt(t),u=pwt(t),h=t.attributes||{},f=!0,c=!1,e,l,r;if(!t)return[];if(n.mediaGroups.AUDIO&&h.AUDIO&&(e=n.mediaGroups.AUDIO[h.AUDIO],e)){c=!0;f=!1;for(l in e)if(!e[l].uri&&!e[l].playlists){f=!0;break}}c&&!u.audioProfile&&(f||(u.audioProfile=wwt(n,h.AUDIO)),u.audioProfile||(i.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),u.audioProfile=krt.audioProfile));r={};u.videoCodec&&(r.video=""+u.videoCodec+u.videoObjectTypeIndicator);u.audioProfile&&(r.audio="mp4a.40."+u.audioProfile);var o=tp("audio",s,[r.audio]),v=tp("video",s,[r.video]),a=tp("video",s,[r.video,r.audio]);return c?!f&&r.video?[v,o]:!f&&!r.video?[o,o]:[a,o]:r.video?[a]:[o]},kwt=function(n){var t={type:"",parameters:{}},i=n.trim().split(";");return t.type=i.shift().trim(),i.forEach(function(n){var i=n.trim().split("="),r,u;i.length>1&&(r=i[0].replace(/"/g,"").trim(),u=i[1].replace(/"/g,"").trim(),t.parameters[r]=u)}),t},grt=function(n){return/mp4a\.\d+.\d+/i.test(n)},nut=function(n){return/avc1\.[\da-f]+/i.test(n)},dwt=function(n,t,i){if(typeof t=="undefined"||t===null||!n.length)return[];for(var u=Math.ceil((t-i+3)*9e4),r=void 0,r=0;r<n.length;r++)if(n[r].pts>u)break;return n.slice(r)},gwt=function(n,t,i){if(!t.length)return n;if(i)return t.slice();var u=t[0].pts,r=0;for(r;r<n.length;r++)if(n[r].pts>=u)break;return n.slice(0,r).concat(t)},nbt=function(n,t,i,r){for(var o=Math.ceil((t-r)*9e4),s=Math.ceil((i-r)*9e4),e=n.slice(),f=n.length,u;f--;)if(n[f].pts<=s)break;if(f===-1)return e;for(u=f+1;u--;)if(n[u].pts<=o)break;return u=Math.max(u,0),e.splice(u,f-u+1),e},tbt=function(n,t,r){var e=null,o=null,s=0,f=[],l=[];if(!n&&!t)return i.createTimeRange();if(!n)return t.buffered;if(!t||r)return n.buffered;if(n.buffered.length===0&&t.buffered.length===0)return i.createTimeRange();for(var h=n.buffered,c=t.buffered,u=h.length;u--;)f.push({time:h.start(u),type:"start"}),f.push({time:h.end(u),type:"end"});for(u=c.length;u--;)f.push({time:c.start(u),type:"start"}),f.push({time:c.end(u),type:"end"});for(f.sort(function(n,t){return n.time-t.time}),u=0;u<f.length;u++)f[u].type==="start"?(s++,s===2&&(e=f[u].time)):f[u].type==="end"&&(s--,s===1&&(o=f[u].time)),e!==null&&o!==null&&(l.push([e,o]),e=null,o=null);return i.createTimeRanges(l)},ibt=function(n,t){var i=n.addSourceBuffer(t),r=Object.create(null),u,f;r.updating=!1;r.realBuffer_=i;u=function(n){typeof i[n]=="function"?r[n]=function(){return i[n].apply(i,arguments)}:typeof r[n]=="undefined"&&Object.defineProperty(r,n,{get:function(){return i[n]},set:function(t){return i[n]=t}})};for(f in i)u(f);return r},rbt=function(n){function t(n,r){var u,f;return ui(this,t),u=li(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.EventTarget)),u.timestampOffset_=0,u.pendingBuffers_=[],u.bufferUpdating_=!1,u.mediaSource_=n,u.codecs_=r,u.audioCodec_=null,u.videoCodec_=null,u.audioDisabled_=!1,u.appendAudioInitSegment_=!0,u.gopBuffer_=[],u.timeMapping_=0,u.safeAppend_=i.browser.IE_VERSION>=11,f={remux:!1,alignGopsAtEnd:u.safeAppend_},u.codecs_.forEach(function(n){grt(n)?u.audioCodec_=n:nut(n)&&(u.videoCodec_=n)}),u.transmuxer_=new awt,u.transmuxer_.postMessage({action:"init",options:f}),u.transmuxer_.onmessage=function(n){return n.data.action==="data"?u.data_(n):n.data.action==="done"?u.done_(n):n.data.action==="gopInfo"?u.appendGopInfo_(n):void 0},Object.defineProperty(u,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(n){typeof n=="number"&&n>=0&&(this.timestampOffset_=n,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:n}))}}),Object.defineProperty(u,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(n){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=n);this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=n)}}),Object.defineProperty(u,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(u,"buffered",{get:function(){return tbt(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),u}return wi(t,n),ei(t,[{key:"data_",value:function(n){var t=n.data.segment;t.data=new Uint8Array(t.data,n.data.byteOffset,n.data.byteLength);t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength);ewt(this,this.mediaSource_,t);this.pendingBuffers_.push(t);return}},{key:"done_",value:function(){if(this.mediaSource_.readyState==="closed"){this.pendingBuffers_.length=0;return}this.processPendingSegments_();return}},{key:"createRealSourceBuffers_",value:function(){var n=this,t=["audio","video"];t.forEach(function(i){var r,u,f;n[i+"Codec_"]&&(n[i+"Buffer_"]||(r=null,n.mediaSource_[i+"Buffer_"]?(r=n.mediaSource_[i+"Buffer_"],r.updating=!1):(u=i+"Codec_",f=i+'/mp4;codecs="'+n[u]+'"',r=ibt(n.mediaSource_.nativeMediaSource_,f),n.mediaSource_[i+"Buffer_"]=r),n[i+"Buffer_"]=r,["update","updatestart","updateend"].forEach(function(u){r.addEventListener(u,function(){if(i!=="audio"||!n.audioDisabled_){u==="updateend"&&(n[i+"Buffer_"].updating=!1);var r=t.every(function(t){return t==="audio"&&n.audioDisabled_?!0:i!==t&&n[t+"Buffer_"]&&n[t+"Buffer_"].updating?!1:!0});if(r)return n.trigger(u)}})})))})}},{key:"appendBuffer",value:function(n){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:dwt(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)});this.transmuxer_.postMessage({action:"push",data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength},[n.buffer]);this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(n){this.gopBuffer_=gwt(this.gopBuffer_,n.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(n,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(n,t),this.gopBuffer_=nbt(this.gopBuffer_,n,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(n,t)),uf(n,t,this.metadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)uf(n,t,this.inbandTextTracks_[i])}},{key:"processPendingSegments_",value:function(){var n={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]},t;n=this.pendingBuffers_.reduce(function(n,t){var i=t.type,r=t.data,u=t.initSegment;return n[i].segments.push(r),n[i].bytes+=r.byteLength,n[i].initSegment=u,t.captions&&(n.captions=n.captions.concat(t.captions)),t.info&&(n[i].info=t.info),t.metadata&&(n.metadata=n.metadata.concat(t.metadata)),n},n);this.videoBuffer_||this.audioBuffer_||(n.video.bytes===0&&(this.videoCodec_=null),n.audio.bytes===0&&(this.audioCodec_=null),this.createRealSourceBuffers_());n.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:n.audio.info});n.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:n.video.info});this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(n.audio.segments.unshift(n.audio.initSegment),n.audio.bytes+=n.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);t=!1;this.videoBuffer_&&n.video.bytes?(n.video.segments.unshift(n.video.initSegment),n.video.bytes+=n.video.initSegment.byteLength,this.concatAndAppendSegments_(n.video,this.videoBuffer_),swt(this,n.captions,n.metadata)):this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)&&(t=!0);!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(n.audio,this.audioBuffer_);this.pendingBuffers_.length=0;t&&this.trigger("updateend");this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(n,t){var r=0,i=void 0;if(n.bytes){i=new Uint8Array(n.bytes);n.segments.forEach(function(n){i.set(n,r);r+=n.byteLength});try{t.updating=!0;t.appendBuffer(i)}catch(u){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:u.message,originalError:u})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort();!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort();this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"});this.pendingBuffers_.length=0;this.bufferUpdating_=!1}}]),t}(i.EventTarget),ip=function(r){function u(){ui(this,u);var r=li(this,(u.__proto__||Object.getPrototypeOf(u)).call(this)),f=void 0;r.nativeMediaSource_=new n.MediaSource;for(f in r.nativeMediaSource_)f in u.prototype||typeof r.nativeMediaSource_[f]!="function"||(r[f]=r.nativeMediaSource_[f].bind(r.nativeMediaSource_));r.duration_=NaN;Object.defineProperty(r,"duration",{get:function(){return this.duration_===Infinity?this.duration_:this.nativeMediaSource_.duration},set:function(n){if(this.duration_=n,n!==Infinity){this.nativeMediaSource_.duration=n;return}}});Object.defineProperty(r,"seekable",{get:function(){return this.duration_===Infinity?i.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}});Object.defineProperty(r,"readyState",{get:function(){return this.nativeMediaSource_.readyState}});Object.defineProperty(r,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}});r.sourceBuffers=[];r.activeSourceBuffers_=[];r.updateActiveSourceBuffers_=function(){var n,u,t,i,f;if(r.activeSourceBuffers_.length=0,r.sourceBuffers.length===1){n=r.sourceBuffers[0];n.appendAudioInitSegment_=!0;n.audioDisabled_=!n.audioCodec_;r.activeSourceBuffers_.push(n);return}for(u=!1,t=!0,i=0;i<r.player_.audioTracks().length;i++)if(f=r.player_.audioTracks()[i],f.enabled&&f.kind!=="main"){u=!0;t=!1;break}r.sourceBuffers.